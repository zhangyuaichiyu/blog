<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[Vue.js—导航切换]]></title>
      <url>/2017/07/03/VueJS2/</url>
      <content type="html"><![CDATA[<h3 id="导航切换"><a href="#导航切换" class="headerlink" title="导航切换"></a>导航切换</h3><pre><code>&lt;div id=&quot;main&quot;&gt;
    &lt;nav @click.prevent&gt;
        &lt;a v-for=&quot;(item, index) in items&quot; :class=&quot;{&apos;show&apos;: item.active}&quot; @click=&quot;makeActive(item, index)&quot;&gt;{{item.name}}&lt;/a&gt;
    &lt;/nav&gt;
    &lt;p&gt;You chose &lt;b&gt;{{active}}&lt;/b&gt;&lt;/p&gt;
&lt;/div&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">var vm = new Vue(&#123;</div><div class="line">	el:&apos;#main&apos;,</div><div class="line">    data:&#123;</div><div class="line">    	active:&apos;HTML&apos;,</div><div class="line">    	items:[</div><div class="line">        	&#123;name:&apos;HTML&apos;, active:true&#125;,</div><div class="line">            &#123;name:&apos;CSS&apos;, active:false&#125;,</div><div class="line">            &#123;name:&apos;JavaScript&apos;, active:false&#125;,</div><div class="line">            &#123;name:&apos;Vue.js&apos;, active:false&#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">		makeActive: function(item, index)&#123;</div><div class="line">			this.active = item.name;</div><div class="line">            for(var i=0; i&lt;this.items.length;i++)&#123;</div><div class="line">            	this.items[i].active = false;</div><div class="line">            &#125;</div><div class="line">            this.items[index].active = true;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">*&#123;</div><div class="line">	margin:0;</div><div class="line">	padding:0;</div><div class="line">&#125;</div><div class="line">#main&#123;</div><div class="line">    width:432px;</div><div class="line">    margin:0 auto;</div><div class="line">    text-align:center;</div><div class="line">&#125;</div><div class="line">nav&#123;</div><div class="line">	display:inline-block;</div><div class="line">	margin:60px auto 45px;</div><div class="line">	background-color:#5597b4;</div><div class="line">	box-shadow:0 1px 1px #ccc;</div><div class="line">	border-radius:2px;</div><div class="line">&#125;</div><div class="line">nav a&#123;</div><div class="line">	display:inline-block;</div><div class="line">	padding: 18px 30px;</div><div class="line">	color:#fff !important;</div><div class="line">	font-weight:bold;</div><div class="line">	font-size:16px;</div><div class="line">	text-decoration:none !important;</div><div class="line">	line-height:1;</div><div class="line">	background-color:transparent;</div><div class="line">	-webkit-transition:background-color 0.25s;</div><div class="line">	-moz-transition:background-color 0.25s;</div><div class="line">	transition:background-color 0.25s;</div><div class="line">    cursor:pointer;</div><div class="line">&#125;</div><div class="line">b&#123;</div><div class="line">    display:inline-block;</div><div class="line">	padding:5px 10px;</div><div class="line">	background-color:#c4d7e0;</div><div class="line">	border-radius:2px;</div><div class="line">	font-size:18px;</div><div class="line">&#125;</div><div class="line">.show&#123;</div><div class="line">    background-color:#e35885;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/VueJs3.gif" alt=""></p>
<blockquote>
<p>这里主要应用了vue.js的v-for指令来渲染一个列表、v-bind指令来绑定class以及v-on指令来处理事件</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> Vue.JS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js—合计总价]]></title>
      <url>/2017/07/03/VueJS4/</url>
      <content type="html"><![CDATA[<h3 id="合计总价"><a href="#合计总价" class="headerlink" title="合计总价"></a>合计总价</h3><pre><code>&lt;div id=&quot;main&quot; v-cloak&gt;
    &lt;h1&gt;Services&lt;/h1&gt;
    &lt;ul&gt;
        &lt;li v-for=&quot;item in items&quot; @click=&quot;toggleActive(item)&quot; :class=&quot;{&apos;active&apos;:item.active}&quot;&gt;{{item.name}}&lt;span&gt;{{item.price | currency}}&lt;/span&gt;&lt;/li&gt;
    &lt;/ul&gt;
    &lt;p&gt;Total: &lt;span&gt;{{total() | currency}}&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">var demo = new Vue(&#123;</div><div class="line">    el: &apos;#main&apos;,</div><div class="line">    data: &#123;</div><div class="line">        items: [</div><div class="line">        	&#123;</div><div class="line">        		name: &apos;Web Development&apos;,</div><div class="line">        		price: 300,</div><div class="line">        		active:false</div><div class="line">        	&#125;,&#123;</div><div class="line">        		name: &apos;Design&apos;,</div><div class="line">        		price: 400,</div><div class="line">        		active:false</div><div class="line">        	&#125;,&#123;</div><div class="line">        		name: &apos;Integration&apos;,</div><div class="line">        		price: 250,</div><div class="line">        		active:false</div><div class="line">        	&#125;,&#123;</div><div class="line">        		name: &apos;Training&apos;,</div><div class="line">        		price: 220,</div><div class="line">        		active:false</div><div class="line">        	&#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">    	toggleActive: function(i)&#123;</div><div class="line">            i.active = !i.active;</div><div class="line">    	&#125;,</div><div class="line">    	total: function()&#123;</div><div class="line">        	var total = 0;</div><div class="line">        	this.items.forEach(function(s)&#123;</div><div class="line">        		if (s.active)&#123;</div><div class="line">        			total+= s.price;</div><div class="line">        		&#125;</div><div class="line">        	&#125;);</div><div class="line">    	   return total;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">[v-cloak] &#123;</div><div class="line">  display: none;</div><div class="line">&#125;</div><div class="line">*&#123;</div><div class="line">	margin:0;</div><div class="line">	padding:0;</div><div class="line">&#125;</div><div class="line">body&#123;</div><div class="line">    font-family:Microsoft YaHei;</div><div class="line">&#125;</div><div class="line">li&#123;list-style:none;&#125;</div><div class="line">div&#123;</div><div class="line">    width:400px;</div><div class="line">    background-color:#61a1bc;</div><div class="line">    margin:50px auto;</div><div class="line">    padding:35px 60px;</div><div class="line">&#125;</div><div class="line">h1&#123;</div><div class="line">    font-size:44px;</div><div class="line">    text-align:center;</div><div class="line">&#125;</div><div class="line">ul&#123;</div><div class="line">    font-size:20px;</div><div class="line">    text-align:left;</div><div class="line">    margin:20px 0 15px;</div><div class="line">&#125;</div><div class="line">ul li&#123;</div><div class="line">    padding:20px 30px;</div><div class="line">	background-color:#e35885;</div><div class="line">	margin-bottom:8px;</div><div class="line">	cursor:pointer;</div><div class="line">&#125;</div><div class="line">ul li span&#123;float:right;&#125;</div><div class="line">ul li.active&#123;</div><div class="line">    background-color:#8ec16d;</div><div class="line">&#125;</div><div class="line">p&#123;</div><div class="line">    border-top:1px solid rgba(255,255,255,0.5);</div><div class="line">	padding:15px 30px;</div><div class="line">	font-size:20px;</div><div class="line">	text-align: left;</div><div class="line">&#125;</div><div class="line">p span&#123;float:right;&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/VueJs5.gif" alt=""></p>
<blockquote>
<p>这个例子类似购物车那种选中合计总价的功能，也是对各种指令以及数据绑定的综合应用吧。</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> Vue.JS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js—布局转换]]></title>
      <url>/2017/07/03/VueJS3/</url>
      <content type="html"><![CDATA[<h3 id="布局转换"><a href="#布局转换" class="headerlink" title="布局转换"></a>布局转换</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;main&quot; v-cloak&gt;</div><div class="line">	&lt;div class=&quot;bar&quot;&gt;</div><div class="line">        &lt;a class=&quot;grid-icon&quot; v-bind:class=&quot;&#123; &apos;active&apos;: layout == &apos;grid&apos;&#125;&quot; v-on:click=&quot;layout = &apos;grid&apos;&quot;&gt;&lt;/a&gt;</div><div class="line">		&lt;a class=&quot;list-icon&quot; v-bind:class=&quot;&#123; &apos;active&apos;: layout == &apos;list&apos;&#125;&quot; v-on:click=&quot;layout = &apos;list&apos;&quot;&gt;&lt;/a&gt;</div><div class="line">	&lt;/div&gt;</div><div class="line">	&lt;ul v-if=&quot;layout == &apos;grid&apos;&quot; class=&quot;grid&quot;&gt;</div><div class="line">		&lt;li v-for=&quot;a in articles&quot;&gt;</div><div class="line">			&lt;a v-bind:href=&quot;a.url&quot; target=&quot;_blank&quot;&gt;&lt;img v-bind:src=&quot;a.image.large&quot; /&gt;&lt;/a&gt;</div><div class="line">		&lt;/li&gt;</div><div class="line">	&lt;/ul&gt;</div><div class="line">	&lt;ul v-if=&quot;layout == &apos;list&apos;&quot; class=&quot;list&quot;&gt;</div><div class="line">		&lt;li v-for=&quot;a in articles&quot;&gt;</div><div class="line">			&lt;a v-bind:href=&quot;a.url&quot; target=&quot;_blank&quot;&gt;&lt;img v-bind:src=&quot;a.image.small&quot; /&gt;&lt;/a&gt;</div><div class="line">			&lt;p&gt;&#123;&#123;a.title&#125;&#125;&lt;/p&gt;</div><div class="line">		&lt;/li&gt;</div><div class="line">	&lt;/ul&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">var demo = new Vue(&#123;</div><div class="line">	el: &apos;#main&apos;,</div><div class="line">	data: &#123;</div><div class="line">		layout: &apos;grid&apos;,</div><div class="line">        articles: [&#123;</div><div class="line">            &quot;title&quot;: &quot;What You Need To Know About CSS Variables&quot;,</div><div class="line">            &quot;url&quot;: &quot;http://tutorialzine.com/2016/03/what-you-need-to-know-about-css-variables/&quot;,</div><div class="line">            &quot;image&quot;: &#123;</div><div class="line">                &quot;large&quot;: &quot;http://oq6u0ixei.bkt.clouddn.com/QQ20170703-0@2x.png&quot;,</div><div class="line">                &quot;small&quot;: &quot;http://oq6u0ixei.bkt.clouddn.com/QQ20170703-1@2x-small.png&quot;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            &quot;title&quot;: &quot;Freebie: 4 Great Looking Pricing Tables&quot;,</div><div class="line">            &quot;url&quot;: &quot;http://tutorialzine.com/2016/02/freebie-4-great-looking-pricing-tables/&quot;,</div><div class="line">            &quot;image&quot;: &#123;</div><div class="line">                &quot;large&quot;: &quot;http://oq6u0ixei.bkt.clouddn.com/QQ20170703-1@2x.png&quot;,</div><div class="line">                &quot;small&quot;: &quot;http://oq6u0ixei.bkt.clouddn.com/QQ20170703-0@2x-small.png&quot;</div><div class="line">            &#125;</div><div class="line">        &#125;]</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line">[v-cloak] &#123;</div><div class="line">  display: none;</div><div class="line">&#125;</div><div class="line">*&#123;</div><div class="line">    margin:0;</div><div class="line">	padding:0;</div><div class="line">&#125;</div><div class="line">body&#123;</div><div class="line">    font-family:Microsoft YaHei;</div><div class="line">&#125;</div><div class="line">li&#123;</div><div class="line">    list-style:none;</div><div class="line">&#125;</div><div class="line">.bar&#123;</div><div class="line">	background-color:#5c9bb7;</div><div class="line">	border-radius: 2px;</div><div class="line">	width: 580px;</div><div class="line">	padding: 10px;</div><div class="line">	margin: 45px auto 25px;</div><div class="line">	position:relative;</div><div class="line">	text-align:right;</div><div class="line">	line-height: 1;</div><div class="line">&#125;</div><div class="line">.bar a&#123;</div><div class="line">	background:#4987a1 center center no-repeat;</div><div class="line">	width:32px;</div><div class="line">	height:32px;</div><div class="line">	display:inline-block;</div><div class="line">	text-decoration:none !important;</div><div class="line">	margin-right:5px;</div><div class="line">	border-radius:2px;</div><div class="line">	cursor:pointer;</div><div class="line">&#125;</div><div class="line">.bar a.active&#123;</div><div class="line">    background-color:#c14694;</div><div class="line">&#125;</div><div class="line">.bar a.list-icon&#123;</div><div class="line">	background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkYzNkFCQ0ZBMTBCRTExRTM5NDk4RDFEM0E5RkQ1NEZCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkYzNkFCQ0ZCMTBCRTExRTM5NDk4RDFEM0E5RkQ1NEZCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjM2QUJDRjgxMEJFMTFFMzk0OThEMUQzQTlGRDU0RkIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjM2QUJDRjkxMEJFMTFFMzk0OThEMUQzQTlGRDU0RkIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7h1bLqAAAAWUlEQVR42mL8////BwYGBn4GCACxBRlIAIxAA/4jaXoPEkMyjJ+A/g9MDJQBRhYg8RFqMwg8RJIUINYLFDmBUi+ADQAF1n8ofk9yIAy6WPg4GgtDMRYAAgwAdLYwLAoIwPgAAAAASUVORK5CYII=);</div><div class="line">&#125;</div><div class="line"></div><div class="line">.bar a.grid-icon&#123;</div><div class="line">	background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjBEQkMyQzE0MTBCRjExRTNBMDlGRTYyOTlBNDdCN0I4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjBEQkMyQzE1MTBCRjExRTNBMDlGRTYyOTlBNDdCN0I4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MERCQzJDMTIxMEJGMTFFM0EwOUZFNjI5OUE0N0I3QjgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MERCQzJDMTMxMEJGMTFFM0EwOUZFNjI5OUE0N0I3QjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4MjPshAAAAXklEQVR42mL4////h/8I8B6IGaCYKHFGEMnAwCDIAAHvgZgRyiZKnImBQsACxB+hNoDAQyQ5osQZIT4gH1DsBZABH6AB8x/JaQzEig++WPiII7Rxio/GwmCIBYAAAwAwVIzMp1R0aQAAAABJRU5ErkJggg==);</div><div class="line">&#125;</div><div class="line">ul.grid&#123;</div><div class="line">	width: 570px;</div><div class="line">	margin: 0 auto;</div><div class="line">	text-align: left;</div><div class="line">&#125;</div><div class="line">ul.grid li&#123;</div><div class="line">	padding: 2px;</div><div class="line">	float:left;</div><div class="line">&#125;</div><div class="line">ul.grid li img&#123;</div><div class="line">	width:280px;</div><div class="line">	height:280px;</div><div class="line">	object-fit: cover;</div><div class="line">	display:block;</div><div class="line">	border:none;</div><div class="line">&#125;</div><div class="line">ul.list&#123;</div><div class="line">	width: 500px;</div><div class="line">	margin: 0 auto;</div><div class="line">	text-align: left;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul.list li&#123;</div><div class="line">	border-bottom: 1px solid #ddd;</div><div class="line">	padding: 10px;</div><div class="line">	overflow: hidden;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul.list li img&#123;</div><div class="line">	width:120px;</div><div class="line">	height:120px;</div><div class="line">	float:left;</div><div class="line">	border:none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul.list li p&#123;</div><div class="line">	margin-left: 135px;</div><div class="line">	font-weight: bold;</div><div class="line">	color:#6e7a7f;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/VueJs4.gif" alt=""></p>
<blockquote>
<p>本例应用了vue.js的v-if指令进行了条件渲染，以及v-bind绑定class和v-on处理事件</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> Vue.JS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js—即时搜索]]></title>
      <url>/2017/07/03/VueJS5/</url>
      <content type="html"><![CDATA[<h3 id="即时搜索"><a href="#即时搜索" class="headerlink" title="即时搜索"></a>即时搜索</h3><pre><code>&lt;div id=&quot;main&quot; v-cloak&gt;
        &lt;div class=&quot;bar&quot;&gt;
            &lt;input type=&quot;text&quot; v-model=&quot;searchString&quot; placeholder=&quot;搜索&quot;&gt;
        &lt;/div&gt;
        &lt;ul&gt;
            &lt;li v-for=&quot;i in articles | searchFor searchString&quot;&gt;
                &lt;a v-bind:href=&quot;i.url&quot;&gt;
                    &lt;img v-bind:src=&quot;i.image&quot; alt=&quot;&quot;&gt;
                &lt;/a&gt;
                    &lt;p&gt;{{i.title}}&lt;/p&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
    &lt;/div&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">Vue.filter(&apos;searchFor&apos;,function(value,searchString)&#123;</div><div class="line">	var result = [];</div><div class="line">	if(!searchString)&#123;</div><div class="line">		return value;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	searchString = searchString.trim().toLowerCase();</div><div class="line">	result = value.filter(function(item)&#123;</div><div class="line">		if(item.title.toLowerCase().indexOf(searchString) !== -1)&#123;</div><div class="line">			return item;</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line"></div><div class="line">	return result;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">var demo = new Vue(&#123;</div><div class="line">	el:&apos;#main&apos;,</div><div class="line">	data:&#123;</div><div class="line">		searchString:&apos;&apos;,</div><div class="line">		articles:[</div><div class="line">        &#123;</div><div class="line">            &quot;title&quot;: &quot;What You Need To Know About CSS Variables&quot;,</div><div class="line">            &quot;url&quot;: &quot;http://tutorialzine.com/2016/03/what-you-need-to-know-about-css-variables/&quot;,</div><div class="line">            &quot;image&quot;: &quot;http://oq6u0ixei.bkt.clouddn.com/QQ20170703-1@2x-small.png&quot;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            &quot;title&quot;: &quot;Freebie: 4 Great Looking Pricing Tables&quot;,</div><div class="line">            &quot;url&quot;: &quot;http://tutorialzine.com/2016/02/freebie-4-great-looking-pricing-tables/&quot;,</div><div class="line">            &quot;image&quot;: &quot;http://oq6u0ixei.bkt.clouddn.com/QQ20170703-0@2x-small.png&quot;</div><div class="line">        &#125;</div><div class="line">		]</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">[v-cloak] &#123;</div><div class="line">  display: none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">*&#123;</div><div class="line">	margin:0;</div><div class="line">	padding:0;</div><div class="line">&#125;</div><div class="line">.bar&#123;</div><div class="line">    background-color:#5c9bb7;</div><div class="line"></div><div class="line">    background-image:-webkit-linear-gradient(top, #5c9bb7, #5392ad);</div><div class="line">    background-image:-moz-linear-gradient(top, #5c9bb7, #5392ad);</div><div class="line">    background-image:linear-gradient(top, #5c9bb7, #5392ad);</div><div class="line"></div><div class="line">    box-shadow: 0 1px 1px #ccc;</div><div class="line">    border-radius: 2px;</div><div class="line">    width: 400px;</div><div class="line">    padding: 14px;</div><div class="line">    margin: 45px auto 20px;</div><div class="line">    position:relative;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.bar input&#123;</div><div class="line">    background:#fff no-repeat 13px 13px;</div><div class="line">    border: none;</div><div class="line">    width: 100%;</div><div class="line">    line-height: 19px;</div><div class="line">    padding: 11px 0;</div><div class="line"></div><div class="line">    border-radius: 2px;</div><div class="line">    box-shadow: 0 2px 8px #c4c4c4 inset;</div><div class="line">    text-align: left;</div><div class="line">    font-size: 14px;</div><div class="line">    font-family: inherit;</div><div class="line">    color: #738289;</div><div class="line">    font-weight: bold;</div><div class="line">    outline: none;</div><div class="line">    text-indent: 40px;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul&#123;</div><div class="line">    list-style: none;</div><div class="line">    width: 428px;</div><div class="line">    margin: 0 auto;</div><div class="line">    text-align: left;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul li&#123;</div><div class="line">    border-bottom: 1px solid #ddd;</div><div class="line">    padding: 10px;</div><div class="line">    overflow: hidden;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul li img&#123;</div><div class="line">    width:60px;</div><div class="line">    height:60px;</div><div class="line">    float:left;</div><div class="line">    border:none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">ul li p&#123;</div><div class="line">    margin-left: 75px;</div><div class="line">    font-weight: bold;</div><div class="line">    padding-top: 12px;</div><div class="line">    color:#6e7a7f;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/VueJs6.gif" alt=""></p>
<blockquote>
<p>这个例子主要应用了vue.js的自定义过滤器，可以通过Vue.filter()注册一个全局过滤器，具体用法可以参考这里，vue.js也提供了一些内置过滤器。</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> Vue.JS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js——双向数据绑定]]></title>
      <url>/2017/07/03/VueJS1/</url>
      <content type="html"><![CDATA[<h3 id="双向数据绑定"><a href="#双向数据绑定" class="headerlink" title="双向数据绑定"></a>双向数据绑定</h3><pre><code>&lt;div id=&quot;main&quot; v-cloak @click=&quot;hideTooltip&quot; &gt;
    &lt;div class=&quot;tooltip&quot; v-if=&quot;show_tooltip&quot; @click.stop&gt;
        &lt;input type=&quot;text&quot; v-model=&quot;text_content&quot; /&gt;
    &lt;/div&gt;
    &lt;p @click.stop=&quot;toggleTooltip&quot;&gt;{{text_content}}&lt;/p&gt;
&lt;/div&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var demo = new Vue(&#123;</div><div class="line">    el: &apos;#main&apos;,</div><div class="line">    data: &#123;</div><div class="line">        show_tooltip: false,</div><div class="line">        text_content: &apos;Edit me.&apos;</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        hideTooltip: function()&#123;</div><div class="line">            this.show_tooltip = false;</div><div class="line">        &#125;,</div><div class="line">        toggleTooltip: function()&#123;</div><div class="line">            this.show_tooltip = !this.show_tooltip;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">[v-cloak] &#123;</div><div class="line">  display: none;</div><div class="line">&#125;</div><div class="line">*&#123;</div><div class="line">    margin:0;</div><div class="line">	padding:0;</div><div class="line">&#125;</div><div class="line">body&#123;</div><div class="line">    font-family:Microsoft YaHei;</div><div class="line">    text-align:center;</div><div class="line">&#125;</div><div class="line">li&#123;</div><div class="line">    list-style:none;</div><div class="line">&#125;</div><div class="line">.tooltip&#123;</div><div class="line">	background-color:#5c9bb7;</div><div class="line">	border-radius:3px;</div><div class="line">	width: 290px;</div><div class="line">	padding: 10px;</div><div class="line">	position: absolute;</div><div class="line">	left:50%;</div><div class="line">	margin-left:-150px;</div><div class="line">	top: 80px;</div><div class="line">&#125;</div><div class="line">.tooltip:after&#123;</div><div class="line">	content:&apos;&apos;;</div><div class="line">	position:absolute;</div><div class="line">	border:6px solid #5190ac;</div><div class="line">	border-color:#5190ac transparent transparent;</div><div class="line">	width:0;</div><div class="line">	height:0;</div><div class="line">	bottom:-12px;</div><div class="line">	left:50%;</div><div class="line">	margin-left:-6px;</div><div class="line">&#125;</div><div class="line">.tooltip input&#123;</div><div class="line">	border: none;</div><div class="line">	width: 100%;</div><div class="line">	line-height: 34px;</div><div class="line">	border-radius: 3px;</div><div class="line">	box-shadow: 0 2px 6px #bbb inset;</div><div class="line">	text-align: center;</div><div class="line">	font-size: 16px;</div><div class="line">	font-family: inherit;</div><div class="line">	color: #8d9395;</div><div class="line">	font-weight: bold;</div><div class="line">	outline: none;</div><div class="line">&#125;</div><div class="line">p&#123;</div><div class="line">	font-size:22px;</div><div class="line">	font-weight:bold;</div><div class="line">	color:#6d8088;</div><div class="line">	height: 30px;</div><div class="line">	cursor:pointer;</div><div class="line">&#125;</div><div class="line">p:before&#123;</div><div class="line">	content:&apos;✎&apos;;</div><div class="line">	display:inline-block;</div><div class="line">	margin-right:5px;</div><div class="line">	font-weight:normal;</div><div class="line">	vertical-align: text-bottom;</div><div class="line">&#125;</div><div class="line">#main&#123;</div><div class="line">	height:300px;</div><div class="line">	position:relative;</div><div class="line">	padding-top: 150px;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/VueJs1.gif" alt=""></p>
<blockquote>
<p>数据绑定是vue.js的基础。本例中就是利用了vue.js的v-model指令在表单元素上创建双向数据绑定。</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> Vue.JS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vue.js——60分钟快速入门]]></title>
      <url>/2017/07/03/VueJS/</url>
      <content type="html"><![CDATA[<p>Vue.js是当下很火的一个JavaScript MVVM库，它是以数据驱动和组件化的思想构建的。相比于Angular.js，Vue.js提供了更加简洁、更易于理解的API，使得我们能够快速地上手并使用Vue.js。</p>
<p>本文摘自：<a href="http://www.cnblogs.com/rik28/p/6024425.html" target="_blank" rel="external"></a></p>
<p>如果你之前已经习惯了用jQuery操作DOM，学习Vue.js时请先抛开手动操作DOM的思维，因为Vue.js是数据驱动的，你无需手动操作DOM。它通过一些特殊的HTML语法，将DOM和数据绑定起来。一旦你创建了绑定，DOM将和数据保持同步，每当变更了数据，DOM也会相应地更新。</p>
<p>当然了，在使用Vue.js时，你也可以结合其他库一起使用，比如jQuery。</p>
<h3 id="MVVM模式"><a href="#MVVM模式" class="headerlink" title="MVVM模式"></a>MVVM模式</h3><p>下图不仅概括了MVVM模式（Model-View-ViewModel），还描述了在Vue.js中ViewModel是如何和View以及Model进行交互的。</p>
<p>ViewModel是Vue.js的核心，它是一个Vue实例。Vue实例是作用于某一个HTML元素上的，这个元素可以是HTML的body元素，也可以是指定了id的某个元素。</p>
<p>当创建了ViewModel后，双向绑定是如何达成的呢？</p>
<p>首先，我们将上图中的DOM Listeners和Data Bindings看作两个工具，它们是实现双向绑定的关键。<br>从View侧看，ViewModel中的DOM Listeners工具会帮我们监测页面上DOM元素的变化，如果有变化，则更改Model中的数据；<br>从Model侧看，当我们更新Model中的数据时，Data Bindings工具会帮我们更新页面中的DOM元素。</p>
<h3 id="Hello-World示例"><a href="#Hello-World示例" class="headerlink" title="Hello World示例"></a>Hello World示例</h3><p>了解一门语言，或者学习一门新技术，编写Hello World示例是我们的必经之路。<br>这段代码在画面上输出”Hello World!”。</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;!--这是我们的View--&gt;
    &lt;div id=&quot;app&quot;&gt;
        {{ message }}
    &lt;/div&gt;
&lt;/body&gt;
&lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    // 这是我们的Model
    var exampleData = {
        message: &apos;Hello World!&apos;
    }

    // 创建一个 Vue 实例或 &quot;ViewModel&quot;
    // 它连接 View 与 Model
    new Vue({
        el: &apos;#app&apos;,
        data: exampleData
    })
&lt;/script&gt;
&lt;/html&gt;
</code></pre><p>使用Vue的过程就是定义MVVM各个组成部分的过程的过程。</p>
<pre><code>定义View
定义Model
创建一个Vue实例或&quot;ViewModel&quot;，它用于连接View和Model
</code></pre><p>在创建Vue实例时，需要传入一个选项对象，选项对象可以包含数据、挂载元素、方法、模生命周期钩子等等。</p>
<p>在这个示例中，选项对象的el属性指向View，el: ‘#app’表示该Vue实例将挂载到<div id="app">…</div>这个元素；data属性指向Model，data: exampleData表示我们的Model是exampleData对象。<br>Vue.js有多种数据绑定的语法，最基础的形式是文本插值，使用一对大括号语法，在运行时会被数据对象的message属性替换，所以页面上会输出”Hello World!”。</p>
<p>Vue.js已经更新到2.0版本了，但由于还不是正式版，本文的代码都是1.0.25版本的。</p>
<h4 id="双向绑定示例"><a href="#双向绑定示例" class="headerlink" title="双向绑定示例"></a>双向绑定示例</h4><p>MVVM模式本身是实现了双向绑定的，在Vue.js中可以使用v-model指令在表单元素上创建双向数据绑定。</p>
<pre><code>&lt;!--这是我们的View--&gt;
&lt;div id=&quot;app&quot;&gt;
    &lt;p&gt;{{ message }}&lt;/p&gt;
    &lt;input type=&quot;text&quot; v-model=&quot;message&quot;/&gt;
&lt;/div&gt;
</code></pre><p>将message绑定到文本框，当更改文本框的值时，<code>&lt;p&gt;{{ message }}&lt;/p&gt;</code> 中的内容也会被更新。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065311062-227248599.gif" alt=""></p>
<p>反过来，如果改变message的值，文本框的值也会被更新，我们可以在Chrome控制台进行尝试。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065313046-1157492348.gif" alt=""></p>
<h3 id="Vue-js的常用指令"><a href="#Vue-js的常用指令" class="headerlink" title="Vue.js的常用指令"></a>Vue.js的常用指令</h3><p>上面用到的v-model是Vue.js常用的一个指令，那么指令是什么呢？</p>
<p>Vue.js的指令是以v-开头的，它们作用于HTML元素，指令提供了一些特殊的特性，将指令绑定在元素上时，指令会为绑定的目标元素添加一些特殊的行为，我们可以将指令看作特殊的HTML特性（attribute）。</p>
<p>Vue.js提供了一些常用的内置指令，接下来我们将介绍以下几个内置指令：</p>
<ul>
<li>v-if指令</li>
<li>v-show指令</li>
<li>v-else指令</li>
<li>v-for指令</li>
<li>v-bind指令</li>
<li>v-on指令</li>
</ul>
<p>Vue.js具有良好的扩展性，我们也可以开发一些自定义的指令，后面的文章会介绍自定义指令。</p>
<h3 id="v-if指令"><a href="#v-if指令" class="headerlink" title="v-if指令"></a>v-if指令</h3><p>v-if是条件渲染指令，它根据表达式的真假来删除和插入元素，它的基本语法如下：</p>
<p>v-if=”expression”</p>
<p>expression是一个返回bool值的表达式，表达式可以是一个bool属性，也可以是一个返回bool的运算式。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line">            &lt;h1&gt;Hello, Vue.js!&lt;/h1&gt;</div><div class="line">            &lt;h1 v-if=&quot;yes&quot;&gt;Yes!&lt;/h1&gt;</div><div class="line">            &lt;h1 v-if=&quot;no&quot;&gt;No!&lt;/h1&gt;</div><div class="line">            &lt;h1 v-if=&quot;age &gt;= 25&quot;&gt;Age: &#123;&#123; age &#125;&#125;&lt;/h1&gt;</div><div class="line">            &lt;h1 v-if=&quot;name.indexOf(&apos;jack&apos;) &gt;= 0&quot;&gt;Name: &#123;&#123; name &#125;&#125;&lt;/h1&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line"></div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                yes: true,</div><div class="line">                no: false,</div><div class="line">                age: 28,</div><div class="line">                name: &apos;keepfool&apos;</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>注意：yes, no, age, name这4个变量都来源于Vue实例选项对象的data属性。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065314546-1211050706.png" alt=""></p>
<p>这段代码使用了4个表达式：</p>
<pre><code>数据的yes属性为true，所以&quot;Yes!&quot;会被输出；
数据的no属性为false，所以&quot;No!&quot;不会被输出；
运算式age &gt;= 25返回true，所以&quot;Age: 28&quot;会被输出；
运算式name.indexOf(&apos;jack&apos;) &gt;= 0返回false，所以&quot;Name: keepfool&quot;不会被输出。
</code></pre><p>注意：v-if指令是根据条件表达式的值来执行元素的插入或者删除行为。</p>
<p>这一点可以从渲染的HTML源代码看出来，面上只渲染了3个<code>&lt;h1&gt;</code>元素，v-if值为false的<code>&lt;h1&gt;</code>元素没有渲染到HTML。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065316265-161676773.png" alt=""></p>
<p>为了再次验证这一点，可以在Chrome控制台更改age属性，使得表达式age &gt;= 25的值为false，可以看到<code>&lt;h1&gt;Age: 28&lt;/h1&gt;</code>元素被删除了。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065319406-1162614113.gif" alt=""></p>
<p>age是定义在选项对象的data属性中的，为什么Vue实例可以直接访问它呢？<br>这是因为每个Vue实例都会代理其选项对象里的data属性。</p>
<h3 id="v-show指令"><a href="#v-show指令" class="headerlink" title="v-show指令"></a>v-show指令</h3><p>v-show也是条件渲染指令，和v-if指令不同的是，使用v-show指令的元素始终会被渲染到HTML，它只是简单地为元素设置CSS的style属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line">            &lt;h1&gt;Hello, Vue.js!&lt;/h1&gt;</div><div class="line">            &lt;h1 v-show=&quot;yes&quot;&gt;Yes!&lt;/h1&gt;</div><div class="line">            &lt;h1 v-show=&quot;no&quot;&gt;No!&lt;/h1&gt;</div><div class="line">            &lt;h1 v-show=&quot;age &gt;= 25&quot;&gt;Age: &#123;&#123; age &#125;&#125;&lt;/h1&gt;</div><div class="line">            &lt;h1 v-show=&quot;name.indexOf(&apos;jack&apos;) &gt;= 0&quot;&gt;Name: &#123;&#123; name &#125;&#125;&lt;/h1&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line"></div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                yes: true,</div><div class="line">                no: false,</div><div class="line">                age: 28,</div><div class="line">                name: &apos;keepfool&apos;</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065321359-1780927154.png" alt=""></p>
<p>在Chrome控制台更改age属性，使得表达式age &gt;= 25的值为false，可以看到<code>&lt;h1&gt;Age: 24&lt;/h1&gt;</code>元素被设置了style=”display:none”样式。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065324343-1072339483.gif" alt=""></p>
<h3 id="v-else指令"><a href="#v-else指令" class="headerlink" title="v-else指令"></a>v-else指令</h3><p>可以用v-else指令为v-if或v-show添加一个“else块”。v-else元素必须立即跟在v-if、v-else-if或v-show元素的后面——否则它不能被识别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line"></div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line">            &lt;h1 v-if=&quot;age &gt;= 25&quot;&gt;Age: &#123;&#123; age &#125;&#125;&lt;/h1&gt;</div><div class="line">            &lt;h1 v-else&gt;Name: &#123;&#123; name &#125;&#125;&lt;/h1&gt;</div><div class="line">            &lt;h1&gt;---------------------分割线---------------------&lt;/h1&gt;</div><div class="line">            &lt;h1 v-show=&quot;name.indexOf(&apos;keep&apos;) &gt;= 0&quot;&gt;Name: &#123;&#123; name &#125;&#125;&lt;/h1&gt;</div><div class="line">            &lt;h1 v-else&gt;Sex: &#123;&#123; sex &#125;&#125;&lt;/h1&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                age: 28,</div><div class="line">                name: &apos;keepfool&apos;,</div><div class="line">                sex: &apos;Male&apos;</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>v-else元素是否渲染在HTML中，取决于前面使用的是v-if还是v-show指令。<br>这段代码中v-if为true，后面的v-else不会渲染到HTML；v-show为tue，但是后面的v-else仍然渲染到HTML了。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065326546-136301763.png" alt=""></p>
<h3 id="v-for指令"><a href="#v-for指令" class="headerlink" title="v-for指令"></a>v-for指令</h3><p>v-for指令基于一个数组渲染一个列表，它和JavaScript的遍历语法相似：</p>
<p>v-for=”item in items”</p>
<p>items是一个数组，item是当前被遍历的数组元素。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line"></div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;styles/demo.css&quot; /&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line"></div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line">            &lt;table&gt;</div><div class="line">                &lt;thead&gt;</div><div class="line">                    &lt;tr&gt;</div><div class="line">                        &lt;th&gt;Name&lt;/th&gt;</div><div class="line">                        &lt;th&gt;Age&lt;/th&gt;</div><div class="line">                        &lt;th&gt;Sex&lt;/th&gt;</div><div class="line">                    &lt;/tr&gt;</div><div class="line">                &lt;/thead&gt;</div><div class="line">                &lt;tbody&gt;</div><div class="line">                    &lt;tr v-for=&quot;person in people&quot;&gt;</div><div class="line">                        &lt;td&gt;&#123;&#123; person.name  &#125;&#125;&lt;/td&gt;</div><div class="line">                        &lt;td&gt;&#123;&#123; person.age  &#125;&#125;&lt;/td&gt;</div><div class="line">                        &lt;td&gt;&#123;&#123; person.sex  &#125;&#125;&lt;/td&gt;</div><div class="line">                    &lt;/tr&gt;</div><div class="line">                &lt;/tbody&gt;</div><div class="line">            &lt;/table&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                people: [&#123;</div><div class="line">                    name: &apos;Jack&apos;,</div><div class="line">                    age: 30,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;, &#123;</div><div class="line">                    name: &apos;Bill&apos;,</div><div class="line">                    age: 26,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;, &#123;</div><div class="line">                    name: &apos;Tracy&apos;,</div><div class="line">                    age: 22,</div><div class="line">                    sex: &apos;Female&apos;</div><div class="line">                &#125;, &#123;</div><div class="line">                    name: &apos;Chris&apos;,</div><div class="line">                    age: 36,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;]</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line"></div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>我们在选项对象的data属性中定义了一个people数组，然后在#app元素内使用v-for遍历people数组，输出每个person对象的姓名、年龄和性别。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065327859-2129607250.png" alt=""></p>
<h3 id="v-bind指令"><a href="#v-bind指令" class="headerlink" title="v-bind指令"></a>v-bind指令</h3><p>v-bind指令可以在其名称后面带一个参数，中间放一个冒号隔开，这个参数通常是HTML元素的特性（attribute），例如：v-bind:class</p>
<p>v-bind:argument=”expression”</p>
<p>下面这段代码构建了一个简单的分页条，v-bind指令作用于元素的class特性上。<br>这个指令包含一个表达式，表达式的含义是：高亮当前页。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;styles/demo.css&quot; /&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line">            &lt;ul class=&quot;pagination&quot;&gt;</div><div class="line">                &lt;li v-for=&quot;n in pageCount&quot;&gt;</div><div class="line">                    &lt;a href=&quot;javascripit:void(0)&quot; v-bind:class=&quot;activeNumber === n + 1 ? &apos;active&apos; : &apos;&apos;&quot;&gt;&#123;&#123; n + 1 &#125;&#125;&lt;/a&gt;</div><div class="line">                &lt;/li&gt;</div><div class="line">            &lt;/ul&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                activeNumber: 1,</div><div class="line">                pageCount: 10</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>注意v-for=”n in pageCount”这行代码，pageCount是一个整数，遍历时n从0开始，然后遍历到pageCount –1结束。</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065329281-1176325976.png" alt=""></p>
<h3 id="v-on指令"><a href="#v-on指令" class="headerlink" title="v-on指令"></a>v-on指令</h3><p>v-on指令用于给监听DOM事件，它的用语法和v-bind是类似的，例如监听<a>元素的点击事件：</a></p>
<p><a v-on:click="doSomething"></a></p>
<p>有两种形式调用方法：绑定一个方法（让事件指向方法的引用），或者使用内联语句。<br>Greet按钮将它的单击事件直接绑定到greet()方法，而Hi按钮则是调用say()方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line">            &lt;p&gt;&lt;input type=&quot;text&quot; v-model=&quot;message&quot;&gt;&lt;/p&gt;</div><div class="line">            &lt;p&gt;</div><div class="line">                &lt;!--click事件直接绑定一个方法--&gt;</div><div class="line">                &lt;button v-on:click=&quot;greet&quot;&gt;Greet&lt;/button&gt;</div><div class="line">            &lt;/p&gt;</div><div class="line">            &lt;p&gt;</div><div class="line">                &lt;!--click事件使用内联语句--&gt;</div><div class="line">                &lt;button v-on:click=&quot;say(&apos;Hi&apos;)&quot;&gt;Hi&lt;/button&gt;</div><div class="line">            &lt;/p&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                message: &apos;Hello, Vue.js!&apos;</div><div class="line">            &#125;,</div><div class="line">            // 在 `methods` 对象中定义方法</div><div class="line">            methods: &#123;</div><div class="line">                greet: function() &#123;</div><div class="line">                    // // 方法内 `this` 指向 vm</div><div class="line">                    alert(this.message)</div><div class="line">                &#125;,</div><div class="line">                say: function(msg) &#123;</div><div class="line">                    alert(msg)</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065331124-2002999272.gif" alt=""></p>
<h3 id="v-bind和v-on的缩写"><a href="#v-bind和v-on的缩写" class="headerlink" title="v-bind和v-on的缩写"></a>v-bind和v-on的缩写</h3><p>Vue.js为最常用的两个指令v-bind和v-on提供了缩写方式。v-bind指令可以缩写为一个冒号，v-on指令可以缩写为@符号。</p>
<pre><code>&lt;!--完整语法--&gt;
&lt;a href=&quot;javascripit:void(0)&quot; v-bind:class=&quot;activeNumber === n + 1 ? &apos;active&apos; : &apos;&apos;&quot;&gt;{{ n + 1 }}&lt;/a&gt;
&lt;!--缩写语法--&gt;
&lt;a href=&quot;javascripit:void(0)&quot; :class=&quot;activeNumber=== n + 1 ? &apos;active&apos; : &apos;&apos;&quot;&gt;{{ n + 1 }}&lt;/a&gt;

&lt;!--完整语法--&gt;
&lt;button v-on:click=&quot;greet&quot;&gt;Greet&lt;/button&gt;
&lt;!--缩写语法--&gt;
&lt;button @click=&quot;greet&quot;&gt;Greet&lt;/button&gt;
</code></pre><h3 id="综合示例"><a href="#综合示例" class="headerlink" title="综合示例"></a>综合示例</h3><p>现在我们已经介绍了一些Vue.js的基础知识了，结合以上知识我们可以来做个小Demo。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line"></div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">        &lt;title&gt;&lt;/title&gt;</div><div class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;styles/demo.css&quot; /&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line"></div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;div id=&quot;app&quot;&gt;</div><div class="line"></div><div class="line">            &lt;fieldset&gt;</div><div class="line">                &lt;legend&gt;</div><div class="line">                    Create New Person</div><div class="line">                &lt;/legend&gt;</div><div class="line">                &lt;div class=&quot;form-group&quot;&gt;</div><div class="line">                    &lt;label&gt;Name:&lt;/label&gt;</div><div class="line">                    &lt;input type=&quot;text&quot; v-model=&quot;newPerson.name&quot;/&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">                &lt;div class=&quot;form-group&quot;&gt;</div><div class="line">                    &lt;label&gt;Age:&lt;/label&gt;</div><div class="line">                    &lt;input type=&quot;text&quot; v-model=&quot;newPerson.age&quot;/&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">                &lt;div class=&quot;form-group&quot;&gt;</div><div class="line">                    &lt;label&gt;Sex:&lt;/label&gt;</div><div class="line">                    &lt;select v-model=&quot;newPerson.sex&quot;&gt;</div><div class="line">                    &lt;option value=&quot;Male&quot;&gt;Male&lt;/option&gt;</div><div class="line">                    &lt;option value=&quot;Female&quot;&gt;Female&lt;/option&gt;</div><div class="line">                &lt;/select&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">                &lt;div class=&quot;form-group&quot;&gt;</div><div class="line">                    &lt;label&gt;&lt;/label&gt;</div><div class="line">                    &lt;button @click=&quot;createPerson&quot;&gt;Create&lt;/button&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">        &lt;/fieldset&gt;</div><div class="line">        &lt;table&gt;</div><div class="line">            &lt;thead&gt;</div><div class="line">                &lt;tr&gt;</div><div class="line">                    &lt;th&gt;Name&lt;/th&gt;</div><div class="line">                    &lt;th&gt;Age&lt;/th&gt;</div><div class="line">                    &lt;th&gt;Sex&lt;/th&gt;</div><div class="line">                    &lt;th&gt;Delete&lt;/th&gt;</div><div class="line">                &lt;/tr&gt;</div><div class="line">            &lt;/thead&gt;</div><div class="line">            &lt;tbody&gt;</div><div class="line">                &lt;tr v-for=&quot;person in people&quot;&gt;</div><div class="line">                    &lt;td&gt;&#123;&#123; person.name &#125;&#125;&lt;/td&gt;</div><div class="line">                    &lt;td&gt;&#123;&#123; person.age &#125;&#125;&lt;/td&gt;</div><div class="line">                    &lt;td&gt;&#123;&#123; person.sex &#125;&#125;&lt;/td&gt;</div><div class="line">                    &lt;td :class=&quot;&apos;text-center&apos;&quot;&gt;&lt;button @click=&quot;deletePerson($index)&quot;&gt;Delete&lt;/button&gt;&lt;/td&gt;</div><div class="line">                &lt;/tr&gt;</div><div class="line">            &lt;/tbody&gt;</div><div class="line">        &lt;/table&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &lt;script src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        var vm = new Vue(&#123;</div><div class="line">            el: &apos;#app&apos;,</div><div class="line">            data: &#123;</div><div class="line">                newPerson: &#123;</div><div class="line">                    name: &apos;&apos;,</div><div class="line">                    age: 0,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;,</div><div class="line">                people: [&#123;</div><div class="line">                    name: &apos;Jack&apos;,</div><div class="line">                    age: 30,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;, &#123;</div><div class="line">                    name: &apos;Bill&apos;,</div><div class="line">                    age: 26,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;, &#123;</div><div class="line">                    name: &apos;Tracy&apos;,</div><div class="line">                    age: 22,</div><div class="line">                    sex: &apos;Female&apos;</div><div class="line">                &#125;, &#123;</div><div class="line">                    name: &apos;Chris&apos;,</div><div class="line">                    age: 36,</div><div class="line">                    sex: &apos;Male&apos;</div><div class="line">                &#125;]</div><div class="line">            &#125;,</div><div class="line">            methods:&#123;</div><div class="line">                createPerson: function()&#123;</div><div class="line">                    this.people.push(this.newPerson);</div><div class="line">                    // 添加完newPerson对象后，重置newPerson对象</div><div class="line">                    this.newPerson = &#123;name: &apos;&apos;, age: 0, sex: &apos;Male&apos;&#125;</div><div class="line">                &#125;,</div><div class="line">                deletePerson: function(index)&#123;</div><div class="line">                    // 删一个数组元素</div><div class="line">                    this.people.splice(index,1);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &lt;/script&gt;</div><div class="line"></div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/341820-20160627065333452-768092605.gif" alt=""></p>
<h3 id="总结本文"><a href="#总结本文" class="headerlink" title="总结本文"></a>总结本文</h3><p>简单介绍了Vue.js的MVVM模型和它的双向绑定机制，然后以一个Hello World示例开始了我们的Vue.js之旅，接着我们了解了几个比较常用的指令，最后根据这些知识我们构建了一个简单的示例。</p>
]]></content>
      
        
        <tags>
            
            <tag> Vue.JS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript之冒泡型事件、捕获型事件]]></title>
      <url>/2017/06/02/event/</url>
      <content type="html"><![CDATA[<p>冒泡型事件的基本思想是、事件按照从最特定的事件目标到最不特定的事件目标(document对象)的顺序触发。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;  </div><div class="line">    &lt;head&gt;  </div><div class="line">        &lt;title&gt;&lt;/title&gt;  </div><div class="line">    &lt;/head&gt;  </div><div class="line">    &lt;body onclick=&quot;theClick()&quot;&gt;  </div><div class="line">        &lt;div onclick=&quot;theClick()&quot;&gt;点击&lt;/div&gt;  </div><div class="line">    &lt;/body&gt;  </div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>IE5.5冒泡顺序如下：<br>(1)<code>&lt;div&gt;</code><br>(2)<code>&lt;body&gt;</code><br>(3)<code>&lt;document&gt;</code><br><img src="http://oq6u0ixei.bkt.clouddn.com/event1.jpeg" alt=""></p>
<p>IE6呢、稍微修改了冒泡型事件、这样<html>元素也可以接收冒泡的事件、还是上面的代码。<br>IE6的冒泡顺序如下：<br>(1)<code>&lt;div&gt;</code><br>(2)<code>&lt;body&gt;</code><br>(3)<code>&lt;html&gt;</code><br>(4)<code>&lt;document&gt;</code><br><img src="http://oq6u0ixei.bkt.clouddn.com/event2.jpeg" alt=""></html></p>
<p>Mozilla1.0及更高版本也支持冒泡事件但到达了另一层次。类似IE6.0，它也支持<html>元素级别的事件、不过，事件”起泡”一直上升到Windows窗口对象。继续前面的代码、点击<div>元素将造成下图所示的事件冒泡：</div></html></p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/event4.jpeg" alt=""></p>
<h3 id="捕获型事件"><a href="#捕获型事件" class="headerlink" title="捕获型事件"></a>捕获型事件</h3><p>IE使用冒泡型事件、相对的、Netscape使用了另一种称为捕获型事件(eventcapturing)的解决方案、事件的捕获和冒泡刚好相反的两种过程——捕获型事件中、事件从最不精确的对象(document对象)开始触发、然后到最精确(也可以在窗口级别捕获事件，不过必寻由开发人员特别指定)。Netscape不会将页面上的很多元素暴露给事件。继续使用前面的代码示例、事件按照下面的路径传播：<br>(1)document<br>(2)<code>&lt;div&gt;</code><br>有些人也称之为自顶向下的事件模型，因为它是从DOM层次的顶端开始向下延伸的：</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/event3.jpeg" alt=""></p>
<p>DOM事件流：<br>DOM(文档对象模型)结构是一个树型结构，当一个HTML元素产生一个事件时，该事件会在元素结点与根节点之间按特定的顺序传播，路径所经过的节点都会收到该事件，这个传播过程可称为DOM事件流。事件顺序有两种类型：事件捕捉和事件冒泡。</p>
<p>DOM标准的事件模型<br>我们已经对上面两个不同的事件模型进行了解释和对比。DOM标准同时支持两种事件模型，即捕获型事件与冒泡型事件，但是，捕获型事件先发生。两种事件流都会触发DOM中的所有对象，从document对象开始，也在document对象结束（大部分兼容标准的浏览器会继续将事件是捕捉/冒泡延续到window对象）。继续使用前面的例子、在与DOM兼容的浏览器中点击<div>元素时、事件流的进行如下图：</div></p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/event6.jpeg" alt=""></p>
<p>注意因为事件的目标(<code>&lt;div&gt;</code>元素)是最精确的元素(于是，在DOM树中最深)，实际上它会接收两次事件，一次在捕获过程中，另一次在冒泡过程中。DOM事件模型的最独特的性质是，文本节点也触发事件(在IE不会)。所以如果点击示例中的<code>&lt;div&gt;</code>点击<code>&lt;/div&gt;</code>、实际的事件流应该是：</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/event5.jpeg" alt=""></p>
<blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/06/02/jiujiu" target="_blank" rel="external">javascript之杨辉三角形</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript之九九乘法表]]></title>
      <url>/2017/06/02/jiujiu/</url>
      <content type="html"><![CDATA[<h3 id="一、左下角为度的梯形乘法表："><a href="#一、左下角为度的梯形乘法表：" class="headerlink" title="一、左下角为度的梯形乘法表："></a>一、左下角为度的梯形乘法表：</h3><p><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170602-3@2x.png" alt=""></p>
<p>for 循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">for ( var x = 1; x &lt;= 9; x++) &#123;</div><div class="line">    document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">    for ( var y = 1; y &lt;= x; y++) &#123;</div><div class="line">        document.write(&quot;&lt;th&gt;&quot; + x + &quot;*&quot; + y + &quot;=&quot; + (x * y) + &quot;&lt;/th&gt;&quot;);</div><div class="line">    &#125;</div><div class="line">    document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure>
<p>while 循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">var i = 1;</div><div class="line">while(i&lt;=9)&#123;</div><div class="line">  document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">    var j = 1;</div><div class="line">    while(j&lt;=i)&#123;</div><div class="line">      document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">      j++;</div><div class="line">  &#125;</div><div class="line">  document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">  i++;</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure>
<h3 id="二、左上角为度的梯形乘法表："><a href="#二、左上角为度的梯形乘法表：" class="headerlink" title="二、左上角为度的梯形乘法表："></a>二、左上角为度的梯形乘法表：</h3><p><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170602-2@2x.png" alt=""></p>
<p>for 循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">for(var i=9; i&gt;=1; i--)&#123;</div><div class="line">  document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">  for(var j=1; j&lt;=i; j++)&#123;</div><div class="line">    document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">  &#125;</div><div class="line">  document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>while 循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">var i =9 ;</div><div class="line">while(i&gt;=1)&#123;</div><div class="line">  document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">  var j =1 ;</div><div class="line">  while(j&lt;=i)&#123;</div><div class="line">    document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">    j++;</div><div class="line">  &#125;</div><div class="line">  document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">  i--;</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure></p>
<h3 id="三、右上角为度的梯形乘法表："><a href="#三、右上角为度的梯形乘法表：" class="headerlink" title="三、右上角为度的梯形乘法表："></a>三、右上角为度的梯形乘法表：</h3><p><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170602-5@2x.png" alt=""></p>
<p>for 循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">for(var i=9; i&gt;=1; i--)&#123;</div><div class="line">	document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">	for(var j=9; j&gt;=i; j--)&#123;</div><div class="line">		document.write(&quot;&lt;td&gt; &lt;/td&gt;&quot;);</div><div class="line">	&#125;</div><div class="line">	for(var j=i; j&gt;=1; j--)&#123;</div><div class="line">		document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">	&#125;</div><div class="line">	document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>while 循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">var i =9 ;</div><div class="line">while(i&gt;=1)&#123;</div><div class="line">	document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">	var j =9 ;</div><div class="line">	while(j&gt;=i)&#123;</div><div class="line">		document.write(&quot;&lt;td&gt; &lt;/td&gt;&quot;);</div><div class="line">		j--;</div><div class="line">	&#125;</div><div class="line">	var j = i;</div><div class="line">	while(j&gt;=1)&#123;</div><div class="line">		document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">		j--;</div><div class="line">	&#125;</div><div class="line">	document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">	i--;</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure>
<h3 id="三、右下角为度的梯形乘法表："><a href="#三、右下角为度的梯形乘法表：" class="headerlink" title="三、右下角为度的梯形乘法表："></a>三、右下角为度的梯形乘法表：</h3><p><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170602-4@2x.png" alt=""></p>
<p>for 循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">for(var i=1; i&lt;=9; i++)&#123;</div><div class="line">  document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">  for(var n=i; n&lt;9; n++)&#123;</div><div class="line">    document.write(&quot;&lt;td&gt; &lt;/td&gt;&quot;);</div><div class="line">  &#125;</div><div class="line">  for(var j=i; j&gt;=1; j--)&#123;</div><div class="line">    document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">  &#125;</div><div class="line">  document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure>
<p>while 循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;table&gt;&quot;);</div><div class="line">var i =1 ;</div><div class="line">while(i&lt;=9)&#123;</div><div class="line">	document.write(&quot;&lt;tr&gt;&quot;);</div><div class="line">	var n = i;</div><div class="line">	while(n&lt;9)&#123;</div><div class="line">		document.write(&quot;&lt;td&gt; &lt;/td&gt;&quot;);</div><div class="line">		n++;</div><div class="line">	&#125;</div><div class="line">	var j = i;</div><div class="line">	while(j&gt;=1)&#123;</div><div class="line">		document.write(&quot;&lt;td&gt;&quot;+ j +&quot;*&quot;+ i +&quot;=&quot;+ i*j +&quot;&lt;/td&gt;&quot;);</div><div class="line">		j--;</div><div class="line">	&#125;</div><div class="line">	document.write(&quot;&lt;/tr&gt;&quot;);</div><div class="line">	i++;</div><div class="line">&#125;</div><div class="line">document.write(&quot;&lt;/table&gt;&quot;);</div></pre></td></tr></table></figure>
<blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/06/02/binomial-array" target="_blank" rel="external">javascript之杨辉三角形</a>.<br>  下一篇：<a href="http://localhost:4000/2017/06/02/event" target="_blank" rel="external">javascript之冒泡型事件、捕获型事件</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript之杨辉三角形]]></title>
      <url>/2017/06/02/binomial-array/</url>
      <content type="html"><![CDATA[<h3 id="javaScript——杨辉三角"><a href="#javaScript——杨辉三角" class="headerlink" title="javaScript——杨辉三角"></a>javaScript——杨辉三角</h3><p><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170602-0@2x.png" alt=""></p>
<p>杨辉三角是计算二项式乘方展开式的系数时必不可少的工具、是由数字排列而成的三角形数表。</p>
<p>资料：杨辉三角第n行的第1个数为1，第二个数为1×(n-1)，第三个数为1×(n-1)×（n-2）/2，第四个数为1×(n-1)×（n-2）/2×（n-3）/3…依此类推。</p>
<p>杨辉三角另外一个重要的特性就是每一行首尾两个数字都是1、中间的数字等于上一行相邻两个数字的和、即排列组合中通常所运用的：</p>
<pre><code>C(m,n) = C(m-1,n-1)+C(m-1,n)
</code></pre><p>根据以上性质、可以利用函数很轻松地将杨辉三角运算出来、函数接受一个参数、即希望得到杨辉三角的行数、代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pascal</span>(<span class="params">n</span>)</span>&#123;   <span class="comment">//杨辉三角,N为行数   </span></div><div class="line">    <span class="comment">//        </span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在这个函数中用两个for循环进行嵌套、外层循环数为行数、内层循环为每行内的每一项、代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>( <span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; n ; i++ )&#123;   <span class="comment">//一共N行  </span></div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">var</span> j = <span class="number">0</span> ; j &lt;= i ; j++ ) &#123;  <span class="comment">//每行数字的个数即为行号、例如第1行1个数、第2行2个数  </span></div><div class="line"></div><div class="line">    &#125;  </div><div class="line">    <span class="built_in">document</span>.write(<span class="string">"&lt;br/&gt;"</span>);  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>而在每行中每一个数字均为组合数C(m,n)、其中m为行号(从0算起)、n为在该行中的序号(从0算起)、即：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.write(Combination(i,j)+<span class="string">"&amp;nbsp;&amp;nbsp;"</span>);   <span class="comment">//引号里面的内容是两个html空格(&amp;nbsp;&amp;nbsp;)字符</span></div></pre></td></tr></table></figure></p>
<p>其中Combination(i,j)为计算组合数的函数、这个函数采用组合数的特性C(m,n) = C(m-1,n-1)+C(m-1,n)、对于这样的特性、最有效的办法就是递归：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Combination</span>(<span class="params">m,n</span>)</span>&#123;  </div><div class="line">    <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;  <span class="comment">//每行第一个数为1  </span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m == n) <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">//最后一个数为1  </span></div><div class="line">    <span class="comment">//其余都是相加而来   </span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Combination(m<span class="number">-1</span>,n<span class="number">-1</span>)+Combination(m<span class="number">-1</span>,n);  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>完整代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Combination</span>(<span class="params">m,n</span>)</span>&#123;  </div><div class="line">    <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;  <span class="comment">//每行第一个数为1  </span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m == n) <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">//最后一个数为1  </span></div><div class="line">    <span class="comment">//其余都是相加而来   </span></div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> Combination(m<span class="number">-1</span>,n<span class="number">-1</span>)+Combination(m<span class="number">-1</span>,n);  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pascal</span>(<span class="params">n</span>)</span>&#123;   <span class="comment">//杨辉三角,N为行数   </span></div><div class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; n ; i++ )&#123;   <span class="comment">//一共N行  </span></div><div class="line">        <span class="keyword">for</span> ( <span class="keyword">var</span> j = <span class="number">0</span> ; j &lt;= i ; j++ ) &#123;  <span class="comment">//每行数字的个数即为行号、例如第1行1个数、第2行2个数  </span></div><div class="line">            <span class="built_in">document</span>.write(Combination(i,j)+<span class="string">"  "</span>);  </div><div class="line">        &#125;  </div><div class="line">        <span class="built_in">document</span>.write(<span class="string">"&lt;br/&gt;"</span>);  </div><div class="line">    &#125;  </div><div class="line">&#125;</div><div class="line">Pascal(<span class="number">10</span>);</div></pre></td></tr></table></figure>
<blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/06/01/generator" target="_blank" rel="external">javascript之generator</a>.<br>  下一篇：<a href="http://localhost:4000/2017/06/02/jiujiu" target="_blank" rel="external">javascript之之九九乘法表</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript之generator]]></title>
      <url>/2017/06/01/generator/</url>
      <content type="html"><![CDATA[<p>generator（生成器）是ES6标准引入的新的数据类型。一个generator看上去像一个函数，但可以返回多次。</p>
<p>ES6定义generator标准的哥们借鉴了Python的generator的概念和语法，如果你对Python的generator很熟悉，那么ES6的generator就是小菜一碟了。如果你对Python还不熟，赶快恶补Python教程！。</p>
<p>我们先复习函数的概念。一个函数是一段完整的代码，调用一个函数就是传入参数，然后返回结果：</p>
<pre><code>function foo(x) {
    return x + x;
}

var r = foo(1); // 调用foo函数
</code></pre><blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/06/01/arrow-function" target="_blank" rel="external">javascript之箭头函数</a>.<br>  下一篇：<a href="http://localhost:4000/2017/06/02/binomial-array" target="_blank" rel="external">javascript之杨辉三角形</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript之箭头函数]]></title>
      <url>/2017/06/01/arrow-function/</url>
      <content type="html"><![CDATA[<pre><code>x =&gt; x * x
</code></pre><p>上面的箭头函数相当于：</p>
<pre><code>function (x) {
    return x * x;
}
</code></pre><p>在继续学习箭头函数之前，请测试你的浏览器是否支持ES6的Arrow Function：</p>
<p>箭头函数相当于匿名函数，并且简化了函数定义。箭头函数有两种格式，一种像上面的，只包含一个表达式，连{ … }和return都省略掉了。还有一种可以包含多条语句，这时候就不能省略{ … }和return：</p>
<pre><code>x =&gt; {
    if (x &gt; 0) {
        return x * x;
    }
    else {
        return - x * x;
    }
}
</code></pre><p>如果参数不是一个，就需要用括号()括起来：</p>
<pre><code>// 两个参数:
(x, y) =&gt; x * x + y * y
// 无参数:
() =&gt; 3.14
// 可变参数:
(x, y, ...rest) =&gt; {
    var i, sum = x + y;
    for (i=0; i&lt;rest.length; i++) {
        sum += rest[i];
    }
    return sum;
}
</code></pre><p>如果要返回一个对象，就要注意，如果是单表达式，这么写的话会报错：</p>
<pre><code>// SyntaxError:
x =&gt; { foo: x }
</code></pre><p>因为和函数体的{ … }有语法冲突，所以要改为：</p>
<pre><code>// ok:
x =&gt; ({ foo: x })
等同于
var thissrr=  test(&quot;nihao&quot;);
function test (x) {
      return {foo: x};
}
console.log(thissrr);
</code></pre><h3 id="this"><a href="#this" class="headerlink" title="this"></a>this</h3><p>箭头函数看上去是匿名函数的一种简写，但实际上，箭头函数和匿名函数有个明显的区别：箭头函数内部的this是词法作用域，由上下文确定。<br>回顾前面的例子，由于JavaScript函数对this绑定的错误处理，下面的例子无法得到预期结果：</p>
<pre><code>var obj = {
    birth: 1990,
    getAge: function () {
        var b = this.birth; // 1990
        var fn = function () {
            return new Date().getFullYear() - this.birth; // this指向window或undefined
        };
        return fn();
    }
};
obj.getAge();
  console.log(obj);
  console.log(obj.getAge());
结果：
//Object { birth: 1990, getAge: getAge() }  index3.html:76:2
//NaN
</code></pre><p>现在，箭头函数完全修复了this的指向，this总是指向词法作用域，也就是外层调用者obj：</p>
<pre><code>var obj = {
    birth: 1990,
    getAge: function () {
        var b = this.birth; // 1990
        var fn = () =&gt; new Date().getFullYear() - this.birth; // this指向obj对象
        return fn();
    }
};
obj.getAge(); // 27
console.log(obj);
console.log(obj.getAge());
结果：
//Object { birth: 1990, getAge: getAge() }  index3.html:76:2
//27
</code></pre><p>如果使用箭头函数，以前的那种hack写法：</p>
<p>  var that = this;</p>
<p>就不再需要了。</p>
<p>由于this在箭头函数中已经按照词法作用域绑定了，所以，用call()或者apply()调用箭头函数时，无法对this进行绑定，即传入的第一个参数被忽略：</p>
<pre><code>var obj = {
    birth: 1990,
    getAge: function (year) {
        var b = this.birth; // 1990
        var fn = (y) =&gt; y - this.birth; // this.birth仍是1990
        return fn.call({birth:2000}, year);
    }
};
obj.getAge(2015); // 27
</code></pre><blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/06/01/javascript-sort" target="_blank" rel="external">javascript之sort()</a>.<br>  下一篇：<a href="http://localhost:4000/2017/06/01/generator" target="_blank" rel="external">javascript之generator</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[javascript之sort()]]></title>
      <url>/2017/06/01/javascript-sort/</url>
      <content type="html"><![CDATA[<h3 id="我们将创建一个数组，并按字母顺序进行排序："><a href="#我们将创建一个数组，并按字母顺序进行排序：" class="headerlink" title="我们将创建一个数组，并按字母顺序进行排序："></a>我们将创建一个数组，并按字母顺序进行排序：</h3><pre><code>var arr=[5,100,6,3,-12];
var result=arr.sort();
    console.log(result);//[ -12, 100, 3, 5, 6]
</code></pre><blockquote>
<p>请注意，上面的代码没有按照数值的大小对数字进行排序，要实现这一点，就必须使用一个排序函数：</p>
</blockquote>
<pre><code>var result = arr.sort(function(a,b) {
          return a-b;
      });
    console.log(result);//[-12,3,5,6,100]
</code></pre><h3 id="for循环进行排序模拟冒泡排序"><a href="#for循环进行排序模拟冒泡排序" class="headerlink" title="for循环进行排序模拟冒泡排序"></a>for循环进行排序模拟冒泡排序</h3><pre><code>var arr=[5,100,6,3,-12];
    for(var x=0; x&lt;arr.length-1; x++){
         for (var i=0; i&lt;arr.length; i++) {
                 var temp;
                 if(arr[i]&gt;arr[i+1]){
                     temp=arr[i];
                    arr[i]=arr[i+1]
                     arr[i+1]=temp;
                 }
         }
         console.log(arr);
     }
</code></pre><h3 id="另一种sort-正序排序"><a href="#另一种sort-正序排序" class="headerlink" title="另一种sort()正序排序"></a>另一种sort()正序排序</h3><pre><code>var arr2 = [10, 20, 1, 2];
var result2=arr2.sort(function (x, y) {
            if (x &lt; y) {
                return -1;
            }
            if (x &gt; y) {
                return 1;
            }
            return 0;
        });
    console.log(result2);//[1,2,10,20]
</code></pre><h3 id="sort-倒序排序"><a href="#sort-倒序排序" class="headerlink" title="sort()倒序排序"></a>sort()倒序排序</h3><pre><code>var result2=arr2.sort(function (x, y) {
            if (x &lt; y) {
                return 1;
            }
            if (x &gt; y) {
                return -1;
            }
            return 0;
        });
    console.log(result2);//[20,10,2,1]
</code></pre><p>默认情况下，对字符串排序，是按照ASCII的大小比较的，现在，我们提出排序应该忽略大小写，按照字母序排序。要实现这个算法，不必对现有代码大加改动，只要我们能定义出忽略大小写的比较算法就可以：</p>
<pre><code>var arr = [&apos;Google&apos;, &apos;apple&apos;, &apos;Microsoft&apos;];
arr.sort(function (s1, s2) {
    x1 = s1.toUpperCase();
    x2 = s2.toUpperCase();
    if (x1 &lt; x2) {
        return -1;
    }
    if (x1 &gt; x2) {
        return 1;
    }
    return 0;
}); // [&apos;apple&apos;, &apos;Google&apos;, &apos;Microsoft&apos;]
</code></pre><p>忽略大小写来比较两个字符串，实际上就是先把字符串都变成大写（或者都变成小写），再比较。<br>从上述例子可以看出，高阶函数的抽象能力是非常强大的，而且，核心代码可以保持得非常简洁。<br>最后友情提示，sort()方法会直接对Array进行修改，它返回的结果仍是当前Array：</p>
<pre><code>var a1 = [&apos;B&apos;, &apos;A&apos;, &apos;C&apos;];
var a2 = a1.sort();
a1; // [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]
a2; // [&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]
a1 === a2; // true, a1和a2是同一对象
</code></pre><blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/05/18/AngularJS6" target="_blank" rel="external">AngularJS之英雄联盟HTTP</a>.<br>  下一篇：<a href="http://localhost:4000/2017/06/01/arrow-function" target="_blank" rel="external">javascript之箭头函数</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AngularJS之英雄联盟HTTP]]></title>
      <url>/2017/05/18/AngularJS6/</url>
      <content type="html"><![CDATA[<p>在<a href="http://localhost:4000/2017/05/18/AngularJS5" target="_blank" rel="external">前一章</a>中，我们学会了在仪表盘和固定的英雄列表之间导航，并编辑选定的英雄。这也就是本章的起点。</p>
<h3 id="提供-HTTP-服务"><a href="#提供-HTTP-服务" class="headerlink" title="提供 HTTP 服务"></a>提供 HTTP 服务</h3><p>HttpModule并不是 Angular 的核心模块。 它是 Angular 用来进行 Web 访问的一种可选方式，并位于一个名叫 @angular/http 的独立附属模块中，并作为 Angular 的 npm 包之一而发布出来。</p>
<p>systemjs.config中已经配置好了 SystemJS，并在必要时加载它，因此我们已经准备好从@angular/http中导入它了。</p>
<h3 id="注册-HTTP-服务"><a href="#注册-HTTP-服务" class="headerlink" title="注册 HTTP 服务"></a>注册 HTTP 服务</h3><p>我们的应用将会依赖于 Angular 的http服务，它本身又依赖于其它支持类服务。 来自@angular/http库中的HttpModule保存着这些 HTTP 相关服务提供商的全集。</p>
<p>我们要能从本应用的任何地方访问这些服务，就要把HttpModule添加到AppModule的imports列表中。 这里同时也是我们引导应用及其根组件AppComponent的地方。</p>
<blockquote>
<p>注意，现在HttpModule已经是根模块AppModule的imports数组的一部分了。</p>
</blockquote>
<h3 id="模拟web-API"><a href="#模拟web-API" class="headerlink" title="模拟web API"></a>模拟web API</h3><p>我们建议在根模块AppModule的providers数组中注册全应用级的服务。</p>
<p>在拥有一个能处理Web请求的服务器之前，我们可以先用HTTP客户端通过一个模拟（Mock）服务（内存Web API）来获取和保存数据。</p>
<p>修改src/app/app.module.ts，让它使用这个模拟服务：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NgModule &#125;      <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</div><div class="line"><span class="keyword">import</span> &#123; FormsModule &#125;   <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</div><div class="line"><span class="keyword">import</span> &#123; HttpModule &#125;    <span class="keyword">from</span> <span class="string">'@angular/http'</span>;</div><div class="line"><span class="keyword">import</span> &#123; AppRoutingModule &#125; <span class="keyword">from</span> <span class="string">'./app-routing.module'</span>;</div><div class="line"><span class="comment">// Imports for loading &amp; configuring the in-memory web api</span></div><div class="line"><span class="keyword">import</span> &#123; InMemoryWebApiModule &#125; <span class="keyword">from</span> <span class="string">'angular-in-memory-web-api'</span>;</div><div class="line"><span class="keyword">import</span> &#123; InMemoryDataService &#125;  <span class="keyword">from</span> <span class="string">'./in-memory-data.service'</span>;</div><div class="line"><span class="keyword">import</span> &#123; AppComponent &#125;         <span class="keyword">from</span> <span class="string">'./app.component'</span>;</div><div class="line"><span class="keyword">import</span> &#123; DashboardComponent &#125;   <span class="keyword">from</span> <span class="string">'./dashboard.component'</span>;</div><div class="line"><span class="keyword">import</span> &#123; HeroesComponent &#125;      <span class="keyword">from</span> <span class="string">'./heroes.component'</span>;</div><div class="line"><span class="keyword">import</span> &#123; HeroDetailComponent &#125;  <span class="keyword">from</span> <span class="string">'./hero-detail.component'</span>;</div><div class="line"><span class="keyword">import</span> &#123; HeroService &#125;          <span class="keyword">from</span> <span class="string">'./hero.service'</span>;</div><div class="line">@NgModule(&#123;</div><div class="line">  <span class="attr">imports</span>: [</div><div class="line">    BrowserModule,</div><div class="line">    FormsModule,</div><div class="line">    HttpModule,</div><div class="line">    InMemoryWebApiModule.forRoot(InMemoryDataService),</div><div class="line">    AppRoutingModule</div><div class="line">  ],</div><div class="line">  <span class="attr">declarations</span>: [</div><div class="line">    AppComponent,</div><div class="line">    DashboardComponent,</div><div class="line">    HeroDetailComponent,</div><div class="line">    HeroesComponent,</div><div class="line">  ],</div><div class="line">  <span class="attr">providers</span>: [ HeroService ],</div><div class="line">  <span class="attr">bootstrap</span>: [ AppComponent ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<p>导入InMemoryWebApiModule并将其加入到模块的imports数组。 InMemoryWebApiModule将Http客户端默认的后端服务 — 这是一个辅助服务，负责与远程服务器对话 — 替换成了内存 Web API服务：</p>
<pre><code>InMemoryWebApiModule.forRoot(InMemoryDataService),
</code></pre><p>forRoot()配置方法需要InMemoryDataService类实例，用来向内存数据库填充数据： 往app目录下新增一个文件in-memory-data.service.ts，填写下列内容：</p>
<pre><code>import { InMemoryDbService } from &apos;angular-in-memory-web-api&apos;;
export class InMemoryDataService implements InMemoryDbService {
  createDb() {
    let heroes = [
      {id: 11, name: &apos;Mr. Nice&apos;},
      {id: 12, name: &apos;Narco&apos;},
      {id: 13, name: &apos;Bombasto&apos;},
      {id: 14, name: &apos;Celeritas&apos;},
      {id: 15, name: &apos;Magneta&apos;},
      {id: 16, name: &apos;RubberMan&apos;},
      {id: 17, name: &apos;Dynama&apos;},
      {id: 18, name: &apos;Dr IQ&apos;},
      {id: 19, name: &apos;Magma&apos;},
      {id: 20, name: &apos;Tornado&apos;}
    ];
    return {heroes};
  }
}
</code></pre><p>这个文件已经替换了mock-heroes.ts，可以删除mock-heroes.ts了。</p>
<h3 id="英雄与-HTTP"><a href="#英雄与-HTTP" class="headerlink" title="英雄与 HTTP"></a>英雄与 HTTP</h3><p>在目前的HeroService的实现中，返回的是一个能解析（resolve）成模拟英雄列表的承诺（Promise）。</p>
<pre><code>getHeroes(): Promise&lt;Hero[]&gt; {
  return Promise.resolve(HEROES);
}
</code></pre><p>我们返回一个承诺 (Promise)，它用模拟版的英雄列表进行解析。 它当时可能看起来显得有点过于复杂，不过我们预料到总有这么一天会通过 HTTP 客户端来获取英雄数据， 而且我们知道，那一定是一个异步操作。</p>
<p>现在，我们把getHeroes()换成使用 HTTP。</p>
<pre><code>private heroesUrl = &apos;api/heroes&apos;;  // URL to web api
constructor(private http: Http) { }
getHeroes(): Promise&lt;Hero[]&gt; {
  return this.http.get(this.heroesUrl)
             .toPromise()
             .then(response =&gt; response.json().data as Hero[])
             .catch(this.handleError);
}
private handleError(error: any): Promise&lt;any&gt; {
  console.error(&apos;An error occurred&apos;, error); // for demo purposes only
  return Promise.reject(error.message || error);
}
</code></pre><p>更新后的导入声明如下：</p>
<pre><code>import { Injectable }    from &apos;@angular/core&apos;;
import { Headers, Http } from &apos;@angular/http&apos;;
import &apos;rxjs/add/operator/toPromise&apos;;
import { Hero } from &apos;./hero&apos;;
</code></pre><p>刷新浏览器后，英雄数据就会从模拟服务器被成功读取。</p>
<h3 id="HTTP-Promise"><a href="#HTTP-Promise" class="headerlink" title="HTTP Promise"></a>HTTP Promise</h3><p>Angular 的http.get返回一个 RxJS 的Observable对象。 Observable（可观察对象）是一个管理异步数据流的强力方式。 后面我们还会进一步学习可观察对象。</p>
<p>现在，我们先利用toPromise操作符把Observable直接转换成Promise对象，回到已经熟悉的地盘。</p>
<pre><code>.toPromise()
</code></pre><p>不幸的是，Angular 的Observable并没有一个toPromise操作符… 没有打包在一起发布。Angular的Observable只是一个骨架实现。</p>
<p>有很多像toPromise这样的操作符，用于扩展Observable，为其添加有用的能力。 如果我们希望得到那些能力，就得自己添加那些操作符。 那很容易，只要从 RxJS 库中导入它们就可以了，就像这样：    </p>
<pre><code>import &apos;rxjs/add/operator/toPromise&apos;;
</code></pre><blockquote>
<p>我们还要添加更多的操作符，并且必须这么做，要了解其中的原因，参见本章稍后的部分。</p>
</blockquote>
<h3 id="在-then-回调中提取出数据"><a href="#在-then-回调中提取出数据" class="headerlink" title="在 then 回调中提取出数据"></a>在 then 回调中提取出数据</h3><p>在 promise 的then()回调中，我们调用 HTTP 的Reponse对象的json方法，以提取出其中的数据。</p>
<pre><code>.then(response =&gt; response.json().data as Hero[])
</code></pre><p>这个由json方法返回的对象只有一个data属性。 这个data属性保存了英雄数组，这个数组才是调用者真正想要的。 所以我们取得这个数组，并且把它作为承诺的值进行解析。</p>
<blockquote>
<p>仔细看看这个由服务器返回的数据的形态。 这个内存 Web API 的范例中所做的是返回一个带有data属性的对象。 你的 API 也可以返回其它东西。请调整这些代码以匹配你的 Web API。</p>
</blockquote>
<p>调用者并不知道这些实现机制，它仍然像以前那样接收一个包含英雄数据的承诺。 它也不知道我们已经改成了从服务器获取英雄数据。 它也不必了解把 HTTP 响应转换成英雄数据时所作的这些复杂变换。 看到美妙之处了吧，这正是将数据访问委托组一个服务的目的。</p>
<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>在getHeroes()的最后，我们catch了服务器的失败信息，并把它们传给了错误处理器：</p>
<pre><code>.catch(this.handleError);
</code></pre><p>这是一个关键的步骤！ 我们必须预料到 HTTP 请求会失败，因为有太多我们无法控制的原因可能导致它们频繁出现各种错误。</p>
<pre><code>private handleError(error: any): Promise&lt;any&gt; {
  console.error(&apos;An error occurred&apos;, error); // for demo purposes only
  return Promise.reject(error.message || error);
}
</code></pre><p>在这个范例服务中，我们把错误记录到控制台中；在真实世界中，我们应该用代码对错误进行处理。但对于演示来说，这就够了。</p>
<p>我们还要通过一个被拒绝 (rejected) 的承诺来把该错误用一个用户友好的格式返回给调用者， 以便调用者能把一个合适的错误信息显示给用户。</p>
<h3 id="通过id获取英雄"><a href="#通过id获取英雄" class="headerlink" title="通过id获取英雄"></a>通过id获取英雄</h3><p>当HeroDetailComponent向HeroService请求获取一个英雄时，HeroService会获取所有英雄，并从中过滤出与id匹配的那一个。 这对于例子来说倒是无可厚非， 不过在真实服务中，这种为了获取一个英雄而请求全部英雄的做法就有点浪费了， 许多Web API支持get-by-id请求，形如：api/hero/:id（如：api/hero/11）。</p>
<p>修改 HeroService.getHero() 方法来发起一个 get-by-id 请求：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">getHero(id: number): Promise&lt;Hero&gt; &#123;</div><div class="line">  const url = `$&#123;this.heroesUrl&#125;/$&#123;id&#125;`;</div><div class="line">  return this.http.get(url)</div><div class="line">    .toPromise()</div><div class="line">    .then(response =&gt; response.json().data as Hero)</div><div class="line">    .catch(this.handleError);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>此方法基本上与getHeroes方法一致，通过在URL中添加英雄的id来告诉服务器应该获取那个英雄， 匹配api/hero/:id模式。</p>
<p>我们还要把响应中返回的data改为一个英雄对象，而不再是对象数组。组。</p>
<p>getHeroes API 没变</p>
<p>尽管我们在getHeroes()和getHero()方法的内部做了重大修改， 但是他们的公共签名却没有变。这两个方法仍然返回的是一个Promise对象， 所以并不需要修改任何调用他们的组件。</p>
<p>现在，我们该支持创建和删除英雄了。</p>
<h3 id="更新英雄详情"><a href="#更新英雄详情" class="headerlink" title="更新英雄详情"></a>更新英雄详情</h3><p>我们已经可以在英雄详情中编辑英雄的名字了。来试试吧。在输入的时候，页头上的英雄名字也会随之更新。 不过当我们点了Back（后退）按钮时，这些修改就丢失了。</p>
<p>以前是不会丢失更新的，怎么回事？ 当该应用使用模拟出来的英雄列表时，修改的是一份全局共享的英雄列表，而现在改成了从服务器获取数据。 如果我们希望这些更改被持久化，我们就得把它们写回服务器。</p>
<p>保存英雄详情<br>我们先来确保对英雄名字的编辑不会丢失。先在英雄详情模板的底部添加一个保存按钮，它绑定了一个click事件，事件绑定会调用组件中一个名叫save()的新方法：<br>src/app/hero-detail.component.html (save)</p>
<pre><code>&lt;button (click)=&quot;save()&quot;&gt;Save&lt;/button&gt;
</code></pre><p>save()方法使用 hero 服务的update()方法来持久化对英雄名字的修改，然后导航回前一个视图：<br>src/app/hero-detail.component.html (save)</p>
<pre><code>save(): void {
  this.heroService.update(this.hero)
    .then(() =&gt; this.goBack());
}
</code></pre><h3 id="hero-服务的update方法"><a href="#hero-服务的update方法" class="headerlink" title="hero 服务的update方法"></a>hero 服务的update方法</h3><p>update()方法的大致结构与getHeroes()类似，不过我们使用 HTTP 的 put() 方法来把修改持久化到服务端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">private headers = new Headers(&#123;&apos;Content-Type&apos;: &apos;application/json&apos;&#125;);</div><div class="line">update(hero: Hero): Promise&lt;Hero&gt; &#123;</div><div class="line">  const url = `$&#123;this.heroesUrl&#125;/$&#123;hero.id&#125;`;</div><div class="line">  return this.http</div><div class="line">    .put(url, JSON.stringify(hero), &#123;headers: this.headers&#125;)</div><div class="line">    .toPromise()</div><div class="line">    .then(() =&gt; hero)</div><div class="line">    .catch(this.handleError);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们通过一个编码在 URL 中的英雄 id 来告诉服务器应该更新哪个英雄。put 的 body 是该英雄的 JSON 字符串，它是通过调用JSON.stringify得到的。 并且在请求头中标记出的 body 的内容类型（application/json）。</p>
<p>刷新浏览器试一下，对英雄名字的修改确实已经被持久化了。</p>
<h3 id="添加英雄"><a href="#添加英雄" class="headerlink" title="添加英雄"></a>添加英雄</h3><p>要添加一个新的英雄，我们得先知道英雄的名字。我们使用一个 input 元素和一个添加按钮来实现。</p>
<p>把下列代码插入 heroes 组件的 HTML 中，放在标题的下面：</p>
<pre><code>&lt;div&gt;
  &lt;label&gt;Hero name:&lt;/label&gt; &lt;input #heroName /&gt;
  &lt;button (click)=&quot;add(heroName.value); heroName.value=&apos;&apos;&quot;&gt;
    Add
  &lt;/button&gt;
&lt;/div&gt;
</code></pre><p>当点击事件触发时，我们调用组件的点击处理器，然后清空这个输入框，以便用来输入另一个名字。<br>src/app/heroes.component.ts (add)</p>
<pre><code>add(name: string): void {
  name = name.trim();
  if (!name) { return; }
  this.heroService.create(name)
  .then(hero =&gt; {
    this.heroes.push(hero);
    this.selectedHero = null;
  });
}
</code></pre><p>当指定的名字不为空的时候，点击处理器就会委托 hero 服务来创建一个具有此名字的英雄， 并把这个新的英雄添加到我们的数组中。</p>
<p>然后，我们在HeroService类中实现这个create()方法。<br>src/app/hero.service.ts (create)</p>
<pre><code>create(name: string): Promise&lt;Hero&gt; {
  return this.http
    .post(this.heroesUrl, JSON.stringify({name: name}), {headers: this.headers})
    .toPromise()
    .then(res =&gt; res.json().data as Hero)
    .catch(this.handleError);
}
</code></pre><p>刷新浏览器，并创建一些新的英雄！</p>
<h3 id="支持添加英雄"><a href="#支持添加英雄" class="headerlink" title="支持添加英雄"></a>支持添加英雄</h3><p>在英雄列表视图中的每个英雄都应该有一个删除按钮。</p>
<p>把这个按钮元素添加到英雄列表组件的 HTML 中，把它放在<li>标签中的英雄名的后面：</li></p>
<pre><code>&lt;button class=&quot;delete&quot;
  (click)=&quot;delete(hero); $event.stopPropagation()&quot;&gt;x&lt;/button&gt;
</code></pre><p>li元素应该变成了这样：</p>
<pre><code>&lt;li * ngFor=&quot;let hero of heroes&quot; (click)=&quot;onSelect(hero)&quot;
    [class.selected]=&quot;hero === selectedHero&quot;&gt;
  &lt;span class=&quot;badge&quot;&gt;{{hero.id}}&lt;/span&gt;
  &lt;span&gt;{{hero.name}}&lt;/span&gt;
  &lt;button class=&quot;delete&quot;
    (click)=&quot;delete(hero); $event.stopPropagation()&quot;&gt;x&lt;/button&gt;
&lt;/li&gt;
</code></pre><p>除了调用组件的delete()方法之外，这个删除按钮的点击处理器还应该阻止点击事件向上冒泡 — 我们并不希望触发<li>的事件处理器，否则它会选中我们要删除的这位英雄。</li></p>
<p>delete()处理器的逻辑略复杂：</p>
<pre><code>delete(hero: Hero): void {
  this.heroService
      .delete(hero.id)
      .then(() =&gt; {
        this.heroes = this.heroes.filter(h =&gt; h !== hero);
        if (this.selectedHero === hero) { this.selectedHero = null; }
      });
}
</code></pre><p>当然，我们仍然把删除英雄的操作委托给了 hero 服务， 不过该组件仍然负责更新显示：它从数组中移除了被删除的英雄，如果删除的是正选中的英雄，还会清空选择。</p>
<p>我们希望删除按钮被放在英雄条目的最右边。 于是 CSS 变成了这样：<br>src/app/heroes.component.css (additions)</p>
<pre><code>button.delete {
  float:right;
  margin-top: 2px;
  margin-right: .8em;
  background-color: gray !important;
  color:white;
}
</code></pre><p>hero 服务的delete()方法</p>
<p>hero 服务的delete()方法使用 HTTP 的 delete() 方法来从服务器上移除该英雄：</p>
<pre><code>delete(id: number): Promise&lt;void&gt; {
  const url = `${this.heroesUrl}/${id}`;
  return this.http.delete(url, {headers: this.headers})
    .toPromise()
    .then(() =&gt; null)
    .catch(this.handleError);
}
</code></pre><p>可观察对象 (Observable)</p>
<p>Http服务中的每个方法都返回一个 HTTP Response对象的Observable实例。</p>
<p>我们的HeroService中把那个Observable对象转换成了Promise（承诺），并把这个承诺返回给了调用者。 这一节，我们将学会直接返回Observable，并且讨论何时以及为何那样做会更好。</p>
<p>背景</p>
<p>一个可观察对象是一个事件流，我们可以用数组型操作符来处理它。</p>
<p>Angular 内核中提供了对可观察对象的基本支持。而我们这些开发人员可以自己从 RxJS 库中引入操作符和扩展。 我们会简短的讲解下如何做。</p>
<p>快速回忆一下HeroService，它在http.get()返回的Observable后面串联了一个toPromise操作符。 该操作符把Observable转换成了Promise，并且我们把那个承诺返回给了调用者。</p>
<p>转换成承诺通常是更好地选择，我们通常会要求http.get()获取单块数据。只要接收到数据，就算完成。 使用承诺这种形式的结果是让调用方更容易写，并且承诺已经在 JavaScript 程序员中被广泛接受了。</p>
<p>但是请求并非总是“一次性”的。我们可以开始一个请求， 并且取消它，在服务器对第一个请求作出回应之前，再开始另一个不同的请求 。 像这样一个请求-取消-新请求的序列用承诺是很难实现的，但接下来我们会看到，它对于可观察对象却很简单。</p>
<p>请求-取消-新请求的序列对于Promise来说是很难实现的，但是对Observable来说则很容易。</p>
<p>支持按名搜索</p>
<p>我们要为《英雄指南》添加一个英雄搜索特性。 当用户在搜索框中输入一个名字时，我们将不断发起 HTTP 请求，以获得按名字过滤的英雄。</p>
<p>我们先创建HeroSearchService服务，它会把搜索请求发送到我们服务器上的 Web API。<br>src/app/hero-search.service.ts</p>
<pre><code>import { Injectable } from &apos;@angular/core&apos;;
import { Http }       from &apos;@angular/http&apos;;
import { Observable }     from &apos;rxjs/Observable&apos;;
import &apos;rxjs/add/operator/map&apos;;
import { Hero }           from &apos;./hero&apos;;
@Injectable()
export class HeroSearchService {
  constructor(private http: Http) {}
  search(term: string): Observable&lt;Hero[]&gt; {
    return this.http
               .get(`app/heroes/?name=${term}`)
               .map(response =&gt; response.json().data as Hero[]);
  }
}
</code></pre><p>HeroSearchService中的http.get()调用和HeroService中的很相似，只是这次带了查询字符串。</p>
<p>更重要的是：我们不再调用toPromise方法，而是从http.get 方法中返回一个Observable对象，之后调用RxJS的map操作符 来从返回数据中提取英雄。</p>
<p>链式RxJS操作可以让我们简单、易读的处理响应数据。详见下面关于操作符的讨论</p>
<h3 id="HeroSearchComponent"><a href="#HeroSearchComponent" class="headerlink" title="HeroSearchComponent"></a>HeroSearchComponent</h3><p>我们再创建一个新的HeroSearchComponent来调用这个新的HeroSearchService。</p>
<p>组件模板很简单，就是一个输入框和一个显示匹配的搜索结果的列表。<br>src/app/hero-search.component.html</p>
<pre><code>&lt;div id=&quot;search-component&quot;&gt;
  &lt;h4&gt;Hero Search&lt;/h4&gt;
  &lt;input #searchBox id=&quot;search-box&quot; (keyup)=&quot;search(searchBox.value)&quot; /&gt;
  &lt;div&gt;
    &lt;div * ngFor=&quot;let hero of heroes | async&quot;
         (click)=&quot;gotoDetail(hero)&quot; class=&quot;search-result&quot; &gt;
      {{hero.name}}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre><p>我们还要往这个新组件中添加样式。<br>src/app/hero-search.component.css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">.search-result&#123;</div><div class="line">  border-bottom: 1px solid gray;</div><div class="line">  border-left: 1px solid gray;</div><div class="line">  border-right: 1px solid gray;</div><div class="line">  width:195px;</div><div class="line">  height: 16px;</div><div class="line">  padding: 5px;</div><div class="line">  background-color: white;</div><div class="line">  cursor: pointer;</div><div class="line">&#125;</div><div class="line">.search-result:hover &#123;</div><div class="line">  color: #eee;</div><div class="line">  background-color: #607D8B;</div><div class="line">&#125;</div><div class="line">#search-box&#123;</div><div class="line">  width: 200px;</div><div class="line">  height: 20px;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当用户在搜索框中输入时，一个 keyup 事件绑定会调用该组件的search()方法，并传入新的搜索框的值。</p>
<p>不出所料，* ngFor从该组件的heroes属性重复获取 hero 对象。这也没啥特别的。</p>
<p>但是，接下来我们看到heroes属性现在是英雄列表的Observable对象，而不再只是英雄数组。 <em> ngFor不能用可观察对象做任何事，除非我们在它后面跟一个async pipe (AsyncPipe)。 这个async管道会订阅到这个可观察对象，并且为</em>ngFor生成一个英雄数组。</p>
<p>该创建HeroSearchComponent类及其元数据了。<br>src/app/hero-search.component.ts</p>
<pre><code>import { Component, OnInit } from &apos;@angular/core&apos;;
import { Router }            from &apos;@angular/router&apos;;
import { Observable }        from &apos;rxjs/Observable&apos;;
import { Subject }           from &apos;rxjs/Subject&apos;;
// Observable class extensions
import &apos;rxjs/add/observable/of&apos;;
// Observable operators
import &apos;rxjs/add/operator/catch&apos;;
import &apos;rxjs/add/operator/debounceTime&apos;;
import &apos;rxjs/add/operator/distinctUntilChanged&apos;;
import { HeroSearchService } from &apos;./hero-search.service&apos;;
import { Hero } from &apos;./hero&apos;;
@Component({
  selector: &apos;hero-search&apos;,
  templateUrl: &apos;./hero-search.component.html&apos;,
  styleUrls: [ &apos;./hero-search.component.css&apos; ],
  providers: [HeroSearchService]
})
export class HeroSearchComponent implements OnInit {
  heroes: Observable&lt;Hero[]&gt;;
  private searchTerms = new Subject&lt;string&gt;();
  constructor(
    private heroSearchService: HeroSearchService,
    private router: Router) {}
  // Push a search term into the observable stream.
  search(term: string): void {
    this.searchTerms.next(term);
  }
  ngOnInit(): void {
    this.heroes = this.searchTerms
      .debounceTime(300)        // wait 300ms after each keystroke before considering the term
      .distinctUntilChanged()   // ignore if next search term is same as previous
      .switchMap(term =&gt; term   // switch to new observable each time the term changes
        // return the http search observable
        ? this.heroSearchService.search(term)
        // or the observable of empty heroes if there was no search term
        : Observable.of&lt;Hero[]&gt;([]))
      .catch(error =&gt; {
        // TODO: add real error handling
        console.log(error);
        return Observable.of&lt;Hero[]&gt;([]);
      });
  }
  gotoDetail(hero: Hero): void {
    let link = [&apos;/detail&apos;, hero.id];
    this.router.navigate(link);
  }
}
</code></pre><p>搜索词</p>
<p>仔细看下这个searchTerms：</p>
<pre><code>private searchTerms = new Subject&lt;string&gt;();
// Push a search term into the observable stream.
search(term: string): void {
  this.searchTerms.next(term);
}
</code></pre><p>Subject（主题）是一个可观察的事件流中的生产者。 searchTerms生成一个产生字符串的Observable，用作按名称搜索时的过滤条件。Each call to search() puts a new string into this subject’s observable stream by calling next().</p>
<p>每当调用search()时都会调用next()来把新的字符串放进该主题的可观察流中。</p>
<p>初始化 heroes 属性(ngOnInit)</p>
<p>Subject也是一个Observable对象。 我们要把搜索词的流转换成Hero数组的流，并把结果赋值给heroes属性。</p>
<pre><code>heroes: Observable&lt;Hero[]&gt;;
ngOnInit(): void {
  this.heroes = this.searchTerms
    .debounceTime(300)        // wait 300ms after each keystroke before considering the term
    .distinctUntilChanged()   // ignore if next search term is same as previous
    .switchMap(term =&gt; term   // switch to new observable each time the term changes
      // return the http search observable
      ? this.heroSearchService.search(term)
      // or the observable of empty heroes if there was no search term
      : Observable.of&lt;Hero[]&gt;([]))
    .catch(error =&gt; {
      // TODO: add real error handling
      console.log(error);
      return Observable.of&lt;Hero[]&gt;([]);
    });
}
</code></pre><p>如果我们直接把每一次用户按键都直接传给HeroSearchService，就会发起一场 HTTP 请求风暴。 这可不好玩。我们不希望占用服务器资源，也不想耗光蜂窝移动网络的流量。</p>
<p>不过，我们可以在字符串的Observable后面串联一些Observable操作符，来归并这些请求。 我们将对HeroSearchService发起更少的调用，并且仍然获得足够及时的响应。做法如下：</p>
<ul>
<li><p>在传出最终字符串之前，debounceTime(300)将会等待，直到新增字符串的事件暂停了 300 毫秒。 我们实际发起请求的间隔永远不会小于 300ms。</p>
</li>
<li><p>distinctUntilChanged确保只在过滤条件变化时才发送请求， 这样就不会重复请求同一个搜索词了。</p>
</li>
<li><p>switchMap()会为每个从debounce和distinctUntilChanged中通过的搜索词调用搜索服务。 它会取消并丢弃以前的搜索可观察对象，只保留最近的。</p>
</li>
<li><p>catch拦截失败的可观察对象。这个简单的例子中只是把错误信息打印到控制台（但实际的应用需要做更多事），然后返回一个包含空数组的可观察对象，以清空搜索结果。</p>
</li>
</ul>
<h3 id="导入-RxJS-操作符"><a href="#导入-RxJS-操作符" class="headerlink" title="导入 RxJS 操作符"></a>导入 RxJS 操作符</h3><p>大部分RxJS操作符都不包括在Angular的Observable基本实现中，基本实现只包括Angular本身所需的功能。</p>
<p>如果想要更多的RxJS功能，我们必须导入其所定义的库来扩展Observable对象， 以下是这个模块所需导入的所有RxJS操作符：<br>src/app/hero-search.component.ts (rxjs imports)</p>
<p>import { Observable }        from ‘rxjs/Observable’;<br>import { Subject }           from ‘rxjs/Subject’;</p>
<p>// Observable class extensions<br>import ‘rxjs/add/observable/of’;</p>
<p>// Observable operators<br>import ‘rxjs/add/operator/catch’;<br>import ‘rxjs/add/operator/debounceTime’;<br>import ‘rxjs/add/operator/distinctUntilChanged’;</p>
<p>你可能并不熟悉这种import ‘rxjs/add/…’语法，它缺少了花括号中的导入列表：{…}。</p>
<p>这是因为我们并不需要操作符本身，这种情况下，我们所做的其实是导入这个库，加载并运行其中的脚本， 它会把操作符添加到Observable类中。</p>
<p>为仪表盘添加搜索组件</p>
<p>将表示“英雄搜索”组件的 HTML 元素添加到DashboardComponent模版的最后面。</p>
<pre><code>&lt;h3&gt;Top Heroes&lt;/h3&gt;
&lt;div class=&quot;grid grid-pad&quot;&gt;
  &lt;a * ngFor=&quot;let hero of heroes&quot;  [routerLink]=&quot;[&apos;/detail&apos;, hero.id]&quot;  class=&quot;col-1-4&quot;&gt;
    &lt;div class=&quot;module hero&quot;&gt;
      &lt;h4&gt;{{hero.name}}&lt;/h4&gt;
    &lt;/div&gt;
  &lt;/a&gt;
&lt;/div&gt;
&lt;hero-search&gt;&lt;/hero-search&gt;
</code></pre><p>最后，从hero-search.component.ts中导入HeroSearchComponent并将其添加到declarations数组中。<br>src/app/app.module.ts (search)</p>
<pre><code>declarations: [
  AppComponent,
  DashboardComponent,
  HeroDetailComponent,
  HeroesComponent,
  HeroSearchComponent
],
</code></pre><p>再次运行该应用，跳转到仪表盘，并在英雄下方的搜索框里输入一些文本。 运行效果如下：<br><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170523-0@2x.png" alt=""></p>
<blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/05/18/AngularJS5" target="_blank" rel="external">AngularJS之英雄联盟路由</a>.<br>  下一篇：<a href="http://localhost:4000/2017/06/01/javascript-sort" target="_blank" rel="external">javascript之sort()</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AngularJS之英雄联盟路由]]></title>
      <url>/2017/05/18/AngularJS5/</url>
      <content type="html"><![CDATA[<h3 id="添加-Angular-组件路由，并且学习在视图之间导航"><a href="#添加-Angular-组件路由，并且学习在视图之间导航" class="headerlink" title="添加 Angular 组件路由，并且学习在视图之间导航"></a>添加 Angular 组件路由，并且学习在视图之间导航</h3><p>我们收到了《英雄指南》的一些新需求：</p>
<ol>
<li>添加一个仪表盘视图。</li>
<li>在英雄列表和仪表盘视图之间导航。</li>
<li>无论在哪个视图中点击一个英雄，都会导航到该英雄的详情页。</li>
<li>在邮件中点击一个深链接，会直接打开一个特定英雄的详情视图。</li>
</ol>
<p>完成时，用户就能像这样在应用中导航：</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/17-5-19/515318-file_1495178472189_13496.png" alt=""></p>
<p>我们将把 Angular 路由器加入应用中，以满足这些需求。 (译注：硬件领域中的路由器是用来帮你找到另一台网络设备的，而这里的路由器用于帮你找到一个组件)</p>
<h3 id="行动计划"><a href="#行动计划" class="headerlink" title="行动计划"></a>行动计划</h3><p>下面是我们的计划：</p>
<ol>
<li>把AppComponent变成应用程序的“壳”，它只处理导航</li>
<li>把现在由AppComponent关注的英雄们移到一个独立的HeroesComponent中</li>
<li>添加路由</li>
<li>创建一个新的DashboardComponent组件(仪表盘组件)</li>
<li>把仪表盘加入导航结构中</li>
</ol>
<blockquote>
<p>路由是导航的另一个名字。路由器就是从一个视图导航到另一个视图的机制。</p>
</blockquote>
<h3 id="拆分-AppComponent"><a href="#拆分-AppComponent" class="headerlink" title="拆分 AppComponent"></a>拆分 AppComponent</h3><p>现在的应用会加载AppComponent组件，并且立刻显示出英雄列表。</p>
<p>我们修改后的应用将提供一个壳，它会选择仪表盘和英雄列表视图之一，然后默认显示它。</p>
<p>AppComponent组件应该只处理导航。 我们来把英雄列表的显示职责，从AppComponent移到HeroesComponent组件中。</p>
<h3 id="HeroesComponent"><a href="#HeroesComponent" class="headerlink" title="HeroesComponent"></a>HeroesComponent</h3><p>AppComponent的职责已经被移交给HeroesComponent了。 与其把AppComponent中所有的东西都搬过去，不如索性把它改名为HeroesComponent，然后单独创建一个新的AppComponent壳。</p>
<p>步骤如下：</p>
<ul>
<li>把app.component.ts文件改名为heroes.component.ts。</li>
<li>把AppComponent类改名为HeroesComponent（注意，只在这一个文件中改名）。</li>
<li><p>把my-app选择器改名为my-heroes。</p>
<p>  @Component({</p>
<pre><code>selector: &apos;my-heroes&apos;,
</code></pre><p>  })<br>  export class HeroesComponent implements OnInit {<br>  }</p>
</li>
</ul>
<h3 id="创建-AppComponent"><a href="#创建-AppComponent" class="headerlink" title="创建 AppComponent"></a>创建 AppComponent</h3><p>新的AppComponent将成为应用的“壳”。 它将在顶部放一些导航链接，并且把我们要导航到的页面放在下面的显示区中。</p>
<p>执行下列步骤:</p>
<ul>
<li>添加支持性的import语句   </li>
<li>创建一个名叫src/app/app.component.ts的新文件</li>
<li>定义一个导出的AppComponent类</li>
<li>在类的上方添加@Component元数据装饰器，装饰器带有my-app选择器。</li>
<li>将下面的项目从HeroesComponent移到AppComponent：</li>
<li>title类属性</li>
<li>@Component模板中的h1标签，它包含了对title属性的绑定。</li>
<li>在模板的标题下面添加<my-heroes>标签，以便我们仍能看到英雄列表。</my-heroes></li>
<li>添加HeroesComponent组件到根模块的declarations数组中，以便 Angular 能认识<my-heroes>标签。</my-heroes></li>
<li>添加HeroService到AppModule的providers数组中，因为我们的每一个视图都需要它。</li>
<li>从HerosComponent的providers数组中移除HeroService，因为它被提到模块了。</li>
<li>为AppComponent添加一些import语句。</li>
</ul>
<blockquote>
<p>回到HeroesComponent，并从providers数组中移除HeroService。 把它从HeroesComponent提升到根NgModule中。 我们不希望在应用的两个不同层次上存在它的两个副本。</p>
</blockquote>
<h3 id="添加路由"><a href="#添加路由" class="headerlink" title="添加路由"></a>添加路由</h3><p>我们希望在用户点击按钮之后才显示英雄列表，而不是自动显示。 换句话说，我们希望用户能“导航”到英雄列表。</p>
<p>我们要使用 Angular 路由器进行导航。</p>
<p>Angular 路由器是一个可选的外部 Angular NgModule，名叫RouterModule。 路由器包含了多种服务(RouterModule)、多种指令(RouterOutlet、RouterLink、RouterLinkActive)、 和一套配置(Routes)。我们将先配置路由。</p>
<base href="">

<p>打开index.html，确保它的<head>区顶部有一个<base href="...">元素（或动态生成该元素的脚本）。</head></p>
<blockquote>
<p>基地址（base href）是必须的</p>
</blockquote>
<h3 id="配置路由"><a href="#配置路由" class="headerlink" title="配置路由"></a>配置路由</h3><p>本应用还没有路由。我们来为应用的路由新建一个配置。</p>
<p>路由告诉路由器，当用户点击链接或者把 URL 粘贴到浏览器地址栏时，应该显示哪个视图。</p>
<p>我们的第一个路由是指向英雄列表组件的。<br>src/app/app.module.ts</p>
<pre><code>import { RouterModule }   from &apos;@angular/router&apos;;
RouterModule.forRoot([
  {
    path: &apos;heroes&apos;,
    component: HeroesComponent
  }
])
</code></pre><p>这个Routes是一个路由定义的数组。 此时，我们只有一个路由定义，但别急，后面还会添加更多。</p>
<p>路由定义包括以下部分：</p>
<ul>
<li>Path: 路由器会用它来匹配浏览器地址栏中的地址，如heroes。</li>
<li>Component: 导航到此路由时，路由器需要创建的组件（HeroesComponent）。</li>
</ul>
<h3 id="让路由器可用"><a href="#让路由器可用" class="headerlink" title="让路由器可用"></a>让路由器可用</h3><p>导入RouterModule并添加到AppModule的imports数组中。<br>src/app/app.module.ts (app routing)</p>
<pre><code>import { NgModule }       from &apos;@angular/core&apos;;
import { BrowserModule }  from &apos;@angular/platform-browser&apos;;
import { FormsModule }    from &apos;@angular/forms&apos;;
import { RouterModule }   from &apos;@angular/router&apos;;
import { AppComponent }        from &apos;./app.component&apos;;
import { HeroDetailComponent } from &apos;./hero-detail.component&apos;;
import { HeroesComponent }     from &apos;./heroes.component&apos;;
import { HeroService }         from &apos;./hero.service&apos;;
@NgModule({
  imports: [
    BrowserModule,
    FormsModule,
    RouterModule.forRoot([
      {
        path: &apos;heroes&apos;,
        component: HeroesComponent
      }
    ])
  ],
  declarations: [
    AppComponent,
    HeroDetailComponent,
    HeroesComponent
  ],
  providers: [
    HeroService
  ],
  bootstrap: [ AppComponent ]
})
export class AppModule {
}
</code></pre><blockquote>
<p>这里使用了forRoot()方法，因为我们是在应用根部提供配置好的路由器。 forRoot()方法提供了路由需要的路由服务提供商和指令，并基于当前浏览器 URL 初始化导航。</p>
</blockquote>
<h3 id="路由出口-Outlet"><a href="#路由出口-Outlet" class="headerlink" title="路由出口(Outlet)"></a>路由出口(Outlet)</h3><p>如果我们把路径/heroes粘贴到浏览器的地址栏，路由器会匹配到’Heroes’路由，并显示HeroesComponent组件。 我们必须告诉路由器它位置，所以我们把<router-outlet>标签添加到模板的底部。 RouterOutlet是由RouterModule提供的指令之一。 当我们在应用中导航时，路由器就把激活的组件显示在<router-outlet>里面。<br>路由器链接</router-outlet></router-outlet></p>
<p>我们当然不会真让用户往地址栏中粘贴路由的 URL， 而应该在模板中的什么地方添加一个锚标签。点击时，就会导航到HeroesComponent组件。</p>
<p>修改过的模板是这样的：<br>src/app/app.component.ts</p>
<pre><code>template: `
   &lt;h1&gt;{{title}}&lt;/h1&gt;
   &lt;a routerLink=&quot;/heroes&quot;&gt;Heroes&lt;/a&gt;
   &lt;router-outlet&gt;&lt;/router-outlet&gt;
</code></pre><p>注意，锚标签中的[routerLink]绑定。 我们把RouterLink指令（ROUTER_DIRECTIVES中的另一个指令）绑定到一个字符串。 它将告诉路由器，当用户点击这个链接时，应该导航到哪里。</p>
<p>由于这个链接不是动态的，我们只要用一次性绑定的方式绑定到路由的路径 (path) 就行了。 回来看路由配置表，我们清楚的看到，这个路径 —— ‘/heroes’就是指向HeroesComponent的那个路由的路径。</p>
<blockquote>
<p>浏览器的地址栏显示的是/。而到HeroesComponent的路由中的路径是/heroes，不是/。 我们没有任何路由能匹配当前的路径/，所以，自然没啥可显示的。 接下来，我们就修复这个问题。</p>
</blockquote>
<p>我们点击“Heroes（英雄列表）”导航链接，浏览器地址栏更新为/heroes，并且看到了英雄列表。我们终于导航过去了！</p>
<p>现在，AppComponent是这样的:</p>
<pre><code>import { Component } from &apos;@angular/core&apos;;
@Component({
  selector: &apos;my-app&apos;,
  template: `
     &lt;h1&gt;{{title}}&lt;/h1&gt;
     &lt;a routerLink=&quot;/heroes&quot;&gt;Heroes&lt;/a&gt;
     &lt;router-outlet&gt;&lt;/router-outlet&gt;
   `
})
export class AppComponent {
  title = &apos;Tour of Heroes&apos;;
}
</code></pre><p>AppComponent现在加上了路由器，并能显示路由到的视图了。 因此，为了把它从其它种类的组件中区分出来，我们称这类组件为路由器组件。</p>
<h3 id="添加一个仪表盘"><a href="#添加一个仪表盘" class="headerlink" title="添加一个仪表盘"></a>添加一个仪表盘</h3><p>当我们有多个视图的时候，路由才有意义。所以我们需要另一个视图。先创建一个DashboardComponent的占位符，让用户可以导航到它或从它导航出来。</p>
<pre><code>import { Component } from &apos;@angular/core&apos;;
@Component({
  selector: &apos;my-dashboard&apos;,
  template: &apos;&lt;h3&gt;My Dashboard&lt;/h3&gt;&apos;
})
export class DashboardComponent { }
</code></pre><p>我们先不实现它，稍后，我们再回来，给这个组件一些实际用途。<br>配置仪表盘路由</p>
<p>要让app.module.ts能导航到仪表盘，就要先导入仪表盘组件，然后把下列路由定义添加到Routes数组中。</p>
<pre><code>{
  path: &apos;dashboard&apos;,
  component: DashboardComponent
},
</code></pre><p>然后还得把DashboardComponent添加到AppModule的declarations数组中。</p>
<pre><code>declarations: [
  AppComponent,
  DashboardComponent,
  HeroDetailComponent,
  HeroesComponent
],
</code></pre><h3 id="添加重定向路由"><a href="#添加重定向路由" class="headerlink" title="添加重定向路由"></a>添加重定向路由</h3><p>浏览器启动时地址栏中的地址是/。 当应用启动时，它应该显示仪表盘，并且在浏览器的地址栏显示URL：/dashboard</p>
<p>我们可以使用重定向路由来实现它。把下面的内容添加到路由定义数组中：</p>
<pre><code>{
  path: &apos;&apos;,
  redirectTo: &apos;/dashboard&apos;,
  pathMatch: &apos;full&apos;
},
</code></pre><h3 id="添加导航到模版中"><a href="#添加导航到模版中" class="headerlink" title="添加导航到模版中"></a>添加导航到模版中</h3><p>在模板上添加一个到仪表盘的导航链接，就放在Heroes（英雄列表）链接的上方。</p>
<pre><code>template: `
&lt;h1&gt;{{title}}&lt;/h1&gt;
&lt;nav&gt;
 &lt;a routerLink=&quot;/dashboard&quot;&gt;Dashboard&lt;/a&gt;
 &lt;a routerLink=&quot;/heroes&quot;&gt;Heroes&lt;/a&gt;
&lt;/nav&gt;
&lt;router-outlet&gt;&lt;/router-outlet&gt;
</code></pre><blockquote>
<p>我们在<nav>标签中放了两个链接。 它们现在还没有作用，但稍后，当我们对这些链接添加样式时，会显得比较方便。</nav></p>
</blockquote>
<h3 id="把英雄添加到仪表盘"><a href="#把英雄添加到仪表盘" class="headerlink" title="把英雄添加到仪表盘"></a>把英雄添加到仪表盘</h3><p>我们想让仪表盘更有趣，比如：让用户一眼就能看到四个顶级英雄。</p>
<p>把元数据中的template属性替换为templateUrl属性，它将指向一个新的模板文件。</p>
<pre><code>@Component({
  selector: &apos;my-dashboard&apos;,
  templateUrl: &apos;./dashboard.component.html&apos;,
})
</code></pre><p>使用下列内容创建文件：<br>src/app/dashboard.component.html</p>
<pre><code>&lt;h3&gt;Top Heroes&lt;/h3&gt;
&lt;div class=&quot;grid grid-pad&quot;&gt;
  &lt;div * ngFor=&quot;let hero of heroes&quot; class=&quot;col-1-4&quot;&gt;
    &lt;div class=&quot;module hero&quot;&gt;
      &lt;h4&gt;{{hero.name}}&lt;/h4&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre><p>我们再次使用*ngFor来在英雄列表上迭代，并显示它们的名字。 还添加了一个额外的<div>元素，来帮助稍后的美化工作。</div></p>
<h3 id="共享-HeroService"><a href="#共享-HeroService" class="headerlink" title="共享 HeroService"></a>共享 HeroService</h3><p>要想管理该组件的heroes数组，我们可以复用HeroService。</p>
<p>在前面的章节中，我们从HeroesComponent的providers数组中移除了HeroService服务， 并把它添加到AppModule的providers数组中。 这个改动创建了一个HeroService的单例对象，应用中的所有组件都可以使用它。 Angular 会把HeroService注入到DashboardComponent，我们就能在DashboardComponent中使用它了。</p>
<h3 id="获取英雄数据"><a href="#获取英雄数据" class="headerlink" title="获取英雄数据"></a>获取英雄数据</h3><p>打开dashboard.component.ts文件，并添加下列import语句。</p>
<pre><code>import { Component, OnInit } from &apos;@angular/core&apos;;
import { Hero } from &apos;./hero&apos;;
import { HeroService } from &apos;./hero.service&apos;;
</code></pre><p>我们需要实现OnInit接口，因为我们将在ngOnInit方法中初始化英雄数组 —— 就像上次一样。 我们需要导入Hero类和HeroService类来引用它们的数据类型。</p>
<p>我们现在就实现DashboardComponent类，像这样：</p>
<pre><code>export class DashboardComponent implements OnInit {
  heroes: Hero[] = [];
  constructor(private heroService: HeroService) { }
  ngOnInit(): void {
    this.heroService.getHeroes()
      .then(heroes =&gt; this.heroes = heroes.slice(1, 5));
  }
}
</code></pre><p>我们在之前的HeroesComponent中也看到过类似的逻辑：</p>
<ul>
<li>创建一个heroes数组属性。</li>
<li>在构造函数中注入HeroService，并且把它保存在一个私有的heroService字段中。</li>
<li>在 Angular 的ngOnInit生命周期钩子里面调用服务来获得英雄数据。</li>
</ul>
<p>在仪表盘中我们用Array.slice方法提取了四个英雄（第2、3、4、5个）。</p>
<p>刷新浏览器，在这个新的仪表盘中就看到了四个英雄。</p>
<h3 id="导航到英雄详情"><a href="#导航到英雄详情" class="headerlink" title="导航到英雄详情"></a>导航到英雄详情</h3><p>虽然我们在HeroesComponent组件的底部显示了所选英雄的详情， 但用户还没法导航到HeroDetailComponent组件。我们可以用下列方式导航到HeroDetailComponent：</p>
<ul>
<li>从Dashboard（仪表盘）导航到一个选定的英雄。</li>
<li>从Heroes（英雄列表）导航到一个选定的英雄。</li>
<li>把一个指向该英雄的“深链接” URL 粘贴到浏览器的地址栏。</li>
</ul>
<p>路由到一个英雄详情</p>
<p>我们将在app.module.ts中添加一个到HeroDetailComponent的路由，也就是配置其它路由的地方。</p>
<p>这个新路由的不寻常之处在于，我们必须告诉HeroDetailComponent该显示哪个英雄。 之前，我们不需要告诉HeroesComponent组件和DashboardComponent组件任何东西。</p>
<p>现在，父组件HeroesComponent通过数据绑定来把一个英雄对象设置为组件的hero属性。就像这样：</p>
<pre><code>&lt;hero-detail [hero]=&quot;selectedHero&quot;&gt;&lt;/hero-detail&gt;
</code></pre><p>显然，在我们的任何一个路由场景中它都无法工作。 最后一种场景肯定不行，我们无法将一个完整的 hero 对象嵌入到 URL 中！不过我们本来也不想这样。<br>参数化路由</p>
<p>我们可以把英雄的id添加到 URL 中。当导航到一个id为 11 的英雄时，我们期望的 URL 是这样的：</p>
<pre><code>/detail/11
</code></pre><p>URL中的/detail/部分是固定不变的，但结尾的数字id部分会随着英雄的不同而变化。 我们要把路由中可变的那部分表示成一个参数 (parameter) 或令牌 (token) ，代表英雄的id。<br>配置带参数的路由</p>
<p>我们将使用下列路由定义。</p>
<pre><code>{
  path: &apos;detail/:id&apos;,
  component: HeroDetailComponent
},
</code></pre><p>路径中的冒号 (:) 表示:id是一个占位符，当导航到这个HeroDetailComponent组件时，它将被填入一个特定英雄的id。</p>
<blockquote>
<p>别忘了在创建这个路由前导入英雄详情组件。</p>
</blockquote>
<p>我们已经完成了本应用的路由的配置。</p>
<p>我们没有往模板中添加一个’英雄详情’，这是因为用户不会直接点击导航栏中的链接去查看一个特定的英雄。 它们只会通过在英雄列表或者仪表盘中点击来显示一个英雄。</p>
<p>要想支持“点击英雄”，就得先对HeroDetailComponent进行修改，好让我们能导航到它。</p>
<h3 id="修改HeroDetailComponent"><a href="#修改HeroDetailComponent" class="headerlink" title="修改HeroDetailComponent"></a>修改HeroDetailComponent</h3><p>在重写HeroDetailComponent之前，我们先看看它现在的样子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, Input &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Hero &#125; <span class="keyword">from</span> <span class="string">'./hero'</span>;</div><div class="line">@Component(&#123;</div><div class="line">  <span class="attr">selector</span>: <span class="string">'hero-detail'</span>,</div><div class="line">  <span class="attr">template</span>: <span class="string">`</span></div><div class="line">    &lt;div *ngIf="hero"&gt;</div><div class="line">      &lt;h2&gt;&#123;&#123;hero.name&#125;&#125; details!&lt;/h2&gt;</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;label&gt;id: &lt;/label&gt;&#123;&#123;hero.id&#125;&#125;</div><div class="line">      &lt;/div&gt;</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;label&gt;name: &lt;/label&gt;</div><div class="line">        &lt;input [(ngModel)]="hero.name" placeholder="name"/&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  `</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroDetailComponent</span> </span>&#123;</div><div class="line">  @Input() hero: Hero;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>模板不用修改，我们会用原来的方式显示英雄。导致这次大修的原因是如何获得这个英雄的数据。</p>
<p>我们不会再从父组件的属性绑定中接收英雄数据。 新的HeroDetailComponent应该从ActivatedRoute服务的可观察对象params中取得id参数， 并通过HeroService服务获取具有这个指定id的英雄数据。</p>
<p>先添加下列导入语句：</p>
<pre><code>import { Component, Input, OnInit } from &apos;@angular/core&apos;;
import { ActivatedRoute, Params }   from &apos;@angular/router&apos;;
import { Location }                 from &apos;@angular/common&apos;;
import { HeroService } from &apos;./hero.service&apos;;
</code></pre><p>然后注入ActivatedRoute和HeroService服务到构造函数中，将它们的值保存到私有变量中：</p>
<pre><code>constructor(
  private heroService: HeroService,
  private route: ActivatedRoute,
  private location: Location
) {}


import &apos;rxjs/add/operator/switchMap&apos;;
</code></pre><p>我们告诉这个类，我们要实现OnInit接口。</p>
<pre><code>export class HeroDetailComponent implements OnInit {
</code></pre><p>在ngOnInit()生命周期钩子中，我们从ActivatedRoute服务的可观察对象params中提取id参数， 并且使用HeroService来获取具有这个id的英雄数据。。</p>
<pre><code>ngOnInit(): void {
  this.route.params
    .switchMap((params: Params) =&gt; this.heroService.getHero(+params[&apos;id&apos;]))
    .subscribe(hero =&gt; this.hero = hero);
}
</code></pre><p>注意switchMap运算符如何将可观察的路由参数中的 id 映射到一个新的Observable， 即HeroService.getHero()方法的结果。</p>
<p>如果用户在 getHero 请求执行的过程中再次导航这个组件，switchMap 再次调用HeroService.getHero()之前， 会取消之前的请求。</p>
<p>英雄的id是数字，而路由参数的值总是字符串。 所以我们需要通过 JavaScript 的 (+) 操作符把路由参数的值转成数字。</p>
<h3 id="添加-HeroService-getHero"><a href="#添加-HeroService-getHero" class="headerlink" title="添加 HeroService.getHero()"></a>添加 HeroService.getHero()</h3><p>在前面的代码片段中HeroService没有getHero()方法。要解决这个问题，请打开HeroService并添加一个getHero()方法，它会根据id从getHeroes()中过滤英雄列表。</p>
<pre><code>getHero(id: number): Promise&lt;Hero&gt; {
  return this.getHeroes()
             .then(heroes =&gt; heroes.find(hero =&gt; hero.id === id));
}
</code></pre><p>回到原路</p>
<p>用户有多种方式导航到HeroDetailComponent。</p>
<p>要导航到别处，用户可以点击AppComponent中的两个链接之一，也可以点击浏览器的后退按钮。 我们来添加第三个选项：一个goBack()方法，它使用之前注入的Location服务， 利用浏览器的历史堆栈，导航到上一步。</p>
<pre><code>goBack(): void {
  this.location.back();
}
</code></pre><blockquote>
<p>回退太多步会跑出我们的应用。 在真实的应用中，我们需要使用CanDeactivate守卫对此进行防范。</p>
</blockquote>
<p>然后，我们通过一个事件绑定把此方法绑定到模板底部的 Back（后退）按钮上。</p>
<pre><code>&lt;button (click)=&quot;goBack()&quot;&gt;Back&lt;/button&gt;
</code></pre><p>修改模板，添加这个按钮以提醒我们还要做更多的改进， 并把模板移到独立的hero-detail.component.html文件中去。</p>
<pre><code>&lt;div * ngIf=&quot;hero&quot;&gt;
  &lt;h2&gt;{{hero.name}} details!&lt;/h2&gt;
  &lt;div&gt;
    &lt;label&gt;id: &lt;/label&gt;{{hero.id}}&lt;/div&gt;
  &lt;div&gt;
    &lt;label&gt;name: &lt;/label&gt;
    &lt;input [(ngModel)]=&quot;hero.name&quot; placeholder=&quot;name&quot; /&gt;
  &lt;/div&gt;
  &lt;button (click)=&quot;goBack()&quot;&gt;Back&lt;/button&gt;
&lt;/div&gt;
</code></pre><p>然后修改组件元数据的templateUrl属性，让它指向我们刚刚创建的模板文件。</p>
<pre><code>@Component({
  selector: &apos;hero-detail&apos;,
  templateUrl: &apos;./hero-detail.component.html&apos;,
})
</code></pre><h3 id="选择一个仪表盘中的英雄"><a href="#选择一个仪表盘中的英雄" class="headerlink" title="选择一个仪表盘中的英雄"></a>选择一个仪表盘中的英雄</h3><p>当用户从仪表盘中选择了一位英雄时，本应用要导航到HeroDetailComponent以查看和编辑所选的英雄。</p>
<p>虽然仪表盘英雄被显示为像按钮一样的方块，但是它们的行为应该像锚标签一样。 当鼠标移动到一个英雄方块上时，目标 URL 应该显示在浏览器的状态条上，用户应该能拷贝链接或者在新的浏览器标签页中打开英雄详情视图。</p>
<p>要达到这个效果，再次打开dashboard.component.html，将用来迭代的<div *="" ngfor...="">替换为<a>，就像这样：</a></div></p>
<pre><code>&lt;a * ngFor=&quot;let hero of heroes&quot;  [routerLink]=&quot;[&apos;/detail&apos;, hero.id]&quot;  class=&quot;col-1-4&quot;&gt;
</code></pre><p>注意[routerLink]绑定。正如本章的部分所说， AppComponent模板中的顶级导航有一些路由器链接被设置固定的路径，例如“/dashboard”和“/heroes”。</p>
<p>这次，我们绑定了一个包含链接参数数组的表达式。 该数组有两个元素，目标路由和一个用来设置当前英雄的 id 值的路由参数。</p>
<p>这两个数组项与之前在app.module.ts添加的参数化的英雄详情路由定义中的 path 和 :id 对应。</p>
<pre><code>{
  path: &apos;detail/:id&apos;,
  component: HeroDetailComponent
},
</code></pre><h3 id="重构路由为一个路由模块"><a href="#重构路由为一个路由模块" class="headerlink" title="重构路由为一个路由模块"></a>重构路由为一个路由模块</h3><p>AppModule中有将近 20 行代码是用来配置四个路由的。 绝大多数应用有更多路由，并且它们还有守卫服务来保护不希望或未授权的导航。 （要了解守卫服务的更多知识，参见路由与导航页的路由守卫） 路由的配置可能迅速占领这个模块，并掩盖其主要目的，即为 Angular 编译器设置整个应用的关键配置。</p>
<p>我们应该重构路由配置到它自己的类。 什么样的类呢？ 当前的RouterModule.forRoot()产生一个Angular ModuleWithProviders，所以这个路由类应该是一种模块类。 它应该是一个路由模块。要想了解更多，请参阅路由与导航一章的里程碑2：路由模块部分。</p>
<p>按约定，路由模块的名字应该包含 “Routing”，并与导航到的组件所在的模块的名称看齐。</p>
<p>在app.module.ts所在目录创建app-routing.module.ts文件。将下面从AppModule类提取出来的代码拷贝进去：</p>
<pre><code>import { NgModule }             from &apos;@angular/core&apos;;
import { RouterModule, Routes } from &apos;@angular/router&apos;;
import { DashboardComponent }   from &apos;./dashboard.component&apos;;
import { HeroesComponent }      from &apos;./heroes.component&apos;;
import { HeroDetailComponent }  from &apos;./hero-detail.component&apos;;
const routes: Routes = [
  { path: &apos;&apos;, redirectTo: &apos;/dashboard&apos;, pathMatch: &apos;full&apos; },
  { path: &apos;dashboard&apos;,  component: DashboardComponent },
  { path: &apos;detail/:id&apos;, component: HeroDetailComponent },
  { path: &apos;heroes&apos;,     component: HeroesComponent }
];
@NgModule({
  imports: [ RouterModule.forRoot(routes) ],
  exports: [ RouterModule ]
})
export class AppRoutingModule {}
</code></pre><p>典型路由模块需要注意的有：</p>
<ul>
<li>将路由抽出到一个变量中。如果你将来要导出这个模块，这种 “路由模块” 的模式也会更加明确。</li>
<li>添加RouterModule.forRoot(routes)到imports。</li>
<li>把RouterModule添加到路由模块的exports中，以便关联模块（比如AppModule）中的组件可以访问路由模块中的声明，比如RouterLink 和 RouterOutlet。</li>
<li>无declarations！声明是关联模块的任务。</li>
<li>如果有守卫服务，把它们添加到本模块的providers中（本例子中没有守卫服务）。</li>
</ul>
<h3 id="修改-AppModule"><a href="#修改-AppModule" class="headerlink" title="修改 AppModule"></a>修改 AppModule</h3><p>删除AppModule中的路由配置，并导入AppRoutingModule （使用 ES import语句导入，并将它添加到NgModule.imports列表）。</p>
<p>下面是修改后的AppModule，与重构前的对比：</p>
<p>src/app/app.module.ts(after)</p>
<pre><code>import { NgModule }       from &apos;@angular/core&apos;;
import { BrowserModule }  from &apos;@angular/platform-browser&apos;;
import { FormsModule }    from &apos;@angular/forms&apos;;
import { AppComponent }         from &apos;./app.component&apos;;
import { DashboardComponent }   from &apos;./dashboard.component&apos;;
import { HeroDetailComponent }  from &apos;./hero-detail.component&apos;;
import { HeroesComponent }      from &apos;./heroes.component&apos;;
import { HeroService }          from &apos;./hero.service&apos;;
import { AppRoutingModule }     from &apos;./app-routing.module&apos;;
@NgModule({
  imports: [
    BrowserModule,
    FormsModule,
    AppRoutingModule
  ],
  declarations: [
    AppComponent,
    DashboardComponent,
    HeroDetailComponent,
    HeroesComponent
  ],
  providers: [ HeroService ],
  bootstrap: [ AppComponent ]
})
export class AppModule { }
</code></pre><p>src/app/app.module.ts(before)</p>
<pre><code>import { NgModule }       from &apos;@angular/core&apos;;
import { BrowserModule }  from &apos;@angular/platform-browser&apos;;
import { FormsModule }    from &apos;@angular/forms&apos;;
import { AppComponent }         from &apos;./app.component&apos;;
import { DashboardComponent }   from &apos;./dashboard.component&apos;;
import { HeroDetailComponent }  from &apos;./hero-detail.component&apos;;
import { HeroesComponent }      from &apos;./heroes.component&apos;;
import { HeroService }          from &apos;./hero.service&apos;;
import { AppRoutingModule }     from &apos;./app-routing.module&apos;;
@NgModule({
  imports: [
    BrowserModule,
    FormsModule,
    AppRoutingModule
  ],
  declarations: [
    AppComponent,
    DashboardComponent,
    HeroDetailComponent,
    HeroesComponent
  ],
  providers: [ HeroService ],
  bootstrap: [ AppComponent ]
})
export class AppModule { }
</code></pre><h3 id="在-HeroesComponent-中选择一位英雄"><a href="#在-HeroesComponent-中选择一位英雄" class="headerlink" title="在 HeroesComponent 中选择一位英雄"></a>在 HeroesComponent 中选择一位英雄</h3><p>在HeroesComponent中，当前模板展示了一个主从风格的界面：上方是英雄列表，底下是所选英雄的详情。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">template: `</div><div class="line">  &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">  &lt;h2&gt;My Heroes&lt;/h2&gt;</div><div class="line">  &lt;ul class=&quot;heroes&quot;&gt;</div><div class="line">    &lt;li *ngFor=&quot;let hero of heroes&quot;</div><div class="line">      [class.selected]=&quot;hero === selectedHero&quot;</div><div class="line">      (click)=&quot;onSelect(hero)&quot;&gt;</div><div class="line">      &lt;span class=&quot;badge&quot;&gt;&#123;&#123;hero.id&#125;&#125;&lt;/span&gt; &#123;&#123;hero.name&#125;&#125;</div><div class="line">    &lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">  &lt;hero-detail [hero]=&quot;selectedHero&quot;&gt;&lt;/hero-detail&gt;</div><div class="line">`,</div></pre></td></tr></table></figure>
<p>删除顶部的h1。</p>
<p>删除模板最后带有hero-detail标签的那一行。</p>
<p>我们不在这里展示完整的HeroDetailComponent了。 而是在独立的路由和页面中显示英雄详情，就像我们在仪表盘中所做的那样。</p>
<p>但是，当用户从列表中选择一个英雄时，他们不会在导航到详情页， 而是在当前页显示一个Mini版详情视图，当用户点击一个按钮时，才导航到完整的详情页面。<br>添加 mini 版英雄详情</p>
<p>在模板底部原来放hero-detail的地方添加下列 HTML 片段：</p>
<pre><code>&lt;div * ngIf=&quot;selectedHero&quot;&gt;
  &lt;h2&gt;
    {{selectedHero.name | uppercase}} is my hero
  &lt;/h2&gt;
  &lt;button (click)=&quot;gotoDetail()&quot;&gt;View Details&lt;/button&gt;
&lt;/div&gt;
</code></pre><p>点击一个英雄，用户将会在英雄列表的下方看到这些：</p>
<p><img src="http://oq6u0ixei.bkt.clouddn.com/QQ20170519-0@2x.png" alt=""></p>
<p>使用uppercase管道格式化</p>
<p>注意，英雄的名字全被显示成大写字母。那是uppercase管道的效果，借助它，我们能干预插值表达式绑定的过程。可以管道操作符 ( | ) 后面看到它。</p>
<pre><code>{{selectedHero.name | uppercase}} is my hero
</code></pre><p>管道擅长做下列工作：格式化字符串、金额、日期和其它显示数据。 Angular 自带了一些管道，我们也可以写自己的管道。</p>
<p>把内容移出组件文件</p>
<p>当用户点击查看详情按钮时，要让它能导航到HeroDetailComponent，我们还需要修改它。</p>
<p>这个组件文件太大了。要想在 HTML 和 CSS 的噪音中看清组件的工作逻辑太难了。</p>
<p>在做更多修改之前，我们先把模板和样式移到它们自己的文件中去：</p>
<p>首先，从heroes.component.ts中把模板内容移到新的heroes.component.html文件中，但不要把反引号也拷贝过去。就像heroes.component.ts一样，我们很快就能做完。接着，把样式的内容移到新的heroes.component.css文件中。</p>
<p>这两个新文件是这样的：</p>
<pre><code>&lt;h2&gt;My Heroes&lt;/h2&gt;
&lt;ul class=&quot;heroes&quot;&gt;
&lt;li * ngFor=&quot;let hero of heroes&quot;
[class.selected]=&quot;hero === selectedHero&quot;
(click)=&quot;onSelect(hero)&quot;&gt;
&lt;span class=&quot;badge&quot;&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
&lt;/li&gt;
&lt;/ul&gt;
&lt;div * ngIf=&quot;selectedHero&quot;&gt;
&lt;h2&gt;
{{selectedHero.name | uppercase}} is my hero
&lt;/h2&gt;
&lt;button (click)=&quot;gotoDetail()&quot;&gt;View Details&lt;/button&gt;
&lt;/div&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">.selected &#123;</div><div class="line">  background-color: #CFD8DC !important;</div><div class="line">  color: white;</div><div class="line">&#125;</div><div class="line">.heroes &#123;</div><div class="line">  margin: 0 0 2em 0;</div><div class="line">  list-style-type: none;</div><div class="line">  padding: 0;</div><div class="line">  width: 15em;</div><div class="line">&#125;</div><div class="line">.heroes li &#123;</div><div class="line">  cursor: pointer;</div><div class="line">  position: relative;</div><div class="line">  left: 0;</div><div class="line">  background-color: #EEE;</div><div class="line">  margin: .5em;</div><div class="line">  padding: .3em 0;</div><div class="line">  height: 1.6em;</div><div class="line">  border-radius: 4px;</div><div class="line">&#125;</div><div class="line">.heroes li:hover &#123;</div><div class="line">  color: #607D8B;</div><div class="line">  background-color: #DDD;</div><div class="line">  left: .1em;</div><div class="line">&#125;</div><div class="line">.heroes li.selected:hover &#123;</div><div class="line">  background-color: #BBD8DC !important;</div><div class="line">  color: white;</div><div class="line">&#125;</div><div class="line">.heroes .text &#123;</div><div class="line">  position: relative;</div><div class="line">  top: -3px;</div><div class="line">&#125;</div><div class="line">.heroes .badge &#123;</div><div class="line">  display: inline-block;</div><div class="line">  font-size: small;</div><div class="line">  color: white;</div><div class="line">  padding: 0.8em 0.7em 0 0.7em;</div><div class="line">  background-color: #607D8B;</div><div class="line">  line-height: 1em;</div><div class="line">  position: relative;</div><div class="line">  left: -1px;</div><div class="line">  top: -4px;</div><div class="line">  height: 1.8em;</div><div class="line">  margin-right: .8em;</div><div class="line">  border-radius: 4px 0 0 4px;</div><div class="line">&#125;</div><div class="line">button &#123;</div><div class="line">  font-family: Arial;</div><div class="line">  background-color: #eee;</div><div class="line">  border: none;</div><div class="line">  padding: 5px 10px;</div><div class="line">  border-radius: 4px;</div><div class="line">  cursor: pointer;</div><div class="line">  cursor: hand;</div><div class="line">&#125;</div><div class="line">button:hover &#123;</div><div class="line">  background-color: #cfd8dc;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在，回来编辑heroes.component.ts中的组件元数据，删除template 和 styles属性，代之以相应的templateUrl 和 styleUrls属性。让它们指向这些新文件。</p>
<pre><code>@Component({
  selector: &apos;my-heroes&apos;,
  templateUrl: &apos;./heroes.component.html&apos;,
  styleUrls: [ &apos;./heroes.component.css&apos; ]
})
</code></pre><blockquote>
<p>styleUrls属性是一个由样式文件的文件名(包括路径)组成的数组。我们还可以列出来自多个不同位置的样式文件。</p>
</blockquote>
<h3 id="更新-HeroesComponent-类"><a href="#更新-HeroesComponent-类" class="headerlink" title="更新 HeroesComponent 类"></a>更新 HeroesComponent 类</h3><p>点击按钮时，HeroesComponent导航到HeroDetailComponent。 该按钮的点击事件绑定到了gotoDetail()方法，它使用命令式的导航，告诉路由器去哪儿。</p>
<p>该方法需要对组件类做一些修改：</p>
<ol>
<li>从 Angular 路由器库导入Router</li>
<li>在构造函数中注入Router（与HeroService一起）</li>
<li><p>实现gotoDetail()，调用路由器的navigate()方法</p>
<p> gotoDetail(): void {<br>   this.router.navigate([‘/detail’, this.selectedHero.id]);<br> }</p>
</li>
</ol>
<p>注意，我们将一个包含两个元素的链接参数数组 — 路径和路由参数 — 传递到路由的navigate（）， 与之前在DashboardComponent中使用[routerLink]绑定一样。 修改完成的HeroesComponent类如下所示：</p>
<p>src/app/heroes.component.ts (class)</p>
<pre><code>export class HeroesComponent implements OnInit {
  heroes: Hero[];
  selectedHero: Hero;
  constructor(
    private router: Router,
    private heroService: HeroService) { }
  getHeroes(): void {
    this.heroService.getHeroes().then(heroes =&gt; this.heroes = heroes);
  }
  ngOnInit(): void {
    this.getHeroes();
  }
  onSelect(hero: Hero): void {
    this.selectedHero = hero;
  }
  gotoDetail(): void {
    this.router.navigate([&apos;/detail&apos;, this.selectedHero.id]);
  }
}
</code></pre><p>刷新浏览器，并开始点击。 我们能在应用中导航：从仪表盘到英雄详情再回来，从英雄列表到 mini 版英雄详情到英雄详情，再回到英雄列表。 我们可以在仪表盘和英雄列表之间跳来跳去。</p>
<p>我们已经满足了在本章开头设定的所有导航需求。</p>
<h3 id="美化本应用"><a href="#美化本应用" class="headerlink" title="美化本应用"></a>美化本应用</h3><p>应用在功能上已经正常了，但还需要美化。 仪表盘上的英雄应该显示在一行上的几个方块中。 我们拿到了大约60行CSS来完成这件事，包括一些简单的媒体查询代码以实现响应式设计。</p>
<p>我们不能把这 60 来行 CSS 粘贴到组件元数据的styles中，否则它会淹没组件的工作逻辑。反之，我们应该在独立的*.css文件中编辑这些CSS。</p>
<p>把dashboard.component.css文件添加到app目录下，并在组件元数据的styleUrls数组属性中引用它。就像这样：</p>
<p>src/app/dashboard.component.ts (styleUrls)</p>
<pre><code>styleUrls: [ &apos;./dashboard.component.css&apos; ]
</code></pre><p>美化英雄详情</p>
<p>我们还拿到了一些HeroDetailComponent特有的 CSS 风格。</p>
<p>在app目录下添加hero-detail.component.css文件， 并且在styleUrls数组中引用它 —— 就像之前在DashboardComponent中做过的那样。 同时删除hero@Input装饰器属性和它的导入语句。</p>
<p>上述组件的 CSS 文件内容如下：<br>src/app/hero-detail.component.css<br>label {<br>  display: inline-block;<br>  width: 3em;<br>  margin: .5em 0;<br>  color: #607D8B;<br>  font-weight: bold;<br>}<br>input {<br>  height: 2em;<br>  font-size: 1em;<br>  padding-left: .4em;<br>}<br>button {<br>  margin-top: 20px;<br>  font-family: Arial;<br>  background-color: #eee;<br>  border: none;<br>  padding: 5px 10px;<br>  border-radius: 4px;<br>  cursor: pointer; cursor: hand;<br>}<br>button:hover {<br>  background-color: #cfd8dc;<br>}<br>button:disabled {<br>  background-color: #eee;<br>  color: #ccc;<br>  cursor: auto;<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">src/app/dashboard.component.css</div><div class="line">```JavaScript</div><div class="line">[class*=&apos;col-&apos;] &#123;</div><div class="line">  float: left;</div><div class="line">  padding-right: 20px;</div><div class="line">  padding-bottom: 20px;</div><div class="line">&#125;</div><div class="line">[class*=&apos;col-&apos;]:last-of-type &#123;</div><div class="line">  padding-right: 0;</div><div class="line">&#125;</div><div class="line">a &#123;</div><div class="line">  text-decoration: none;</div><div class="line">&#125;</div><div class="line">*,* :after, * :before &#123;</div><div class="line">  -webkit-box-sizing: border-box;</div><div class="line">  -moz-box-sizing: border-box;</div><div class="line">  box-sizing: border-box;</div><div class="line">&#125;</div><div class="line">h3 &#123;</div><div class="line">  text-align: center; margin-bottom: 0;</div><div class="line">&#125;</div><div class="line">h4 &#123;</div><div class="line">  position: relative;</div><div class="line">&#125;</div><div class="line">.grid &#123;</div><div class="line">  margin: 0;</div><div class="line">&#125;</div><div class="line">.col-1-4 &#123;</div><div class="line">  width: 25%;</div><div class="line">&#125;</div><div class="line">.module &#123;</div><div class="line">  padding: 20px;</div><div class="line">  text-align: center;</div><div class="line">  color: #eee;</div><div class="line">  max-height: 120px;</div><div class="line">  min-width: 120px;</div><div class="line">  background-color: #607D8B;</div><div class="line">  border-radius: 2px;</div><div class="line">&#125;</div><div class="line">.module:hover &#123;</div><div class="line">  background-color: #EEE;</div><div class="line">  cursor: pointer;</div><div class="line">  color: #607d8b;</div><div class="line">&#125;</div><div class="line">.grid-pad &#123;</div><div class="line">  padding: 10px 0;</div><div class="line">&#125;</div><div class="line">.grid-pad &gt; [class*=&apos;col-&apos;]:last-of-type &#123;</div><div class="line">  padding-right: 20px;</div><div class="line">&#125;</div><div class="line">@media (max-width: 600px) &#123;</div><div class="line">  .module &#123;</div><div class="line">    font-size: 10px;</div><div class="line">    max-height: 75px; &#125;</div><div class="line">&#125;</div><div class="line">@media (max-width: 1024px) &#123;</div><div class="line">  .grid &#123;</div><div class="line">    margin: 0;</div><div class="line">  &#125;</div><div class="line">  .module &#123;</div><div class="line">    min-width: 60px;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>美化导航链接</p>
<p>设计师还给了我们一些 CSS，用于让AppComponent中的导航链接看起来更像可被选择的按钮。 要让它们协同工作，我们得把那些链接包含在<nav>标签中。</nav></p>
<p>在app目录下添加一个app.component.css文件，内容如下：</p>
<p>src/app/app.component.css (navigation styles)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">h1 &#123;</div><div class="line">  font-size: 1.2em;</div><div class="line">  color: #999;</div><div class="line">  margin-bottom: 0;</div><div class="line">&#125;</div><div class="line">h2 &#123;</div><div class="line">  font-size: 2em;</div><div class="line">  margin-top: 0;</div><div class="line">  padding-top: 0;</div><div class="line">&#125;</div><div class="line">nav a &#123;</div><div class="line">  padding: 5px 10px;</div><div class="line">  text-decoration: none;</div><div class="line">  margin-top: 10px;</div><div class="line">  display: inline-block;</div><div class="line">  background-color: #eee;</div><div class="line">  border-radius: 4px;</div><div class="line">&#125;</div><div class="line">nav a:visited, a:link &#123;</div><div class="line">  color: #607D8B;</div><div class="line">&#125;</div><div class="line">nav a:hover &#123;</div><div class="line">  color: #039be5;</div><div class="line">  background-color: #CFD8DC;</div><div class="line">&#125;</div><div class="line">nav a.active &#123;</div><div class="line">  color: #039be5;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>routerLinkActive指令<br>  Angular路由器提供了routerLinkActive指令，我们可以用它来为匹配了活动路由的 HTML 导航元素自动添加一个 CSS 类。 我们唯一要做的就是为它定义样式。真好！<br>  src/app/app.component.ts (active router links)<br>      <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  template: `</div><div class="line">  &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">  &lt;nav&gt;</div><div class="line">    &lt;a routerLink=&quot;/dashboard&quot; routerLinkActive=&quot;active&quot;&gt;Dashboard&lt;/a&gt;</div><div class="line">    &lt;a routerLink=&quot;/heroes&quot; routerLinkActive=&quot;active&quot;&gt;Heroes&lt;/a&gt;</div><div class="line">  &lt;/nav&gt;</div><div class="line">  &lt;router-outlet&gt;&lt;/router-outlet&gt;</div><div class="line">`,</div></pre></td></tr></table></figure></p>
</blockquote>
<p>首先把moduleId: module.id添加到AppComponent组件的@Component元数据中以启用相对于模块的文件URL。 然后添加styleUrls属性，使其指向这个CSS文件，代码如下：</p>
<pre><code>styleUrls: [&apos;./app.component.css&apos;],
</code></pre><p>应用的全局样式</p>
<p>当我们把样式添加到组件中时，我们假定组件所需的一切 — HTML、CSS、程序代码 — 都在紧邻的地方。 这样，无论是把它们打包在一起还是在别的组件中复用它都会很容易。</p>
<p>我们也可以在所有组件之外创建应用级样式。</p>
<p>我们的设计师提供了一组基础样式，这些样式应用到的元素横跨整个应用。 它们与我们之前在开发环境时安装的整套样式对应。 下面是摘录：</p>
<p>src/styles.css (excerpt)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">/* Master Styles */</div><div class="line">h1 &#123;</div><div class="line">  color: #369;</div><div class="line">  font-family: Arial, Helvetica, sans-serif;</div><div class="line">  font-size: 250%;</div><div class="line">&#125;</div><div class="line">h2, h3 &#123;</div><div class="line">  color: #444;</div><div class="line">  font-family: Arial, Helvetica, sans-serif;</div><div class="line">  font-weight: lighter;</div><div class="line">&#125;</div><div class="line">body &#123;</div><div class="line">  margin: 2em;</div><div class="line">&#125;</div><div class="line">body, input[text], button &#123;</div><div class="line">  color: #888;</div><div class="line">  font-family: Cambria, Georgia;</div><div class="line">&#125;</div><div class="line">/* . . . */</div><div class="line">/* everywhere else */</div><div class="line">* &#123;</div><div class="line">  font-family: Arial, Helvetica, sans-serif;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果在根目录下没有一个名叫styles.css的文件，就添加它。 确保它包含这里给出的主样式。 并编辑index.html来引用这个样式表。</p>
<p>src/index.html (link ref)</p>
<pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;styles.css&quot;&gt;
</code></pre><blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/05/18/AngularJS4" target="_blank" rel="external">AngularJS之英雄联盟服务</a>.<br>  下一篇：<a href="http://localhost:4000/2017/05/18/AngularJS6" target="_blank" rel="external">AngularJS之英雄联盟HTTP</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AngularJS之英雄联盟服务]]></title>
      <url>/2017/05/18/AngularJS4/</url>
      <content type="html"><![CDATA[<h3 id="创建-HeroService"><a href="#创建-HeroService" class="headerlink" title="创建 HeroService"></a>创建 HeroService</h3><p>在app目录下创建一个名叫hero.service.ts的文件。</p>
<blockquote>
<p>我们遵循的文件命名约定是：服务名称的小写形式（基本名），加上.service后缀。 如果服务名称包含多个单词，我们就把基本名部分写成中线形式 (dash-case)。 例如，SpecialSuperHeroService服务应该被定义在special-super-hero.service.ts文件中。</p>
</blockquote>
<p>我们把这个类命名为HeroService，并导出它，以供别人使用。</p>
<pre><code>import { Injectable } from &apos;@angular/core&apos;;

@Injectable()
export class HeroService {
}
</code></pre><p>可注入的服务</p>
<p>注意，我们导入了 Angular 的Injectable函数，并作为@Injectable()装饰器使用这个函数。  </p>
<pre><code>不要忘了写圆括号！如果忘了写，就会导致一个很难诊断的错误。
</code></pre><p>当 TypeScript 看到@Injectable()装饰器时，就会记下本服务的元数据。 如果 Angular 需要往这个服务中注入其它依赖，就会使用这些元数据。</p>
<p>虽然此时HeroService还没有任何依赖，但我们还是得加上这个装饰器。 作为一项最佳实践，无论是出于提高统一性还是减少变更的目的， 都应该从一开始就加上@Injectable()装饰器。</p>
<h3 id="获取英雄数据"><a href="#获取英雄数据" class="headerlink" title="获取英雄数据"></a>获取英雄数据</h3><p>添加一个名叫getHeros的桩方法。</p>
<pre><code>@Injectable()
export class HeroService {
  getHeroes(): void {} // stub
}
</code></pre><p>HeroService可以从任何地方获取Hero数据 —— Web服务、本地存储或模拟数据源。 从组件中移除数据访问逻辑意味着你可以随时更改这些实现方式，而不影响需要这些英雄数据的组件。</p>
<h3 id="移动模拟的英雄数据"><a href="#移动模拟的英雄数据" class="headerlink" title="移动模拟的英雄数据"></a>移动模拟的英雄数据</h3><p>从app.component.ts文件中剪切HEROS数组，把它粘贴到app目录下一个名叫mock-heroes.ts的文件中。 还要复制import {Hero}…语句，因为我们的英雄数组用到了Hero类。</p>
<pre><code>import { Hero } from &apos;./hero&apos;;
export const HEROES: Hero[] = [
  {id: 11, name: &apos;Mr. Nice&apos;},
  {id: 12, name: &apos;Narco&apos;},
  {id: 13, name: &apos;Bombasto&apos;},
  {id: 14, name: &apos;Celeritas&apos;},
  {id: 15, name: &apos;Magneta&apos;},
  {id: 16, name: &apos;RubberMan&apos;},
  {id: 17, name: &apos;Dynama&apos;},
  {id: 18, name: &apos;Dr IQ&apos;},
  {id: 19, name: &apos;Magma&apos;},
  {id: 20, name: &apos;Tornado&apos;}
];
</code></pre><p>我们导出了HEROES常量，以便可以在其它地方导入它 — 例如HeroService服务。</p>
<p>在刚刚剪切出HEROES数组的app.component.ts文件中，添加一个尚未初始化的heroes属性：</p>
<pre><code>heroes: Hero[];
</code></pre><h3 id="返回模拟的英雄数据getHeroes"><a href="#返回模拟的英雄数据getHeroes" class="headerlink" title="返回模拟的英雄数据getHeroes()"></a>返回模拟的英雄数据getHeroes()</h3><p>回到HeroService，我们导入HEROES常量，并在getHeroes方法中返回它。 我们的HeroService服务现在是这样的：</p>
<pre><code>import { Injectable } from &apos;@angular/core&apos;;
import { Hero } from &apos;./hero&apos;;
import { HEROES } from &apos;./mock-heroes&apos;;
@Injectable()
export class HeroService {
  getHeroes(): Hero[] {
    return HEROES;
  }
}
</code></pre><h3 id="导入HeroService"><a href="#导入HeroService" class="headerlink" title="导入HeroService"></a>导入HeroService</h3><p>我们可以在多个组件中使用 HeroService 服务了，先从 AppComponent 开始。</p>
<p>先导入HeroService，以便我们可以在代码中引用它。</p>
<pre><code>import { HeroService } from &apos;./hero.service&apos;;
</code></pre><p>不要new出HeroService</p>
<p>该如何在运行中获得一个具体的HeroService实例呢？</p>
<p>你可能想用new来创建HeroService的实例，就像这样：</p>
<pre><code>heroService = new HeroService(); // don&apos;t do this
</code></pre><p>但这不是个好主意，有很多理由，例如：</p>
<p>我们的组件得弄清楚该如何创建HeroService。 如果有一天我们修改了HeroService的构造函数，我们不得不找出创建过此服务的每一处代码，并修改它。 围着补丁代码转圈很容易导致错误，还会增加测试负担。</p>
<p>我们每次使用new都会创建一个新的服务实例。 如果这个服务需要缓存英雄列表，并把这个缓存共享给别人呢？怎么办？ 没办法，做不到。</p>
<p>我们把AppComponent锁定到HeroService的一个特定实现。 我们很难在不同的场景中切换实现。 例如，能离线操作吗？能在测试时使用不同的模拟版本吗？这可不容易。</p>
<h3 id="注入-HeroService"><a href="#注入-HeroService" class="headerlink" title="注入 HeroService"></a>注入 HeroService</h3><p>你可以用两行代码代替用new时的一行：</p>
<ol>
<li>添加一个构造函数，并定义一个私有属性。</li>
<li>添加组件的providers元数据。</li>
</ol>
<p>添加构造函数：</p>
<pre><code>constructor(private heroService: HeroService) { }
</code></pre><p>构造函数自己什么也不用做，它在参数中定义了一个私有的heroService属性，并把它标记为注入HeroService的靶点。</p>
<p>现在，当创建AppComponent实例时，Angular 知道需要先提供一个HeroService的实例。</p>
<p>注入器还不知道该如何创建HeroService。 如果现在运行我们的代码，Angular 就会失败，并报错：</p>
<pre><code>EXCEPTION: No provider for HeroService! (AppComponent -&gt; HeroService)
(异常：没有 HeroService 的提供商！(AppComponent -&gt; HeroService))
</code></pre><p>我们还得注册一个HeroService提供商，来告诉注入器如何创建HeroService。 要做到这一点，我们在@Component组件的元数据底部添加providers数组属性如下：</p>
<pre><code>providers: [HeroService]
</code></pre><p>providers数组告诉 Angular，当它创建新的AppComponent组件时，也要创建一个HeroService的新实例。 AppComponent会使用那个服务来获取英雄列表，在它组件树中的每一个子组件也同样如此。</p>
<h3 id="AppComponent-中的-getHeroes"><a href="#AppComponent-中的-getHeroes" class="headerlink" title="AppComponent 中的 getHeroes()"></a>AppComponent 中的 getHeroes()</h3><p>该服务被存入了一个私有变量heroService中。</p>
<p>我们可以在同一行内调用此服务，并获得数据。</p>
<pre><code>getHeroes(): void {
  this.heroes = this.heroService.getHeroes();
}
</code></pre><h3 id="ngOnInit-生命周期钩子"><a href="#ngOnInit-生命周期钩子" class="headerlink" title="ngOnInit 生命周期钩子"></a>ngOnInit 生命周期钩子</h3><p>毫无疑问，AppComponent应该获取英雄数据并显示它。</p>
<p>你可能想在构造函数中调用getHeroes()方法，但构造函数不应该包含复杂的逻辑，特别是那些需要从服务器获取数据的逻辑更是如此。构造函数是为了简单的初始化工作而设计的，例如把构造函数的参数赋值给属性。</p>
<p>只要我们实现了 Angular 的 ngOnInit 生命周期钩子，Angular 就会主动调用这个钩子。 Angular提供了一些接口，用来介入组件生命周期的几个关键时间点：刚创建时、每次变化时，以及最终被销毁时。</p>
<p>每个接口都有唯一的一个方法。只要组件实现了这个方法，Angular 就会在合适的时机调用它。</p>
<p>这是OnInit接口的基本轮廓（但不要拷贝到你自己的代码中）：</p>
<pre><code>import { OnInit } from &apos;@angular/core&apos;;

export class AppComponent implements OnInit {
    ngOnInit(): void {
    }
}
</code></pre><p>往export语句中添加OnInit接口的实现：</p>
<pre><code>export class AppComponent implements OnInit {}
</code></pre><p>我们写了一个带有初始化逻辑的ngOnInit方法，Angular会在适当的时候调用它。 在这个例子中，我们通过调用getHeroes()来完成初始化。      </p>
<pre><code>ngOnInit(): void {
    this.getHeroes();
}
</code></pre><p>我们的应用将会像期望的那样运行，显示英雄列表，并且在我们点击英雄的名字时，显示英雄的详情。</p>
<h3 id="异步服务与承诺"><a href="#异步服务与承诺" class="headerlink" title="异步服务与承诺"></a>异步服务与承诺</h3><p>我们的HeroService立即返回一个模拟的英雄列表，它的getHeroes()函数签名是同步的。</p>
<pre><code>this.heroes = this.heroService.getHeroes();
</code></pre><p>但最终，英雄的数据会从远端服务器获取。当使用远端服务器时，用户不会等待服务器的响应。换句话说，你没法在等待期间阻塞浏览器界面。</p>
<p>为了协调视图与响应，我们可以使用承诺（Promise），它是一种异步技术，它会改变getHeroes()方法的签名。    </p>
<p>HeroService会生成一个承诺<br>承诺 就是 …… 好吧，它就是一个承诺，在有了结果时，它承诺会回调我们。 我们请求一个异步服务去做点什么，并且给它一个回调函数。 它会去做（在某个地方），一旦完成，它就会调用我们的回调函数，并通过参数把工作结果或者错误信息传给我们。</p>
<p>把HeroService的getHeroes方法改写为返回承诺的形式：</p>
<pre><code>getHeroes(): Promise&lt;Hero[]&gt; {
  return Promise.resolve(HEROES);
}
</code></pre><p>我们继续使用模拟数据。我们通过返回一个 立即解决的承诺 的方式，模拟了一个超快、零延迟的超级服务器。</p>
<p>基于承诺的行动</p>
<p>修改HeroService之后，this.heroes会被赋值为一个Promise而不再是英雄数组。src/app/app.component.ts</p>
<pre><code>getHeroes(): void {
  this.heroes = this.heroService.getHeroes();
}
</code></pre><p>我们得修改这个实现，把它变成基于承诺的，并在承诺的事情被解决时再行动。 一旦承诺的事情被成功解决（Resolve），我们就会显示英雄数据。</p>
<p>我们把回调函数作为参数传给承诺对象的then方法：</p>
<pre><code>getHeroes(): void {
  this.heroService.getHeroes().then(heroes =&gt; this.heroes = heroes);
}
</code></pre><blockquote>
<p>这里的箭头函数是一个匿名函数function(heroes){<br>    return: this.heroes = heroes<br>  }这里的function(heroes)中的heroes是英雄服务里getHeroes()的返回值。</p>
</blockquote>
<p>下面是本章讨论过的代码文件：</p>
<p>hero.service.ts</p>
<pre><code>import { Injectable } from &apos;@angular/core&apos;;
import { Hero } from &apos;./hero&apos;;
import { HEROES } from &apos;./mock-heroes&apos;;
@Injectable()
export class HeroService {
  getHeroes(): Promise&lt;Hero[]&gt; {
    return Promise.resolve(HEROES);
  }
}
</code></pre><p>app.component.ts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">import &#123; Component, OnInit &#125; from &apos;@angular/core&apos;;</div><div class="line">import &#123; Hero &#125; from &apos;./hero&apos;;</div><div class="line">import &#123; HeroService &#125; from &apos;./hero.service&apos;;</div><div class="line">@Component(&#123;</div><div class="line">  selector: &apos;my-app&apos;,</div><div class="line">  template: `</div><div class="line">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">    &lt;h2&gt;My Heroes&lt;/h2&gt;</div><div class="line">    &lt;ul class=&quot;heroes&quot;&gt;</div><div class="line">      &lt;li *ngFor=&quot;let hero of heroes&quot;</div><div class="line">        [class.selected]=&quot;hero === selectedHero&quot;</div><div class="line">        (click)=&quot;onSelect(hero)&quot;&gt;</div><div class="line">        &lt;span class=&quot;badge&quot;&gt;&#123;&#123;hero.id&#125;&#125;&lt;/span&gt; &#123;&#123;hero.name&#125;&#125;</div><div class="line">      &lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">    &lt;hero-detail [hero]=&quot;selectedHero&quot;&gt;&lt;/hero-detail&gt;</div><div class="line">  `,</div><div class="line">  providers: [HeroService]</div><div class="line">&#125;)</div><div class="line">export class AppComponent implements OnInit &#123;</div><div class="line">  title = &apos;Tour of Heroes&apos;;</div><div class="line">  heroes: Hero[];</div><div class="line">  selectedHero: Hero;</div><div class="line">  constructor(private heroService: HeroService) &#123; &#125;</div><div class="line">  getHeroes(): void &#123;</div><div class="line">    this.heroService.getHeroes().then(heroes =&gt; this.heroes = heroes);</div><div class="line">  &#125;</div><div class="line">  ngOnInit(): void &#123;</div><div class="line">    this.getHeroes();</div><div class="line">  &#125;</div><div class="line">  onSelect(hero: Hero): void &#123;</div><div class="line">    this.selectedHero = hero;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>mock-heroes.ts</p>
<pre><code>import { Hero } from &apos;./hero&apos;;
export const HEROES: Hero[] = [
  {id: 11, name: &apos;Mr. Nice&apos;},
  {id: 12, name: &apos;Narco&apos;},
  {id: 13, name: &apos;Bombasto&apos;},
  {id: 14, name: &apos;Celeritas&apos;},
  {id: 15, name: &apos;Magneta&apos;},
  {id: 16, name: &apos;RubberMan&apos;},
  {id: 17, name: &apos;Dynama&apos;},
  {id: 18, name: &apos;Dr IQ&apos;},
  {id: 19, name: &apos;Magma&apos;},
  {id: 20, name: &apos;Tornado&apos;}
];
</code></pre><blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/05/18/AngularJS3" target="_blank" rel="external">AngularJS之英雄联盟多个组件</a>.<br>  下一篇：<a href="http://localhost:4000/2017/05/18/AngularJS5" target="_blank" rel="external">AngularJS之英雄联盟路由</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AngularJS之英雄联盟多个组件]]></title>
      <url>/2017/05/18/AngularJS3/</url>
      <content type="html"><![CDATA[<h3 id="制作英雄详情组件"><a href="#制作英雄详情组件" class="headerlink" title="制作英雄详情组件"></a>制作英雄详情组件</h3><p>往app/文件夹下添加一个名叫hero-detail.component.ts的文件。这个文件中会存放这个新的HeroDetailComponent。</p>
<ol>
<li>组件的类名应该是大驼峰形式，并且以Component结尾。 因此英雄详情组件的类名是HeroDetailComponent。</li>
<li>组件的文件名应该是小写中线形式，每个单词之间用中线分隔，并且以.component.ts结尾。 因此HeroDetailComponent类应该放在hero-detail.component.ts文件中。</li>
</ol>
<p>HeroDetailComponent的代码如下：</p>
<pre><code>import { Component } from &apos;@angular/core&apos;;

@Component({
selector: &apos;hero-detail&apos;,
})
export class HeroDetailComponent {
}
</code></pre><p>要定义一个组件，我们总是要先导入符号Component。</p>
<p>@Component装饰器为组件提供了Angular元数据。 CSS选择器的名字hero-detail会匹配元素的标签名，用于在父组件的模板中标记出当前组件的位置。 本章的最后，我们会把<hero-detail>添加到AppComponent的模板中。</hero-detail></p>
<p>总是export这个组件类，因为你必然会在别处import它。</p>
<h3 id="英雄详情的模板"><a href="#英雄详情的模板" class="headerlink" title="英雄详情的模板"></a>英雄详情的模板</h3><p>要把英雄详情的视图移入HeroDetailComponent，只要把英雄详情的 内容 从AppComponent模板的底部剪切出来， 粘贴到@Component元数据的template属性中就可以了。</p>
<p>HeroDetailComponent有一个 hero属性，而不再是selectedHero。 所以我们也要在模板中把所有的selectedHero替换为hero。 这些完成之后，新的模板是这样的：</p>
<pre><code>@Component({
  selector: &apos;hero-detail&apos;,
  template: `
    &lt;div * ngIf=&quot;hero&quot;&gt;
      &lt;h2&gt;{{hero.name}} details!&lt;/h2&gt;
      &lt;div&gt;&lt;label&gt;id: &lt;/label&gt;{{hero.id}}&lt;/div&gt;
      &lt;div&gt;
        &lt;label&gt;name: &lt;/label&gt;
        &lt;input [(ngModel)]=&quot;hero.name&quot; placeholder=&quot;name&quot;/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  `
})
</code></pre><h3 id="添加hero属性"><a href="#添加hero属性" class="headerlink" title="添加hero属性"></a>添加hero属性</h3><p>HeroDetailComponent模板绑定到了该组件的hero属性上。 把这个属性添加到HeroDetailComponent类上，就像这样：</p>
<pre><code>hero: Hero;
</code></pre><p>hero属性的类型是Hero。 Hero类仍然在app.component.ts文件中。 现在，有两个组件需要Hero类的引用。 而Angular风格指南建议每个文件中只有一个类。</p>
<p>因此我们要把Hero类从app.component.ts移到它自己的hero.ts文件中：</p>
<pre><code>src/app/hero.ts

export class Hero {
  id: number;
  name: string;
}
</code></pre><p>现在，Hero类有了自己的文件，AppComponent 和 HeroDetailComponent 就要import它了。 把下列import语句添加到app.component.ts和hero-detail.component.ts文件的顶部。</p>
<pre><code>import { Hero } from &apos;./hero&apos;;
</code></pre><p>hero属性是一个输入属性<br>父组件AppComponent会告诉子组件HeroDetailComponent要显示哪个英雄， 告诉的方法是把它的selectedHero属性绑定到HeroDetailComponent的hero属性上。 这种绑定是这样的：</p>
<pre><code>&lt;hero-detail [hero]=&quot;selectedHero&quot;&gt;&lt;/hero-detail&gt;
</code></pre><p>在等号的左边，是方括号围绕的hero属性，这表示它是属性绑定表达式的目标。 我们要绑定到的目标属性必须是一个输入属性，否则Angular会拒绝绑定，并抛出一个错误。</p>
<p>首先，修改@angular/core导入语句，使其包含符号Input。</p>
<pre><code>import { Component, Input } from &apos;@angular/core&apos;;
</code></pre><p>然后，通过在hero属性前面加上@Input装饰器，来表明它是一个输入属性。</p>
<pre><code>@Input() hero: Hero;
</code></pre><p>现在，hero属性是HeroDetailComponent类中唯一的东西。</p>
<pre><code>export class HeroDetailComponent {
@Input() hero: Hero;
}
</code></pre><p>它所做的一切就是通过它的输入属性hero接收一个英雄对象，然后把这个属性绑定到自己的模板中。</p>
<p>下面是完整的HeroDetailComponent：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component, Input &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; Hero &#125; <span class="keyword">from</span> <span class="string">'./hero'</span>;</div><div class="line">@Component(&#123;</div><div class="line">  <span class="attr">selector</span>: <span class="string">'hero-detail'</span>,</div><div class="line">  <span class="attr">template</span>: <span class="string">`</span></div><div class="line">    &lt;div *ngIf="hero"&gt;</div><div class="line">      &lt;h2&gt;&#123;&#123;hero.name&#125;&#125; details!&lt;/h2&gt;</div><div class="line">      &lt;div&gt;&lt;label&gt;id: &lt;/label&gt;&#123;&#123;hero.id&#125;&#125;&lt;/div&gt;</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;label&gt;name: &lt;/label&gt;</div><div class="line">        &lt;input [(ngModel)]="hero.name" placeholder="name"/&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  `</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroDetailComponent</span> </span>&#123;</div><div class="line">  @Input() hero: Hero;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="在AppModule中声明HeroDetailComponent"><a href="#在AppModule中声明HeroDetailComponent" class="headerlink" title="在AppModule中声明HeroDetailComponent"></a>在AppModule中声明HeroDetailComponent</h3><p>每个组件都必须在一个（且只有一个）Angular模块中声明。</p>
<p>打开app.module.ts并且导入HeroDetailComponent，以便我们可以引用它。</p>
<pre><code>import { HeroDetailComponent } from &apos;./hero-detail.component&apos;;
</code></pre><p>把HeroDetailComponent添加到该模块的declarations(声明)数组中。</p>
<pre><code>declarations: [
AppComponent,
HeroDetailComponent
],
</code></pre><p>通常，declarations数组包含应用中属于该模块的组件、管道和指令的列表。 组件在被其它组件引用之前必须先在一个模块中声明过。 这个模块只声明了两个组件：AppComponent 和 HeroDetailComponent。</p>
<h3 id="把HeroDetailComponent添加到AppComponent中"><a href="#把HeroDetailComponent添加到AppComponent中" class="headerlink" title="把HeroDetailComponent添加到AppComponent中"></a>把HeroDetailComponent添加到AppComponent中</h3><p>AppComponent仍然是主从视图。 在我们剪切模板之前，它自己显示英雄的详情。 现在，它委托给了HeroDetailComponent。</p>
<p>回想一下，hero-detail正是HeroDetailComponent元数据中使用的 CSS selector 它是一个HTML元素的标签名，用于表示HeroDetailComponent。</p>
<p>把<hero-detail>元素添加到AppComponent模板的底部，那里就是英雄详情视图所在的位置。</hero-detail></p>
<p>协调主视图AppComponent与HeroDetailComponent的方式是把AppComponent的selectedHero属性绑定到HeroDetailComponent的hero属性上。</p>
<pre><code>&lt;hero-detail [hero]=&quot;selectedHero&quot;&gt;&lt;/hero-detail&gt;
</code></pre><p>每当selectedHero变化时，HeroDetailComponent就会显示一个新的英雄。</p>
<p>修改后的AppComponent模板是这样的：    </p>
<pre><code>template: `
&lt;h1&gt;{{title}}&lt;/h1&gt;
&lt;h2&gt;My Heroes&lt;/h2&gt;
&lt;ul class=&quot;heroes&quot;&gt;
&lt;li * ngFor=&quot;let hero of heroes&quot;
  [class.selected]=&quot;hero === selectedHero&quot;
  (click)=&quot;onSelect(hero)&quot;&gt;
  &lt;span class=&quot;badge&quot;&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
&lt;/li&gt;
&lt;/ul&gt;
&lt;hero-detail [hero]=&quot;selectedHero&quot;&gt;&lt;/hero-detail&gt;
`，
</code></pre><blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/05/18/AngularJS2" target="_blank" rel="external">AngularJS之英雄联盟主从结构</a>.<br>下一篇：<a href="http://localhost:4000/2017/05/18/AngularJS4" target="_blank" rel="external">AngularJS之英雄联盟服务</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AngularJS之英雄联盟主从结构]]></title>
      <url>/2017/05/18/AngularJS2/</url>
      <content type="html"><![CDATA[<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><blockquote>
<p>找到相应的文件：  ng serve -o</p>
</blockquote>
<h3 id="创建英雄"><a href="#创建英雄" class="headerlink" title="创建英雄"></a>创建英雄</h3><blockquote>
<p>注意：以下里面所写的反引号都应该是一个，这里是为了在md文档里展示代码好看。</p>
</blockquote>
<p>先在src/app/app.component.ts里创建一个Hero类，并导出类。</p>
<pre><code>export class Hero {
  id: number;
  name: string;
}
</code></pre><p>再在src/app/app.component.ts视图模板创建一个由十位英雄组成的数组。</p>
<blockquote>
<p>定义了一个HEROES常量，值是Hero[]数组对象。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> HEROES: Hero[] = [</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">11</span>, <span class="attr">name</span>: <span class="string">'Mr. Nice'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">12</span>, <span class="attr">name</span>: <span class="string">'Narco'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">13</span>, <span class="attr">name</span>: <span class="string">'Bombasto'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">14</span>, <span class="attr">name</span>: <span class="string">'Celeritas'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">15</span>, <span class="attr">name</span>: <span class="string">'Magneta'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">16</span>, <span class="attr">name</span>: <span class="string">'RubberMan'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">17</span>, <span class="attr">name</span>: <span class="string">'Dynama'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">18</span>, <span class="attr">name</span>: <span class="string">'Dr IQ'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">19</span>, <span class="attr">name</span>: <span class="string">'Magma'</span> &#125;,</div><div class="line">  &#123; <span class="attr">id</span>: <span class="number">20</span>, <span class="attr">name</span>: <span class="string">'Tornado'</span> &#125;</div><div class="line">];</div></pre></td></tr></table></figure>
<blockquote>
<p>HEROES是一个由Hero类的实例构成的数组，我们在第一部分定义过它。 我们当然希望从一个 Web 服务中获取这个英雄列表，但别急，我们得把步子迈得小一点，先用一组模拟出来的英雄。</p>
</blockquote>
<h3 id="暴露英雄"><a href="#暴露英雄" class="headerlink" title="暴露英雄"></a>暴露英雄</h3><p>我们在AppComponent上创建一个公共属性，用来暴露这些英雄，以供绑定。</p>
<pre><code>heroes = HEROES;
</code></pre><p>我们并不需要明确定义heroes属性的数据类型，TypeScript 能从HEROES数组中推断出来。</p>
<blockquote>
<p>英雄的数据从实现类中分离了出来，因为最终，英雄的名字会来自一个数据服务。</p>
</blockquote>
<h3 id="在模板中显示英雄"><a href="#在模板中显示英雄" class="headerlink" title="在模板中显示英雄"></a>在模板中显示英雄</h3><p>我们还要在模板中创建一个无序列表来显示这些英雄的名字。 那就在标题和英雄详情之间，插入下面这段 HTML 代码。</p>
<pre><code>&lt;ul class=&quot;heroes&quot;&gt;
  &lt;li&gt;
  &lt;!-- each hero goes here --&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>现在，我们有了一个模板。接下来，就用英雄们的数据来填充它。</p>
<h3 id="通过-ngFor-来显示英雄列表"><a href="#通过-ngFor-来显示英雄列表" class="headerlink" title="通过 ngFor 来显示英雄列表"></a>通过 ngFor 来显示英雄列表</h3><p>我们想要把组件中的heroes数组绑定到模板中，迭代并逐个显示它们。首先，修改<li>标签，往上添加内置指令*ngFor。</li></p>
<pre><code>&lt;li * ngFor=&quot;let hero of heroes&quot;&gt;
</code></pre><blockquote>
<p>ngFor的* 前缀表示<code>&lt;li&gt;</code>及其子元素组成了一个主控模板。ngFor指令在AppComponent.heroes属性返回的heroes数组上迭代，并输出此模板的实例。<br>  引号中赋值给ngFor的那段文本表示“从heroes数组中取出每个英雄，存入一个局部的hero变量，并让它在相应的模板实例中可用”。</p>
<p>注意：* 号没有空格，这里是md格式</p>
</blockquote>
<p>接着，我们在<code>&lt;li&gt;</code>标签中插入一些内容，以便使用模板变量hero来显示英雄的属性。</p>
<pre><code>&lt;li * ngFor=&quot;let hero of heroes&quot;&gt;
&lt;span class=&quot;badge&quot;&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
&lt;/li&gt;
</code></pre><p>当浏览器刷新时，我们就看到了英雄列表。</p>
<h3 id="给我们的英雄们“美容”"><a href="#给我们的英雄们“美容”" class="headerlink" title="给我们的英雄们“美容”"></a>给我们的英雄们“美容”</h3><p>要想给我们的组件添加一些样式，请把@Component装饰器的styles属性设置为下列 CSS 类：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">styles: [``</div><div class="line">.selected &#123;</div><div class="line">background-color: #CFD8DC !important;</div><div class="line">color: white;</div><div class="line">&#125;</div><div class="line">.heroes &#123;</div><div class="line">margin: 0 0 2em 0;</div><div class="line">list-style-type: none;</div><div class="line">padding: 0;</div><div class="line">width: 15em;</div><div class="line">&#125;</div><div class="line">.heroes li &#123;</div><div class="line">cursor: pointer;</div><div class="line">position: relative;</div><div class="line">left: 0;</div><div class="line">background-color: #EEE;</div><div class="line">margin: .5em;</div><div class="line">padding: .3em 0;</div><div class="line">height: 1.6em;</div><div class="line">border-radius: 4px;</div><div class="line">&#125;</div><div class="line">.heroes li.selected:hover &#123;</div><div class="line">background-color: #BBD8DC !important;</div><div class="line">color: white;</div><div class="line">&#125;</div><div class="line">.heroes li:hover &#123;</div><div class="line">color: #607D8B;</div><div class="line">background-color: #DDD;</div><div class="line">left: .1em;</div><div class="line">&#125;</div><div class="line">.heroes .text &#123;</div><div class="line">position: relative;</div><div class="line">top: -3px;</div><div class="line">&#125;</div><div class="line">.heroes .badge &#123;</div><div class="line">display: inline-block;</div><div class="line">font-size: small;</div><div class="line">color: white;</div><div class="line">padding: 0.8em 0.7em 0 0.7em;</div><div class="line">background-color: #607D8B;</div><div class="line">line-height: 1em;</div><div class="line">position: relative;</div><div class="line">left: -1px;</div><div class="line">top: -4px;</div><div class="line">height: 1.8em;</div><div class="line">margin-right: .8em;</div><div class="line">border-radius: 4px 0 0 4px;</div><div class="line">&#125;</div><div class="line">``]</div></pre></td></tr></table></figure></p>
<p>注意，我们又使用了反引号语法来书写多行字符串。</p>
<p>添加这些样式会让此文件变得更长。在后面的章节中，我们将会把这些样式移到单独的文件中去</p>
<p>当我们为一个组件指定样式时，它们的作用域将仅限于该组件。 上面的例子中，这些样式只会作用于AppComponent组件，而不会“泄露”到外部 HTML 中。</p>
<p>用于显示英雄们的模板应该是这样的：</p>
<pre><code>&lt;h2&gt;My Heroes&lt;/h2&gt;
&lt;ul class=&quot;heroes&quot;&gt;
  &lt;li * ngFor=&quot;let hero of heroes&quot;&gt;
    &lt;span class=&quot;badge&quot;&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
  &lt;/li&gt;
&lt;/ul&gt;
</code></pre><h3 id="选择英雄"><a href="#选择英雄" class="headerlink" title="选择英雄"></a>选择英雄</h3><p>我们的应用已经有了英雄列表和单个英雄的详情视图。 但列表和单独的英雄之间还没有任何关联。 我们希望用户在列表中选中一个英雄，然后让这个被选中的英雄出现在详情视图中。 这种 UI 布局模式，通常被称为“主从结构”。 在这个例子中，主视图是英雄列表，从视图则是被选中的英雄。</p>
<p>接下来，我们要通过组件中的一个selectedHero属性来连接主从视图，它被绑定到了点击事件上</p>
<h3 id="处理点击事件"><a href="#处理点击事件" class="headerlink" title="处理点击事件"></a>处理点击事件</h3><p>我们再往<li>元素上插入一句点击事件的绑定代码：</li></p>
<pre><code>&lt;li * ngFor=&quot;let hero of heroes&quot; (click)=&quot;onSelect(hero)&quot;&gt;
  ...
&lt;/li&gt;
</code></pre><p>圆括号标识<li>元素上的click事件是绑定的目标。 等号右边的onSelect(hero)表达式调用AppComponent的onSelect()方法，并把模板输入变量hero作为参数传进去。 它是我们前面在ngFor指令中定义的那个hero变量。</li></p>
<h3 id="添加点击处理器以暴露选中的英雄"><a href="#添加点击处理器以暴露选中的英雄" class="headerlink" title="添加点击处理器以暴露选中的英雄"></a>添加点击处理器以暴露选中的英雄</h3><p>我们不再需要AppComponent的hero属性，因为不需要再显示单个的英雄，我们只需要显示英雄列表。但是用户可以点选一个英雄。 所以我们要把hero属性替换成selectedHero属性。</p>
<pre><code>selectedHero: Hero;
</code></pre><p>在用户选取一个英雄之前，所有的英雄名字都应该是未选中的。所以我们不希望像hero一样初始化selectedHero变量。</p>
<p>现在，添加一个onSelect方法，用于将用户点击的英雄赋给selectedHero属性。</p>
<pre><code>onSelect(hero: Hero): void {
  this.selectedHero = hero;
}
</code></pre><p>我们将把所选英雄的详细信息显示在模板中。目前，它仍然引用之前的hero属性。 我们这就修改模板，让它绑定到新的selectedHero属性。</p>
<pre><code>&lt;h2&gt;{{selectedHero.name}} details!&lt;/h2&gt;
&lt;div&gt;&lt;label&gt;id: &lt;/label&gt;{{selectedHero.id}}&lt;/div&gt;
&lt;div&gt;
&lt;label&gt;name: &lt;/label&gt;
&lt;input [(ngModel)]=&quot;selectedHero.name&quot; placeholder=&quot;name&quot;/&gt;
&lt;/div&gt;
</code></pre><blockquote>
<p>注意：这里的input是输入属性，当用户输入时，这个输入框应该能同时显示和修改英雄的name属性。<br>       也就是说，我们要在表单元素input和组件的hero.name属性之间建立双向绑定。</p>
</blockquote>
<h3 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h3><pre><code>&lt;div&gt;
  &lt;label&gt;name: &lt;/label&gt;
  &lt;input [(ngModel)]=&quot;hero.name&quot; placeholder=&quot;name&quot;&gt;
&lt;/div&gt;
</code></pre><p>[(ngModel)]是一个Angular语法，用与把hero.name绑定到输入框中。 它的数据流是双向的：从属性到输入框，并且从输入框回到属性。</p>
<p>不幸的是，做了这项改动之后，我们的程序崩溃了。 打开浏览器的控制台，我们会看到Angular抱怨说：“ngModel … isn’t a known property of input.”（ngModel不是input元素的已知属性）</p>
<p>虽然NgModel是一个有效的Angular指令，但它默认情况下却是不可用的。 它属于一个可选模块FormsModule。 我们必须选择使用那个模块。</p>
<h3 id="导入-FormsModule"><a href="#导入-FormsModule" class="headerlink" title="导入 FormsModule"></a>导入 FormsModule</h3><p>打开app.module.ts文件，并且从@angular/forms库中导入符号FormsModule。 然后把FormsModule添加到@NgModule元数据的imports数组中，它是当前应用正在使用的外部模块列表。</p>
<p>修改后的AppModule是这样的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; NgModule &#125;      <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</div><div class="line"><span class="keyword">import</span> &#123; FormsModule &#125;   <span class="keyword">from</span> <span class="string">'@angular/forms'</span>; <span class="comment">// &lt;-- NgModel lives here</span></div><div class="line"><span class="keyword">import</span> &#123; AppComponent &#125;  <span class="keyword">from</span> <span class="string">'./app.component'</span>;</div><div class="line">@NgModule(&#123;</div><div class="line">  <span class="attr">imports</span>: [</div><div class="line">    BrowserModule,</div><div class="line">    FormsModule <span class="comment">// &lt;-- import the FormsModule before binding with [(ngModel)]</span></div><div class="line">  ],</div><div class="line">  <span class="attr">declarations</span>: [</div><div class="line">    AppComponent</div><div class="line">  ],</div><div class="line">  <span class="attr">bootstrap</span>: [ AppComponent ]</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<h3 id="使用-ngIf-隐藏空的详情"><a href="#使用-ngIf-隐藏空的详情" class="headerlink" title="使用 ngIf 隐藏空的详情"></a>使用 ngIf 隐藏空的详情</h3><p>当应用加载时，我们会看到一个英雄列表，但还没有任何英雄被选中。 selectedHero属性是undefined。 因此，我们会看到浏览器控制台中出现下列错误：</p>
<pre><code>EXCEPTION: TypeError: Cannot read property &apos;name&apos; of undefined in [null]
</code></pre><p>虽然我们要在模板中显示的是selectedHero.name，但在选中了一个英雄之前，我们必须让这些英雄详情留在DOM之外。</p>
<p>我们可以把模板中的英雄详情内容区放在一个<div>中。 然后，添加一个ngIf内置指令，把ngIf的值设置为组件的selectedHero属性。</div></p>
<pre><code>&lt;div * ngIf=&quot;selectedHero&quot;&gt;
&lt;h2&gt;{{selectedHero.name}} details!&lt;/h2&gt;
&lt;div&gt;&lt;label&gt;id: &lt;/label&gt;{{selectedHero.id}}&lt;/div&gt;
&lt;div&gt;
&lt;label&gt;name: &lt;/label&gt;
&lt;input [(ngModel)]=&quot;selectedHero.name&quot; placeholder=&quot;name&quot;/&gt;
&lt;/div&gt;
&lt;/div&gt;
</code></pre><blockquote>
<p>注意:别忘了ngIf前的星号 (* )。</p>
</blockquote>
<p>应用不再出错，而名字列表也再次显示在浏览器中。</p>
<p>当没有选中英雄时，ngIf指令会从 DOM 中移除表示英雄详情的这段 HTML 。 没有了表示英雄详情的元素，也就不用担心绑定问题。</p>
<p>当用户选取了一个英雄，selectedHero变成了“已定义的”值，于是ngIf把英雄详情加回 DOM 中，并计算它所嵌套的各种绑定。</p>
<h3 id="给所选英雄添加样式"><a href="#给所选英雄添加样式" class="headerlink" title="给所选英雄添加样式"></a>给所选英雄添加样式</h3><p>我们在下面的详情区看到了选中的英雄，但是我们还是没法在上面的列表区快速定位这位英雄。</p>
<p>在我们前面添加的styles元数据中，有一个名叫selected的自定义CSS类。 要想让选中的英雄更加醒目，当用户点击一个英雄名字时，我们要为<li>添加selected类。 例如，当用户点击“Magneta”时，它应该使用不一样的醒目的背景色。<br><img src="http://i2.muimg.com/588926/7b65d24067c441e5.png" alt=""></li></p>
<p>在这个模板中，往<li>上添加一个[class.selected]绑定：</li></p>
<pre><code>[class.selected]=&quot;hero === selectedHero&quot;
</code></pre><p>当表达式(hero === selectedHero)为true时，Angular会添加一个CSS类selected。为false时则会移除selected类。</p>
<pre><code>&lt;li * ngFor=&quot;let hero of heroes&quot;
  [class.selected]=&quot;hero === selectedHero&quot;
  (click)=&quot;onSelect(hero)&quot;&gt;
  &lt;span class=&quot;badge&quot;&gt;{{hero.id}}&lt;/span&gt; {{hero.name}}
&lt;/li&gt;
</code></pre><p>浏览器重新加载了我们的应用。 我们选中英雄 Magneta，通过背景色的变化，它被清晰的标记出来。</p>
<p><img src="http://i4.buimg.com/588926/9f1484f873662bfd.png" alt=""></p>
<p>完整的app.component.ts文件如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line">import &#123; Component &#125; from '@angular/core';</div><div class="line">export class Hero &#123;</div><div class="line">  id: number;</div><div class="line">  name: string;</div><div class="line">&#125;</div><div class="line">const HEROES: Hero[] = [</div><div class="line">  &#123; id: 11, name: 'Mr. Nice' &#125;,</div><div class="line">  &#123; id: 12, name: 'Narco' &#125;,</div><div class="line">  &#123; id: 13, name: 'Bombasto' &#125;,</div><div class="line">  &#123; id: 14, name: 'Celeritas' &#125;,</div><div class="line">  &#123; id: 15, name: 'Magneta' &#125;,</div><div class="line">  &#123; id: 16, name: 'RubberMan' &#125;,</div><div class="line">  &#123; id: 17, name: 'Dynama' &#125;,</div><div class="line">  &#123; id: 18, name: 'Dr IQ' &#125;,</div><div class="line">  &#123; id: 19, name: 'Magma' &#125;,</div><div class="line">  &#123; id: 20, name: 'Tornado' &#125;</div><div class="line">];</div><div class="line">@Component(&#123;</div><div class="line">  selector: 'my-app',</div><div class="line">  template: `</div><div class="line">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">    &lt;h2&gt;My Heroes&lt;/h2&gt;</div><div class="line">    &lt;ul class="heroes"&gt;</div><div class="line">      &lt;li * ngFor="let hero of heroes"</div><div class="line">        [class.selected]="hero === selectedHero"</div><div class="line">        (click)="onSelect(hero)"&gt;</div><div class="line">        &lt;span class="badge"&gt;&#123;&#123;hero.id&#125;&#125;&lt;/span&gt; &#123;&#123;hero.name&#125;&#125;</div><div class="line">      &lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">    &lt;div * ngIf="selectedHero"&gt;</div><div class="line">      &lt;h2&gt;&#123;&#123;selectedHero.name&#125;&#125; details!&lt;/h2&gt;</div><div class="line">      &lt;div&gt;&lt;label&gt;id: &lt;/label&gt;&#123;&#123;selectedHero.id&#125;&#125;&lt;/div&gt;</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;label&gt;name: &lt;/label&gt;</div><div class="line">        &lt;input [(ngModel)]="selectedHero.name" placeholder="name"/&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  `,</div><div class="line">  styles: [``</div><div class="line">    .selected &#123;</div><div class="line">      background-color: #CFD8DC !important;</div><div class="line">      color: white;</div><div class="line">    &#125;</div><div class="line">    .heroes &#123;</div><div class="line">      margin: 0 0 2em 0;</div><div class="line">      list-style-type: none;</div><div class="line">      padding: 0;</div><div class="line">      width: 15em;</div><div class="line">    &#125;</div><div class="line">    .heroes li &#123;</div><div class="line">      cursor: pointer;</div><div class="line">      position: relative;</div><div class="line">      left: 0;</div><div class="line">      background-color: #EEE;</div><div class="line">      margin: .5em;</div><div class="line">      padding: .3em 0;</div><div class="line">      height: 1.6em;</div><div class="line">      border-radius: 4px;</div><div class="line">    &#125;</div><div class="line">    .heroes li.selected:hover &#123;</div><div class="line">      background-color: #BBD8DC !important;</div><div class="line">      color: white;</div><div class="line">    &#125;</div><div class="line">    .heroes li:hover &#123;</div><div class="line">      color: #607D8B;</div><div class="line">      background-color: #DDD;</div><div class="line">      left: .1em;</div><div class="line">    &#125;</div><div class="line">    .heroes .text &#123;</div><div class="line">      position: relative;</div><div class="line">      top: -3px;</div><div class="line">    &#125;</div><div class="line">    .heroes .badge &#123;</div><div class="line">      display: inline-block;</div><div class="line">      font-size: small;</div><div class="line">      color: white;</div><div class="line">      padding: 0.8em 0.7em 0 0.7em;</div><div class="line">      background-color: #607D8B;</div><div class="line">      line-height: 1em;</div><div class="line">      position: relative;</div><div class="line">      left: -1px;</div><div class="line">      top: -4px;</div><div class="line">      height: 1.8em;</div><div class="line">      margin-right: .8em;</div><div class="line">      border-radius: 4px 0 0 4px;</div><div class="line">    &#125;</div><div class="line">  ``]</div><div class="line">&#125;)</div><div class="line">export class AppComponent &#123;</div><div class="line">  title = 'Tour of Heroes';</div><div class="line">  heroes = HEROES;</div><div class="line">  selectedHero: Hero;</div><div class="line">  onSelect(hero: Hero): void &#123;</div><div class="line">    this.selectedHero = hero;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>注意：以上里面所写的反引号都应该是一个，这里是为了在md文档里展示代码好看。</p>
<p>上一篇：<a href="http://localhost:4000/2017/05/18/AngularJS1" target="_blank" rel="external">AngularJS之英雄联盟介绍</a>.<br>  下一篇：<a href="http://localhost:4000/2017/05/18/AngularJS3" target="_blank" rel="external">AngularJS之英雄联盟多个组件</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[AngularJS之英雄联盟组件介绍]]></title>
      <url>/2017/05/18/AngularJS1/</url>
      <content type="html"><![CDATA[<h3 id="组件详细介绍"><a href="#组件详细介绍" class="headerlink" title="组件详细介绍"></a>组件详细介绍</h3><blockquote>
<p>它是一个英雄列表以数组的形式展现，每个数组对象都有id和name两个键来存储英雄的信息。<br>  点击英雄列表中的英雄会在下方展示英雄的详细信息。一开始英雄列表和英雄详细都在一个组<br>  件里，后期会把英雄列表与详细分离升级为服务，再到路由和http协议。</p>
</blockquote>
<p>本组件从复杂到简单可以分五步完成</p>
<ul>
<li>1是逻辑简单实现复杂的主从关系</li>
<li>2是模块分离细分组件的层次结构</li>
<li>3是升级为服务的形式获取要用的模块</li>
<li>4是路由（即页面之间的跳转）</li>
<li>5我们预料到总有这么一天会通过 HTTP 客户端来获取英雄数据。所以改用http协议</li>
</ul>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p>好的工具能让开发更加简单快捷。<br>Angular CLI是一个命令行界面工具，它可以创建项目、添加文件以及执行一大堆开发任务，比如测试、打包和发布。<br>我们通过下列三大步来达到目的：</p>
<ol>
<li>设置开发环境。</li>
<li>创建新项目以及应用的骨架。</li>
<li>启动开发服务器。</li>
<li>编辑该应用。</li>
</ol>
<h3 id="怎么用工具启动服务"><a href="#怎么用工具启动服务" class="headerlink" title="怎么用工具启动服务"></a>怎么用工具启动服务</h3><p>步骤1 在开始工作之前，我们必须设置好开发环境。如果你的机器上还没有Node.js®和npm，请先安装它们。</p>
<blockquote>
<p>请先在终端/控制台窗口中运行命令 node -v 和 npm -v， 来验证一下你正在运行 node 6.9.x 和 npm 3.x.x 以上的版本。 更老的版本可能会出现错误，更新的版本则没问题。</p>
</blockquote>
<p>然后全局安装 Angular CLI 。</p>
<pre><code>npm install -g @angular/cli
</code></pre><p>步骤2. 创建新项目</p>
<p>打开终端窗口,运行下列命令来生成一个新项目以及应用的骨架代码：</p>
<pre><code>ng new my-app
</code></pre><blockquote>
<p>请耐心等待。 创建新项目需要花费很多时间，大多数时候都是在安装那些npm包。(npm包就是一个下载工具里面有你需要的所有要用的东西，在国内建议用淘宝镜像)</p>
</blockquote>
<p>步骤3. 启动开发服务器</p>
<p>进入项目目录，并启动服务器。<br>    cd my-app<br>    ng serve -o</p>
<blockquote>
<p>注意：对应好自己的目录，cd是终端的命令即进入目录，ng是angularJs2的core命令。</p>
</blockquote>
<p>本应用会用一条消息来跟你打招呼：<br>    app works!</p>
<blockquote>
<p>上一篇：<a href="http://localhost:4000/2017/05/17/AngularJS" target="_blank" rel="external">玩转 AngularJS 指令的 Scope (作用域)</a>.<br>  下一篇：<a href="http://localhost:4000/2017/05/18/AngularJS2" target="_blank" rel="external">AngularJS之英雄联盟主从结构</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[玩转 AngularJS 指令的 Scope (作用域)]]></title>
      <url>/2017/05/17/AngularJS/</url>
      <content type="html"><![CDATA[<h3 id="scope-false"><a href="#scope-false" class="headerlink" title="scope = false"></a>scope = false</h3><p>首先我们来看一下，当scope参数被设置为false时有什么情况发生<br>在这种情况下，在指令模板中可以直接使用父作用域中的变量，函数<br>首先我们来创建一个指令，代码如下所示：<br>JS代码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">"MyApp"</span>, [])</div><div class="line">    .controller(<span class="string">"MyController"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">        <span class="comment">//J1 这里我们在作用域里初始化两个变量</span></div><div class="line">    $scope.name = <span class="string">"dreamapple"</span>;</div><div class="line">    $scope.age = <span class="number">20</span>;</div><div class="line">        <span class="comment">//J2 创建一个方法，修改我们创建的对象的年龄</span></div><div class="line">    $scope.changeAge = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        $scope.age = <span class="number">22</span>;</div><div class="line">    &#125;</div><div class="line">&#125;)</div><div class="line">        <span class="comment">//J3 创建我们的指令，指令名字为"myDirective"</span></div><div class="line"></div><div class="line">    .directive(<span class="string">"myDirective"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> obj = &#123;</div><div class="line">        <span class="comment">//J4   指令的声明模式为 "AE" 属性和元素</span></div><div class="line">        restrict: <span class="string">"AE"</span>,</div><div class="line">        <span class="comment">//J5   指令继承父作用域的属性和方法</span></div><div class="line">        scope: <span class="literal">false</span>,</div><div class="line">        <span class="attr">replace</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">template</span>: <span class="string">"&lt;div class='my-directive'&gt;"</span> +</div><div class="line">            <span class="string">"&lt;h3&gt;下面部分是我们创建的指令生成的&lt;/h3&gt;"</span> +</div><div class="line">            <span class="string">"我的名字是：&lt;span ng-bind='name'&gt;&lt;/span&gt;&lt;br/&gt;"</span> +</div><div class="line">            <span class="string">"我的年龄是：&lt;span ng-bind='age'&gt;&lt;/span&gt;"</span> +</div><div class="line">            <span class="string">"&lt;input type='text' ng-model='name'&gt;"</span>+</div><div class="line">            <span class="string">" &lt;/div&gt;"</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>HTML代码：</p>
<pre><code>&lt;div ng-app=&quot;MyApp&quot;&gt;
    &lt;div class=&quot;container&quot; ng-controller=&quot;MyController&quot;&gt;
        &lt;div class=&quot;my-info&quot;&gt;我的名字是：
            &lt;span ng-bind=&quot;name&quot;&gt;&lt;/span&gt;
            &lt;!-- 使用&quot;ng-bind&quot;防止网络状态不佳时出现没有被赋值表达式   --&gt;
            &lt;br/&gt;我的年龄是：&lt;span ng-bind=&quot;age&quot;&gt;&lt;/span&gt;
        &lt;/div&gt;
        &lt;!-- 使用属性声明指令 --&gt;
        &lt;div class=&quot;my-directive&quot; my-directive&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre><p>CSS代码：</p>
<pre><code>div{
    padding: 6px;
}
div.container {
    border: 1px solid black;
}
div.my-info {
    border: 1px solid blue;
}
div.my-directive{
    border: 1px solid green;
}
</code></pre><p>下面我们来详细解释一下上面的代码：</p>
<blockquote>
<p>因为我们将scope的属性设置为false所以，我们创建的指令继承了父作用域的一切属性和方法，这也使得在指令的模板中我们可以使用这些属性和方法。</p>
<p>注意：此时我们在输入框里改变名字，会发现上面的两个名字都发生了变化，你肯定会说，这肯定是这样啊，数据绑定嘛，好，我们接着往下走。</p>
</blockquote>
<h3 id="scope-true"><a href="#scope-true" class="headerlink" title="scope = true"></a>scope = true</h3><p>当把scope属性设置为true时，这表明我们创建的指令要创建一个新的作用域，这个作用域继承自我们的父作用域。<br>等等，刚才我们不是说了，当把scope属性值设置为false时，不也是继承我们的父作用域吗？表急，我们接着往下看。</p>
<p>修改上面的JS代码，将指令中的：</p>
<p>scope:false修改为scope:true</p>
<p>然后我们再试着在我们的input输入框中写一些字符串，会发现，指令中的那个name发生了变化，但是指令外的那个name却没有发生变化，这说明了一个问题。</p>
<blockquote>
<ol>
<li>当我们将scope设置为true的时候，我们就新创建了一个作用域，只不过这个作用域是继承了我们的父作用域；我觉得可以这样理解，我们新创建的作用域是一个新的作用域，只不过在初始化的时候，用了父作用域的属性和方法去填充我们这个新的作用域。它和父作用域不是同一个作用域。</li>
<li>当我们将scope设置为false的时候,我们创建的指令和父作用域（其实是同一个作用域）共享同一个model模型，所以在指令中修改模型数据，它会反映到父作用域的模型中。</li>
</ol>
</blockquote>
<h3 id="scope"><a href="#scope" class="headerlink" title="scope = {}"></a>scope = {}</h3><p>下面我们要进入一个好玩的部分，当我们将scope的属性设置为{}时，我们可以做更多的事情。</p>
<p>AngularJS最强的大的地方之一就是它可以构建组建，无论放在哪里都是可以使用的；<br>这所以可以做到这些，不得不归功于指令的这个属性；当我们将scope设置为{}时，意味着我们创建的一个新的与父作用域隔离的新的作用域，这使我们在不知道外部环境的情况下，就可以正常工作，不依赖外部环境。</p>
<p>当然首先我们还是要给出我们的例子，先看代码,我们修改了上述的JS代码和HTML代码 JS代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">"MyApp"</span>, [])</div><div class="line">    .controller(<span class="string">"MyController"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$scope</span>) </span>&#123;</div><div class="line">    $scope.name = <span class="string">"dreamapple"</span>;</div><div class="line">    $scope.age = <span class="number">20</span>;</div><div class="line">    $scope.changeAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        $scope.age = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;)</div><div class="line">    .directive(<span class="string">"myDirective"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> obj = &#123;</div><div class="line">        <span class="attr">restrict</span>: <span class="string">"AE"</span>,</div><div class="line">        <span class="attr">scope</span>: &#123;</div><div class="line">            <span class="attr">name</span>: <span class="string">'@myName'</span>,</div><div class="line">            <span class="attr">age</span>: <span class="string">'='</span>,</div><div class="line">            <span class="attr">changeAge</span>: <span class="string">'&amp;changeMyAge'</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">replace</span>: <span class="literal">true</span>,</div><div class="line">        <span class="attr">template</span>: <span class="string">"&lt;div class='my-directive'&gt;"</span> +</div><div class="line">            <span class="string">"&lt;h3&gt;下面部分是我们创建的指令生成的&lt;/h3&gt;"</span> +</div><div class="line">            <span class="string">"我的名字是：&lt;span ng-bind='name'&gt;&lt;/span&gt;&lt;br/&gt;"</span> +</div><div class="line">            <span class="string">"我的年龄是：&lt;span ng-bind='age'&gt;&lt;/span&gt;&lt;br/&gt;"</span> +</div><div class="line">            <span class="string">"在这里修改名字：&lt;input type='text' ng-model='name'&gt;&lt;br/&gt;"</span> +</div><div class="line">            <span class="string">"&lt;button ng-click='changeAge()'&gt;修改年龄&lt;/button&gt;"</span> +</div><div class="line">            <span class="string">" &lt;/div&gt;"</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> obj;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>HTML代码:</p>
<pre><code>&lt;div ng-app=&quot;MyApp&quot;&gt;
    &lt;div class=&quot;container&quot; ng-controller=&quot;MyController&quot;&gt;
        &lt;div class=&quot;my-info&quot;&gt;我的名字是：&lt;span ng-bind=&quot;name&quot;&gt;&lt;/span&gt;

            &lt;br/&gt;我的年龄是：&lt;span ng-bind=&quot;age&quot;&gt;&lt;/span&gt;
            &lt;br /&gt;
        &lt;/div&gt;
        &lt;div class=&quot;my-directive&quot; my-directive my-name=&quot;{{name}}&quot; age=&quot;age&quot;  change-my-age=&quot;changeAge()&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre><p>我们使用了隔离的作用域，不代表我们不可以使用父作用域的属性和方法。</p>
<ol>
<li>我们可以通过向scope的{}中传入特殊的前缀标识符（即prefix），来进行数据的绑定。</li>
<li>在创建了隔离的作用域，我们可以通过@,&amp;,=引用应用指令的元素的属性，如上面的代码那样，我们可以在<div class="my-directive" my-directive="" my-name="" age="age" change-my-age="changeAge()"></div>这个元素中，利用前缀标识符通过使用属性my-name,age,change-my-age来引用这些属性的值。</li>
</ol>
<p>下面我们来看看如何使用这些前缀标识符：    </p>
<p>@<br>这是一个单项绑定的前缀标识符<br>使用方法：在元素中使用属性，好比这样    </p>
<pre><code>&lt;div my-directive my-name=&quot;{{name}}&quot;&gt;&lt;/div&gt;  
</code></pre><p>注意，属性的名字要用-将两个单词连接，因为是数据的单项绑定所以要通过使用</p>
<pre><code>{{}}
</code></pre><p>来绑定数据。</p>
<p>=<br>这是一个双向数据绑定前缀标识符使用方法：在元素中使用属性，好比这样    </p>
<pre><code>&lt;div my-directive age=&quot;age&quot;&gt;&lt;/div&gt;    
</code></pre><p>注意，数据的双向绑定要通过=前缀标识符实现，所以不可以使用</p>
<pre><code>{{}}
</code></pre><p>&amp;<br>这是一个绑定函数方法的前缀标识符<br>使用方法：在元素中使用属性，好比这样</p>
<pre><code>&lt;div my-directive change-my-age=&quot;changeAge()&quot;&gt;&lt;/div&gt;
</code></pre><p>注意，属性的名字要用-将多个个单词连接。</p>
<pre><code>注意：在新创建指令的作用域对象中，使用属性的名字进行绑定时，要使用驼峰命名标准，比如下面的代码。
</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">scope: &#123;</div><div class="line">            <span class="comment">// `myName` 就是原来元素中的`my-name`属性</span></div><div class="line">            name: <span class="string">'@myName'</span>,</div><div class="line">            <span class="attr">age</span>: <span class="string">'='</span>,</div><div class="line">            <span class="comment">// `changeMyAge`就是原来元素中的`change-my-age`属性</span></div><div class="line">            changeAge: <span class="string">'&amp;changeMyAge'</span></div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>进一步说明，我们的指令是如何利用这些前缀标识符来寻找我们想要的属性或者函数的？</p>
<ul>
<li>@ 当指令编译到模板的name时，就会到scope中寻找是否含有name的键值对，如果存在，就像上面那样，看到@就知道这是一个单向的数据绑定，然后寻找原来的那个使用指令的元素上（或者是指令元素本身）含有这个值的属性即</li>
</ul>
<pre><code>my-name = {{name}}
</code></pre><p>然后在父作用域查找</p>
<pre><code>{{name}}
</code></pre><p>的值，得到之后传递给模板中的name。</p>
<ul>
<li>=和&amp;与@差不多，只不过=进行的是双向的数据绑定，不论模板还是父作用域上的属性的值发生改变都会使另一个值发生改变，而&amp;是绑定函数而已。</li>
</ul>
<p>到这里我们关于AngularJS指令的作用域估计也理解的差不多了，那好，洗洗睡吧！</p>
<blockquote>
<p>下一篇：<a href="http://localhost:4000/2017/05/18/AngularJS1" target="_blank" rel="external">AngularJS之英雄联盟组件介绍</a>.</p>
</blockquote>
]]></content>
      
        
        <tags>
            
            <tag> AngularJS </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
